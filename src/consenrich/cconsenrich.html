<!DOCTYPE html>
<!-- Generated by Cython 3.1.4 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: cconsenrich.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { color: #000000; margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 3.1.4</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="cconsenrich.c">cconsenrich.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: # -*- coding: utf-8 -*-</pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_test, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: # cython: boundscheck=False, wraparound=False, cdivision=True, nonecheck=False, initializedcheck=False, infer_types=True, language_level=3</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: # distutils: language = c</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: r"""Cython module for Consenrich core functions.</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: This module contains Cython implementations of core functions used in Consenrich.</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: """</pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: cimport cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">011</span>: import os</pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_mstate_global-&gt;__pyx_n_u_os, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_os, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">012</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_mstate_global-&gt;__pyx_n_u_numpy, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_np, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 12, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: from scipy import ndimage</pre>
<pre class='cython code score-14 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Pack</span>(1, __pyx_mstate_global-&gt;__pyx_n_u_ndimage);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_mstate_global-&gt;__pyx_n_u_scipy, __pyx_t_5, 0);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_ndimage);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_ndimage, __pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: import pysam</pre>
<pre class='cython code score-8 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_ImportDottedModule</span>(__pyx_mstate_global-&gt;__pyx_n_u_pysam, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_pysam, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">015</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: cimport numpy as cnp</pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: from libc.stdint cimport int64_t, uint8_t, uint16_t, uint32_t, uint64_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: from pysam.libcalignmentfile cimport AlignmentFile, AlignedSegment</pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">020</span>: cnp.import_array()</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_f_5numpy_import_array();<span class='error_goto'> if (unlikely(__pyx_t_10 == ((int)-1))) __PYX_ERR(0, 20, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-78" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">022</span>: cpdef int stepAdjustment(int value, int stepSize, int pushForward=0):</pre>
<pre class='cython code score-78 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_1stepAdjustment(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static int __pyx_f_10consenrich_11cconsenrich_stepAdjustment(int __pyx_v_value, int __pyx_v_stepSize, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_10consenrich_11cconsenrich_stepAdjustment *__pyx_optional_args) {
  int __pyx_v_pushForward = ((int)0);
  int __pyx_r;
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_pushForward = __pyx_optional_args-&gt;pushForward;
    }
  }
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_1stepAdjustment(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_stepAdjustment, "Adjusts a value to the nearest multiple of stepSize, optionally pushing it forward.\n\n    :param value: The value to adjust.\n    :type value: int\n    :param stepSize: The step size to adjust to.\n    :type stepSize: int\n    :param pushForward: If non-zero, pushes the value forward by stepSize\n    :type pushForward: int\n    :return: The adjusted value.\n    :rtype: int\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_1stepAdjustment = {"stepAdjustment", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_1stepAdjustment, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_stepAdjustment};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_1stepAdjustment(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  int __pyx_v_value;
  int __pyx_v_stepSize;
  int __pyx_v_pushForward;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("stepAdjustment (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_value,&amp;__pyx_mstate_global-&gt;__pyx_n_u_stepSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_pushForward,0};
  PyObject* values[3] = {0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "stepAdjustment", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stepAdjustment", 0, 2, 3, i); <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_value = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[0]); if (unlikely((__pyx_v_value == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
    __pyx_v_stepSize = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[1]); if (unlikely((__pyx_v_stepSize == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
    if (values[2]) {
      __pyx_v_pushForward = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[2]); if (unlikely((__pyx_v_pushForward == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
    } else {
      __pyx_v_pushForward = ((int)0);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("stepAdjustment", 0, 2, 3, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.stepAdjustment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_stepAdjustment(__pyx_self, __pyx_v_value, __pyx_v_stepSize, __pyx_v_pushForward);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_stepAdjustment(CYTHON_UNUSED PyObject *__pyx_self, int __pyx_v_value, int __pyx_v_stepSize, int __pyx_v_pushForward) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 1;
  __pyx_t_2.pushForward = __pyx_v_pushForward;
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_stepAdjustment(__pyx_v_value, __pyx_v_stepSize, 1, &amp;__pyx_t_2); if (unlikely(__pyx_t_1 == ((int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.stepAdjustment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_1stepAdjustment, 0, __pyx_mstate_global-&gt;__pyx_n_u_stepAdjustment, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[0]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_tuple[3]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_stepAdjustment, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[3] = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_mstate_global-&gt;__pyx_int_0); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[3])) <span class='error_goto'>__PYX_ERR(0, 22, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[3]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[3]);
/* … */
struct __pyx_opt_args_10consenrich_11cconsenrich_stepAdjustment {
  int __pyx_n;
  int pushForward;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">023</span>:     r"""Adjusts a value to the nearest multiple of stepSize, optionally pushing it forward.</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:     :param value: The value to adjust.</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>:     :type value: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:     :param stepSize: The step size to adjust to.</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>:     :type stepSize: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>:     :param pushForward: If non-zero, pushes the value forward by stepSize</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:     :type pushForward: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>:     :return: The adjusted value.</pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>:     :rtype: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">034</span>:     return max(0, (value-(value % stepSize))) + pushForward*stepSize</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_value - (__pyx_v_value % __pyx_v_stepSize));
  __pyx_t_2 = 0;
  __pyx_t_4 = (__pyx_t_1 &gt; __pyx_t_2);
  if (__pyx_t_4) {
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_3 = __pyx_t_2;
  }
  __pyx_r = (__pyx_t_3 + (__pyx_v_pushForward * __pyx_v_stepSize));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">035</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: </pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">037</span>: cpdef uint64_t cgetFirstChromRead(str bamFile, str chromosome, uint64_t chromLength, uint32_t samThreads, int samFlagExclude):</pre>
<pre class='cython code score-86 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_3cgetFirstChromRead(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static uint64_t __pyx_f_10consenrich_11cconsenrich_cgetFirstChromRead(PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, uint64_t __pyx_v_chromLength, uint32_t __pyx_v_samThreads, int __pyx_v_samFlagExclude, CYTHON_UNUSED int __pyx_skip_dispatch) {
  struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *__pyx_v_aln = 0;
  struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *__pyx_v_read = 0;
  uint64_t __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetFirstChromRead", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_read);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_3cgetFirstChromRead(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_2cgetFirstChromRead, "Get the start position of the first read in a BAM file for a given chromosome.\n\n    :param bamFile: See :func:`consenrich.core.inputParams`.\n    :type bamFile: str\n    :param chromosome: Chromosome name.\n    :type chromosome: str\n    :param chromLength: Length of the chromosome in base pairs.\n    :type chromLength: uint64_t\n    :param samThreads: Number of threads to use for reading the BAM file.\n    :type samThreads: uint32_t\n    :param samFlagExclude: SAM flags to exclude reads (e.g., unmapped,\n    :type samFlagExclude: int\n    :return: Start position of the first read in the chromosome, or 0 if no reads are found.\n    :rtype: uint64_t\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_3cgetFirstChromRead = {"cgetFirstChromRead", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_3cgetFirstChromRead, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_2cgetFirstChromRead};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_3cgetFirstChromRead(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_bamFile = 0;
  PyObject *__pyx_v_chromosome = 0;
  uint64_t __pyx_v_chromLength;
  uint32_t __pyx_v_samThreads;
  int __pyx_v_samFlagExclude;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cgetFirstChromRead (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_bamFile,&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromosome,&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromLength,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samThreads,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samFlagExclude,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cgetFirstChromRead", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 5; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetFirstChromRead", 1, 5, 5, i); <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
    }
    __pyx_v_bamFile = ((PyObject*)values[0]);
    __pyx_v_chromosome = ((PyObject*)values[1]);
    __pyx_v_chromLength = __Pyx_PyLong_As_uint64_t(values[2]); if (unlikely((__pyx_v_chromLength == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
    __pyx_v_samThreads = __Pyx_PyLong_As_uint32_t(values[3]); if (unlikely((__pyx_v_samThreads == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
    __pyx_v_samFlagExclude = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[4]); if (unlikely((__pyx_v_samFlagExclude == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetFirstChromRead", 1, 5, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetFirstChromRead", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bamFile), (&amp;PyUnicode_Type), 1, "bamFile", 1))) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chromosome), (&amp;PyUnicode_Type), 1, "chromosome", 1))) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_2cgetFirstChromRead(__pyx_self, __pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_chromLength, __pyx_v_samThreads, __pyx_v_samFlagExclude);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_2cgetFirstChromRead(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, uint64_t __pyx_v_chromLength, uint32_t __pyx_v_samThreads, int __pyx_v_samFlagExclude) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_cgetFirstChromRead(__pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_chromLength, __pyx_v_samThreads, __pyx_v_samFlagExclude, 1); if (unlikely(__pyx_t_1 == ((uint64_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  __pyx_t_2 = __Pyx_PyLong_From_uint64_t(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetFirstChromRead", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_3cgetFirstChromRead, 0, __pyx_mstate_global-&gt;__pyx_n_u_cgetFirstChromRead, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[1]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cgetFirstChromRead, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 37, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">038</span>:     r"""Get the start position of the first read in a BAM file for a given chromosome.</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>:     :param bamFile: See :func:`consenrich.core.inputParams`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>:     :type bamFile: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>:     :param chromosome: Chromosome name.</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>:     :type chromosome: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>:     :param chromLength: Length of the chromosome in base pairs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>:     :type chromLength: uint64_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>:     :param samThreads: Number of threads to use for reading the BAM file.</pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>:     :type samThreads: uint32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>:     :param samFlagExclude: SAM flags to exclude reads (e.g., unmapped,</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>:     :type samFlagExclude: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>:     :return: Start position of the first read in the chromosome, or 0 if no reads are found.</pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>:     :rtype: uint64_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>:     cdef AlignmentFile aln = AlignmentFile(bamFile, 'rb', threads=samThreads)</pre>
<pre class='cython code score-11 '>  __pyx_t_2 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile); 
  __pyx_t_4 = __Pyx_PyLong_From_uint32_t(__pyx_v_samThreads);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[3 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_v_bamFile, __pyx_mstate_global-&gt;__pyx_n_u_rb};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_threads, __pyx_t_4, __pyx_t_6, __pyx_callargs+3, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 54, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_1);
  }
  __pyx_v_aln = ((struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">055</span>:     cdef AlignedSegment read</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>:     for read in aln.fetch(contig=chromosome, start=0, end=chromLength):</pre>
<pre class='cython code score-65 '>  __pyx_t_3 = ((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyLong_From_uint64_t(__pyx_v_chromLength);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 3 : 0)] = {__pyx_t_3, NULL};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_contig, __pyx_v_chromosome, __pyx_t_4, __pyx_callargs+1, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_start, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_t_4, __pyx_callargs+1, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_end, __pyx_t_6, __pyx_t_4, __pyx_callargs+1, 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_fetch, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_8 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_4);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_4, __pyx_t_7);
        ++__pyx_t_7;
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_4);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_7 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_7));
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_7);
        #endif
        ++__pyx_t_7;
      }
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    } else {
      __pyx_t_1 = __pyx_t_8(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
          <span class='py_c_api'>PyErr_Clear</span>();
        }
        break;
      }
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5pysam_18libcalignedsegment_AlignedSegment))))) <span class='error_goto'>__PYX_ERR(0, 56, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_read, ((struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *)__pyx_t_1));
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">057</span>:         if not (read.flag &amp; samFlagExclude):</pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_flag);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 57, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_samFlagExclude);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 57, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 57, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_9 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 57, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_10 = (!__pyx_t_9);
    if (__pyx_t_10) {
/* … */
    }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">058</span>:             aln.close()</pre>
<pre class='cython code score-5 '>      __pyx_t_6 = ((PyObject *)__pyx_v_aln);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_6, NULL};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 58, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>:             return read.reference_start</pre>
<pre class='cython code score-9 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_reference_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_11 = __Pyx_PyLong_As_uint64_t(__pyx_t_3); if (unlikely((__pyx_t_11 == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_r = __pyx_t_11;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      goto __pyx_L0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     aln.close()</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = ((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     return 0</pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">062</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: </pre>
<pre class="cython line score-86" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>: cpdef uint64_t cgetLastChromRead(str bamFile, str chromosome, uint64_t chromLength, uint32_t samThreads, int samFlagExclude):</pre>
<pre class='cython code score-86 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_5cgetLastChromRead(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static uint64_t __pyx_f_10consenrich_11cconsenrich_cgetLastChromRead(PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, uint64_t __pyx_v_chromLength, uint32_t __pyx_v_samThreads, int __pyx_v_samFlagExclude, CYTHON_UNUSED int __pyx_skip_dispatch) {
  uint64_t __pyx_v_start_;
  uint64_t __pyx_v_lastPos;
  struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *__pyx_v_aln = 0;
  struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *__pyx_v_read = 0;
  uint64_t __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetLastChromRead", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_read);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_5cgetLastChromRead(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_4cgetLastChromRead, "Get the end position of the last read in a BAM file for a given chromosome.\n\n    :param bamFile: See :func:`consenrich.core.inputParams`.\n    :type bamFile: str\n    :param chromosome: Chromosome name.\n    :type chromosome: str\n    :param chromLength: Length of the chromosome in base pairs.\n    :type chromLength: uint64_t\n    :param samThreads: Number of threads to use for reading the BAM file.\n    :type samThreads: uint32_t\n    :param samFlagExclude: See :class:`consenrich.core.samParams`.\n    :type samFlagExclude: int\n    :return: End position of the last read in the chromosome, or 0 if no reads are found.\n    :rtype: uint64_t\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_5cgetLastChromRead = {"cgetLastChromRead", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_5cgetLastChromRead, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_4cgetLastChromRead};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_5cgetLastChromRead(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_bamFile = 0;
  PyObject *__pyx_v_chromosome = 0;
  uint64_t __pyx_v_chromLength;
  uint32_t __pyx_v_samThreads;
  int __pyx_v_samFlagExclude;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cgetLastChromRead (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_bamFile,&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromosome,&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromLength,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samThreads,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samFlagExclude,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cgetLastChromRead", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 5; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetLastChromRead", 1, 5, 5, i); <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
    }
    __pyx_v_bamFile = ((PyObject*)values[0]);
    __pyx_v_chromosome = ((PyObject*)values[1]);
    __pyx_v_chromLength = __Pyx_PyLong_As_uint64_t(values[2]); if (unlikely((__pyx_v_chromLength == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
    __pyx_v_samThreads = __Pyx_PyLong_As_uint32_t(values[3]); if (unlikely((__pyx_v_samThreads == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
    __pyx_v_samFlagExclude = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[4]); if (unlikely((__pyx_v_samFlagExclude == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetLastChromRead", 1, 5, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetLastChromRead", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bamFile), (&amp;PyUnicode_Type), 1, "bamFile", 1))) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chromosome), (&amp;PyUnicode_Type), 1, "chromosome", 1))) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_4cgetLastChromRead(__pyx_self, __pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_chromLength, __pyx_v_samThreads, __pyx_v_samFlagExclude);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_4cgetLastChromRead(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, uint64_t __pyx_v_chromLength, uint32_t __pyx_v_samThreads, int __pyx_v_samFlagExclude) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_cgetLastChromRead(__pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_chromLength, __pyx_v_samThreads, __pyx_v_samFlagExclude, 1); if (unlikely(__pyx_t_1 == ((uint64_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
  __pyx_t_2 = __Pyx_PyLong_From_uint64_t(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetLastChromRead", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_5cgetLastChromRead, 0, __pyx_mstate_global-&gt;__pyx_n_u_cgetLastChromRead, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[2]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cgetLastChromRead, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">065</span>:     r"""Get the end position of the last read in a BAM file for a given chromosome.</pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>:     :param bamFile: See :func:`consenrich.core.inputParams`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>:     :type bamFile: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>:     :param chromosome: Chromosome name.</pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>:     :type chromosome: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>:     :param chromLength: Length of the chromosome in base pairs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>:     :type chromLength: uint64_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>:     :param samThreads: Number of threads to use for reading the BAM file.</pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>:     :type samThreads: uint32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>:     :param samFlagExclude: See :class:`consenrich.core.samParams`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>:     :type samFlagExclude: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>:     :return: End position of the last read in the chromosome, or 0 if no reads are found.</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>:     :rtype: uint64_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">081</span>:     cdef uint64_t start_ = chromLength - min((chromLength // 2), 1_000_000)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = 0xF4240;
  __pyx_t_2 = (__pyx_v_chromLength / 2);
  __pyx_t_4 = (__pyx_t_1 &lt; __pyx_t_2);
  if (__pyx_t_4) {
    __pyx_t_3 = __pyx_t_1;
  } else {
    __pyx_t_3 = __pyx_t_2;
  }
  __pyx_v_start_ = (__pyx_v_chromLength - __pyx_t_3);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">082</span>:     cdef uint64_t lastPos = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_lastPos = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">083</span>:     cdef AlignmentFile aln = AlignmentFile(bamFile, 'rb', threads=samThreads)</pre>
<pre class='cython code score-11 '>  __pyx_t_6 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile);
  __pyx_t_7 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile); 
  __pyx_t_8 = __Pyx_PyLong_From_uint32_t(__pyx_v_samThreads);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = 1;
  {
    PyObject *__pyx_callargs[3 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_6, __pyx_v_bamFile, __pyx_mstate_global-&gt;__pyx_n_u_rb};
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_threads, __pyx_t_8, __pyx_t_10, __pyx_callargs+3, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 83, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_7, __pyx_callargs+__pyx_t_9, (3-__pyx_t_9) | (__pyx_t_9*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 83, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_5);
  }
  __pyx_v_aln = ((struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">084</span>:     cdef AlignedSegment read</pre>
<pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">085</span>:     for read in aln.fetch(contig=chromosome, start=start_, end=chromLength):</pre>
<pre class='cython code score-66 '>  __pyx_t_7 = ((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
  __pyx_t_10 = __Pyx_PyLong_From_uint64_t(__pyx_v_start_);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = __Pyx_PyLong_From_uint64_t(__pyx_v_chromLength);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 3 : 0)] = {__pyx_t_7, NULL};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_contig, __pyx_v_chromosome, __pyx_t_6, __pyx_callargs+1, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_start, __pyx_t_10, __pyx_t_6, __pyx_callargs+1, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_end, __pyx_t_8, __pyx_t_6, __pyx_callargs+1, 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_fetch, __pyx_callargs+__pyx_t_9, (1-__pyx_t_9) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_5)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_5)) {
    __pyx_t_6 = __pyx_t_5; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    __pyx_t_11 = 0;
    __pyx_t_12 = NULL;
  } else {
    __pyx_t_11 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_12 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 85, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  for (;;) {
    if (likely(!__pyx_t_12)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_6);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_11 &gt;= __pyx_temp) break;
        }
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_6, __pyx_t_11);
        ++__pyx_t_11;
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_6);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_11 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_11));
        #else
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_6, __pyx_t_11);
        #endif
        ++__pyx_t_11;
      }
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
    } else {
      __pyx_t_5 = __pyx_t_12(__pyx_t_6);
      if (unlikely(!__pyx_t_5)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
          <span class='py_c_api'>PyErr_Clear</span>();
        }
        break;
      }
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (!(likely(((__pyx_t_5) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_ptype_5pysam_18libcalignedsegment_AlignedSegment))))) <span class='error_goto'>__PYX_ERR(0, 85, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_read, ((struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *)__pyx_t_5));
    __pyx_t_5 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:         if not (read.flag &amp; samFlagExclude):</pre>
<pre class='cython code score-14 '>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_flag);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_samFlagExclude);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_10 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_5, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_10); if (unlikely((__pyx_t_4 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    __pyx_t_13 = (!__pyx_t_4);
    if (__pyx_t_13) {
/* … */
    }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">087</span>:             lastPos = read.reference_end</pre>
<pre class='cython code score-8 '>      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_reference_end);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 87, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_3 = __Pyx_PyLong_As_uint64_t(__pyx_t_10); if (unlikely((__pyx_t_3 == ((uint64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 87, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
      __pyx_v_lastPos = __pyx_t_3;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>:     aln.close()</pre>
<pre class='cython code score-5 '>  __pyx_t_10 = ((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
  __pyx_t_9 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_10, NULL};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_9, (1-__pyx_t_9) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:     return lastPos</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_lastPos;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">090</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">091</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">092</span>: </pre>
<pre class="cython line score-99" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">093</span>: cpdef uint32_t cgetReadLength(str bamFile, uint32_t minReads, uint32_t samThreads, uint32_t maxIterations, int samFlagExclude):</pre>
<pre class='cython code score-99 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_7cgetReadLength(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static uint32_t __pyx_f_10consenrich_11cconsenrich_cgetReadLength(PyObject *__pyx_v_bamFile, uint32_t __pyx_v_minReads, uint32_t __pyx_v_samThreads, uint32_t __pyx_v_maxIterations, int __pyx_v_samFlagExclude, CYTHON_UNUSED int __pyx_skip_dispatch) {
  uint32_t __pyx_v_observedReads;
  uint32_t __pyx_v_currentIterations;
  struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *__pyx_v_aln = 0;
  struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *__pyx_v_read = 0;
  PyArrayObject *__pyx_v_readLengths = 0;
  uint32_t __pyx_v_i;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_readLengths;
  __Pyx_Buffer __pyx_pybuffer_readLengths;
  uint32_t __pyx_r;
  __pyx_pybuffer_readLengths.pybuffer.buf = NULL;
  __pyx_pybuffer_readLengths.refcount = 0;
  __pyx_pybuffernd_readLengths.data = NULL;
  __pyx_pybuffernd_readLengths.rcbuffer = &amp;__pyx_pybuffer_readLengths;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetReadLength", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_read);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_readLengths);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_7cgetReadLength(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_6cgetReadLength, "Get the median read length from a BAM file after fetching a specified number of reads.\n\n    :param bamFile: see :class:`consenrich.core.inputParams`.\n    :type bamFile: str\n    :param minReads: Minimum number of reads to consider for the median calculation.\n    :type minReads: uint32_t\n    :param samThreads: See :class:`consenrich.core.samParams`.\n    :type samThreads: uint32_t\n    :param maxIterations: Maximum number of reads to iterate over.\n    :type maxIterations: uint32_t\n    :param samFlagExclude: See :class:`consenrich.core.samParams`.\n    :type samFlagExclude: int\n    :return: Median read length from the BAM file.\n    :rtype: uint32_t\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_7cgetReadLength = {"cgetReadLength", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_7cgetReadLength, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_6cgetReadLength};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_7cgetReadLength(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_bamFile = 0;
  uint32_t __pyx_v_minReads;
  uint32_t __pyx_v_samThreads;
  uint32_t __pyx_v_maxIterations;
  int __pyx_v_samFlagExclude;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cgetReadLength (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_bamFile,&amp;__pyx_mstate_global-&gt;__pyx_n_u_minReads,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samThreads,&amp;__pyx_mstate_global-&gt;__pyx_n_u_maxIterations,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samFlagExclude,0};
  PyObject* values[5] = {0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cgetReadLength", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 5; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetReadLength", 1, 5, 5, i); <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 5)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
    }
    __pyx_v_bamFile = ((PyObject*)values[0]);
    __pyx_v_minReads = __Pyx_PyLong_As_uint32_t(values[1]); if (unlikely((__pyx_v_minReads == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
    __pyx_v_samThreads = __Pyx_PyLong_As_uint32_t(values[2]); if (unlikely((__pyx_v_samThreads == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
    __pyx_v_maxIterations = __Pyx_PyLong_As_uint32_t(values[3]); if (unlikely((__pyx_v_maxIterations == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
    __pyx_v_samFlagExclude = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[4]); if (unlikely((__pyx_v_samFlagExclude == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetReadLength", 1, 5, 5, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetReadLength", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bamFile), (&amp;PyUnicode_Type), 1, "bamFile", 1))) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_6cgetReadLength(__pyx_self, __pyx_v_bamFile, __pyx_v_minReads, __pyx_v_samThreads, __pyx_v_maxIterations, __pyx_v_samFlagExclude);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_6cgetReadLength(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bamFile, uint32_t __pyx_v_minReads, uint32_t __pyx_v_samThreads, uint32_t __pyx_v_maxIterations, int __pyx_v_samFlagExclude) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_cgetReadLength(__pyx_v_bamFile, __pyx_v_minReads, __pyx_v_samThreads, __pyx_v_maxIterations, __pyx_v_samFlagExclude, 1); if (unlikely(__pyx_t_1 == ((uint32_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
  __pyx_t_2 = __Pyx_PyLong_From_uint32_t(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetReadLength", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_7cgetReadLength, 0, __pyx_mstate_global-&gt;__pyx_n_u_cgetReadLength, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[3]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 93, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cgetReadLength, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 93, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">094</span>:     r"""Get the median read length from a BAM file after fetching a specified number of reads.</pre>
<pre class="cython line score-0">&#xA0;<span class="">095</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">096</span>:     :param bamFile: see :class:`consenrich.core.inputParams`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">097</span>:     :type bamFile: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">098</span>:     :param minReads: Minimum number of reads to consider for the median calculation.</pre>
<pre class="cython line score-0">&#xA0;<span class="">099</span>:     :type minReads: uint32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">100</span>:     :param samThreads: See :class:`consenrich.core.samParams`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">101</span>:     :type samThreads: uint32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">102</span>:     :param maxIterations: Maximum number of reads to iterate over.</pre>
<pre class="cython line score-0">&#xA0;<span class="">103</span>:     :type maxIterations: uint32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">104</span>:     :param samFlagExclude: See :class:`consenrich.core.samParams`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">105</span>:     :type samFlagExclude: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">106</span>:     :return: Median read length from the BAM file.</pre>
<pre class="cython line score-0">&#xA0;<span class="">107</span>:     :rtype: uint32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">108</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>:     cdef uint32_t observedReads = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_observedReads = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:     cdef uint32_t currentIterations = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_currentIterations = 0;
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:     cdef AlignmentFile aln = AlignmentFile(bamFile, 'rb', threads=samThreads)</pre>
<pre class='cython code score-11 '>  __pyx_t_2 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile);
  __pyx_t_3 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile); 
  __pyx_t_4 = __Pyx_PyLong_From_uint32_t(__pyx_v_samThreads);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[3 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_v_bamFile, __pyx_mstate_global-&gt;__pyx_n_u_rb};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_threads, __pyx_t_4, __pyx_t_6, __pyx_callargs+3, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_1);
  }
  __pyx_v_aln = ((struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">112</span>:     cdef AlignedSegment read</pre>
<pre class="cython line score-36" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:     cdef cnp.ndarray[cnp.uint32_t, ndim=1] readLengths = np.zeros(maxIterations, dtype=np.uint32)</pre>
<pre class='cython code score-36 '>  __pyx_t_3 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyLong_From_uint32_t(__pyx_v_maxIterations);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_uint32);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_3);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, __pyx_t_6};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 113, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_7, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_readLengths = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 113, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_readLengths.diminfo[0].strides = __pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_readLengths.diminfo[0].shape = __pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_readLengths = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:     cdef uint32_t i = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:     if &lt;uint32_t&gt;aln.mapped &lt; minReads:</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_aln), __pyx_mstate_global-&gt;__pyx_n_u_mapped);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = __Pyx_PyLong_As_uint32_t(__pyx_t_1); if (unlikely((__pyx_t_8 == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 115, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_9 = (((uint32_t)__pyx_t_8) &lt; __pyx_v_minReads);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:         aln.close()</pre>
<pre class='cython code score-5 '>    __pyx_t_4 = ((PyObject *)__pyx_v_aln);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:         return 0</pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     for read in aln.fetch():</pre>
<pre class='cython code score-56 '>  __pyx_t_4 = ((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_4, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fetch, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_4 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_10 = 0;
    __pyx_t_11 = NULL;
  } else {
    __pyx_t_10 = -1; __pyx_t_4 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_11 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 118, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_11)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_4))) {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_4);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_10 &gt;= __pyx_temp) break;
        }
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_4, __pyx_t_10);
        ++__pyx_t_10;
      } else {
        {
          Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_4);
          #if !CYTHON_ASSUME_SAFE_SIZE
          if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
          #endif
          if (__pyx_t_10 &gt;= __pyx_temp) break;
        }
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_4, __pyx_t_10));
        #else
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_4, __pyx_t_10);
        #endif
        ++__pyx_t_10;
      }
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
    } else {
      __pyx_t_1 = __pyx_t_11(__pyx_t_4);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
          <span class='py_c_api'>PyErr_Clear</span>();
        }
        break;
      }
    }
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5pysam_18libcalignedsegment_AlignedSegment))))) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_read, ((struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *)__pyx_t_1));
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  goto __pyx_L10_for_end;
  __pyx_L5_break:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  goto __pyx_L10_for_end;
  __pyx_L10_for_end:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">119</span>:         if not (observedReads &lt; minReads and currentIterations &lt; maxIterations):</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = (__pyx_v_observedReads &lt; __pyx_v_minReads);
    if (__pyx_t_12) {
    } else {
      __pyx_t_9 = __pyx_t_12;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_12 = (__pyx_v_currentIterations &lt; __pyx_v_maxIterations);
    __pyx_t_9 = __pyx_t_12;
    __pyx_L7_bool_binop_done:;
    __pyx_t_12 = (!__pyx_t_9);
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:             break</pre>
<pre class='cython code score-0 '>      goto __pyx_L5_break;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">121</span>:         if not (read.flag &amp; samFlagExclude):</pre>
<pre class='cython code score-14 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_flag);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_samFlagExclude);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 121, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_9 = (!__pyx_t_12);
    if (__pyx_t_9) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">122</span>:             # meets critera -&gt; add it</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:             readLengths[i] = read.query_length</pre>
<pre class='cython code score-8 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_query_length);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 123, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_13 = __Pyx_PyLong_As_npy_uint32(__pyx_t_7); if (unlikely((__pyx_t_13 == ((npy_uint32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_5 = __pyx_v_i;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint32_t *, __pyx_pybuffernd_readLengths.rcbuffer-&gt;pybuffer.buf, __pyx_t_5, __pyx_pybuffernd_readLengths.diminfo[0].strides) = __pyx_t_13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">124</span>:             observedReads += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_observedReads = (__pyx_v_observedReads + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">125</span>:             i += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:         currentIterations += 1</pre>
<pre class='cython code score-0 '>    __pyx_v_currentIterations = (__pyx_v_currentIterations + 1);
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:     aln.close()</pre>
<pre class='cython code score-5 '>  __pyx_t_7 = ((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, NULL};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 127, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">128</span>:     if observedReads &lt; minReads:</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = (__pyx_v_observedReads &lt; __pyx_v_minReads);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">129</span>:         return 0</pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>:     return &lt;uint32_t&gt;np.median(readLengths[:observedReads])</pre>
<pre class='cython code score-35 '>  __pyx_t_7 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_median);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyLong_From_uint32_t(__pyx_v_observedReads);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_readLengths), __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    assert(__pyx_t_7);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_2};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  }
  __pyx_t_8 = __Pyx_PyLong_As_uint32_t(__pyx_t_4); if (unlikely((__pyx_t_8 == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = ((uint32_t)__pyx_t_8);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">131</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>: cdef inline Py_ssize_t floordiv64(int64_t a, int64_t b) nogil:</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE Py_ssize_t __pyx_f_10consenrich_11cconsenrich_floordiv64(int64_t __pyx_v_a, int64_t __pyx_v_b) {
  Py_ssize_t __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:     if a &gt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_a &gt;= 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         return &lt;Py_ssize_t&gt;(a // b)</pre>
<pre class='cython code score-0 '>    __pyx_r = ((Py_ssize_t)(__pyx_v_a / __pyx_v_b));
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">136</span>:     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:         return &lt;Py_ssize_t&gt;(- ((-a + b - 1) // b))</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_r = ((Py_ssize_t)(-((((-__pyx_v_a) + __pyx_v_b) - 1) / __pyx_v_b)));
    goto __pyx_L0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">138</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>: </pre>
<pre class="cython line score-191" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>: cpdef cnp.uint32_t[:] creadBamSegment(</pre>
<pre class='cython code score-191 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_9creadBamSegment(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static __Pyx_memviewslice __pyx_f_10consenrich_11cconsenrich_creadBamSegment(PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, uint32_t __pyx_v_start, uint32_t __pyx_v_end, uint32_t __pyx_v_stepSize, int64_t __pyx_v_readLength, uint8_t __pyx_v_oneReadPerBin, uint16_t __pyx_v_samThreads, uint16_t __pyx_v_samFlagExclude, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_10consenrich_11cconsenrich_creadBamSegment *__pyx_optional_args) {
  int64_t __pyx_v_shiftForwardStrand53 = ((int64_t)0);
  int64_t __pyx_v_shiftReverseStrand53 = ((int64_t)0);
  int64_t __pyx_v_extendBP = ((int64_t)0);
  int64_t __pyx_v_maxInsertSize = ((int64_t)0x3E8);
  int64_t __pyx_v_pairedEndMode = ((int64_t)0);
  int64_t __pyx_v_inferFragmentLength = ((int64_t)0);
  Py_ssize_t __pyx_v_numIntervals;
  PyArrayObject *__pyx_v_values_np = 0;
  __Pyx_memviewslice __pyx_v_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *__pyx_v_aln = 0;
  struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *__pyx_v_read = 0;
  int64_t __pyx_v_start64;
  int64_t __pyx_v_end64;
  int64_t __pyx_v_step64;
  Py_ssize_t __pyx_v_index0;
  Py_ssize_t __pyx_v_index1;
  Py_ssize_t __pyx_v_lastIndex;
  int __pyx_v_readIsForward;
  int64_t __pyx_v_readStart;
  int64_t __pyx_v_readEnd;
  int64_t __pyx_v_adjStart;
  int64_t __pyx_v_adjEnd;
  int64_t __pyx_v_fivePrime;
  int64_t __pyx_v_mid;
  int64_t __pyx_v_midIndex;
  int64_t __pyx_v_tlen;
  int64_t __pyx_v_atlen;
  uint16_t __pyx_v_flag;
  Py_ssize_t __pyx_v_b_;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_values_np;
  __Pyx_Buffer __pyx_pybuffer_values_np;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_shiftForwardStrand53 = __pyx_optional_args-&gt;shiftForwardStrand53;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_shiftReverseStrand53 = __pyx_optional_args-&gt;shiftReverseStrand53;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_extendBP = __pyx_optional_args-&gt;extendBP;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_maxInsertSize = __pyx_optional_args-&gt;maxInsertSize;
            if (__pyx_optional_args-&gt;__pyx_n &gt; 4) {
              __pyx_v_pairedEndMode = __pyx_optional_args-&gt;pairedEndMode;
              if (__pyx_optional_args-&gt;__pyx_n &gt; 5) {
                __pyx_v_inferFragmentLength = __pyx_optional_args-&gt;inferFragmentLength;
              }
            }
          }
        }
      }
    }
  }
  __pyx_pybuffer_values_np.pybuffer.buf = NULL;
  __pyx_pybuffer_values_np.refcount = 0;
  __pyx_pybuffernd_values_np.data = NULL;
  __pyx_pybuffernd_values_np.rcbuffer = &amp;__pyx_pybuffer_values_np;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_values_np.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.creadBamSegment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_values_np.rcbuffer-&gt;pybuffer);
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_values_np);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_values, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_read);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_9creadBamSegment(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_8creadBamSegment, "Count reads in a BAM file for a given chromosome");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_9creadBamSegment = {"creadBamSegment", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_9creadBamSegment, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_8creadBamSegment};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_9creadBamSegment(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_bamFile = 0;
  PyObject *__pyx_v_chromosome = 0;
  uint32_t __pyx_v_start;
  uint32_t __pyx_v_end;
  uint32_t __pyx_v_stepSize;
  int64_t __pyx_v_readLength;
  uint8_t __pyx_v_oneReadPerBin;
  uint16_t __pyx_v_samThreads;
  uint16_t __pyx_v_samFlagExclude;
  int64_t __pyx_v_shiftForwardStrand53;
  int64_t __pyx_v_shiftReverseStrand53;
  int64_t __pyx_v_extendBP;
  int64_t __pyx_v_maxInsertSize;
  int64_t __pyx_v_pairedEndMode;
  int64_t __pyx_v_inferFragmentLength;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("creadBamSegment (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_bamFile,&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromosome,&amp;__pyx_mstate_global-&gt;__pyx_n_u_start,&amp;__pyx_mstate_global-&gt;__pyx_n_u_end,&amp;__pyx_mstate_global-&gt;__pyx_n_u_stepSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_readLength,&amp;__pyx_mstate_global-&gt;__pyx_n_u_oneReadPerBin,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samThreads,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samFlagExclude,&amp;__pyx_mstate_global-&gt;__pyx_n_u_shiftForwardStrand53,&amp;__pyx_mstate_global-&gt;__pyx_n_u_shiftReverseStrand53,&amp;__pyx_mstate_global-&gt;__pyx_n_u_extendBP,&amp;__pyx_mstate_global-&gt;__pyx_n_u_maxInsertSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_pairedEndMode,&amp;__pyx_mstate_global-&gt;__pyx_n_u_inferFragmentLength,0};
  PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case 15:
        values[14] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 14);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[14])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 14:
        values[13] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 13);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[13])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 13:
        values[12] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 12);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[12])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 12:
        values[11] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 11);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[11])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 11:
        values[10] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 10);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[10])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 10:
        values[9] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 9);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[9])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  9:
        values[8] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 8);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[8])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  8:
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "creadBamSegment", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 9; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("creadBamSegment", 0, 9, 15, i); <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case 15:
        values[14] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 14);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[14])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 14:
        values[13] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 13);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[13])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 13:
        values[12] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 12);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[12])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 12:
        values[11] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 11);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[11])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 11:
        values[10] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 10);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[10])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 10:
        values[9] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 9);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[9])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  9:
        values[8] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 8);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[8])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_bamFile = ((PyObject*)values[0]);
    __pyx_v_chromosome = ((PyObject*)values[1]);
    __pyx_v_start = __Pyx_PyLong_As_uint32_t(values[2]); if (unlikely((__pyx_v_start == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 143, __pyx_L3_error)</span>
    __pyx_v_end = __Pyx_PyLong_As_uint32_t(values[3]); if (unlikely((__pyx_v_end == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 144, __pyx_L3_error)</span>
    __pyx_v_stepSize = __Pyx_PyLong_As_uint32_t(values[4]); if (unlikely((__pyx_v_stepSize == ((uint32_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 145, __pyx_L3_error)</span>
    __pyx_v_readLength = __Pyx_PyLong_As_int64_t(values[5]); if (unlikely((__pyx_v_readLength == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 146, __pyx_L3_error)</span>
    __pyx_v_oneReadPerBin = __Pyx_PyLong_As_uint8_t(values[6]); if (unlikely((__pyx_v_oneReadPerBin == ((uint8_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 147, __pyx_L3_error)</span>
    __pyx_v_samThreads = __Pyx_PyLong_As_uint16_t(values[7]); if (unlikely((__pyx_v_samThreads == ((uint16_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 148, __pyx_L3_error)</span>
    __pyx_v_samFlagExclude = __Pyx_PyLong_As_uint16_t(values[8]); if (unlikely((__pyx_v_samFlagExclude == ((uint16_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 149, __pyx_L3_error)</span>
    if (values[9]) {
      __pyx_v_shiftForwardStrand53 = __Pyx_PyLong_As_int64_t(values[9]); if (unlikely((__pyx_v_shiftForwardStrand53 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 150, __pyx_L3_error)</span>
    } else {
      __pyx_v_shiftForwardStrand53 = ((int64_t)0);
    }
    if (values[10]) {
      __pyx_v_shiftReverseStrand53 = __Pyx_PyLong_As_int64_t(values[10]); if (unlikely((__pyx_v_shiftReverseStrand53 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 151, __pyx_L3_error)</span>
    } else {
      __pyx_v_shiftReverseStrand53 = ((int64_t)0);
    }
    if (values[11]) {
      __pyx_v_extendBP = __Pyx_PyLong_As_int64_t(values[11]); if (unlikely((__pyx_v_extendBP == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 152, __pyx_L3_error)</span>
    } else {
      __pyx_v_extendBP = ((int64_t)0);
    }
    if (values[12]) {
      __pyx_v_maxInsertSize = __Pyx_PyLong_As_int64_t(values[12]); if (unlikely((__pyx_v_maxInsertSize == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 153, __pyx_L3_error)</span>
    } else {
      __pyx_v_maxInsertSize = ((int64_t)0x3E8);
    }
    if (values[13]) {
      __pyx_v_pairedEndMode = __Pyx_PyLong_As_int64_t(values[13]); if (unlikely((__pyx_v_pairedEndMode == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 154, __pyx_L3_error)</span>
    } else {
      __pyx_v_pairedEndMode = ((int64_t)0);
    }
    if (values[14]) {
      __pyx_v_inferFragmentLength = __Pyx_PyLong_As_int64_t(values[14]); if (unlikely((__pyx_v_inferFragmentLength == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 155, __pyx_L3_error)</span>
    } else {
      __pyx_v_inferFragmentLength = ((int64_t)0);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("creadBamSegment", 0, 9, 15, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.creadBamSegment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bamFile), (&amp;PyUnicode_Type), 1, "bamFile", 1))) <span class='error_goto'>__PYX_ERR(0, 141, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chromosome), (&amp;PyUnicode_Type), 1, "chromosome", 1))) <span class='error_goto'>__PYX_ERR(0, 142, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_8creadBamSegment(__pyx_self, __pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_start, __pyx_v_end, __pyx_v_stepSize, __pyx_v_readLength, __pyx_v_oneReadPerBin, __pyx_v_samThreads, __pyx_v_samFlagExclude, __pyx_v_shiftForwardStrand53, __pyx_v_shiftReverseStrand53, __pyx_v_extendBP, __pyx_v_maxInsertSize, __pyx_v_pairedEndMode, __pyx_v_inferFragmentLength);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_8creadBamSegment(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, uint32_t __pyx_v_start, uint32_t __pyx_v_end, uint32_t __pyx_v_stepSize, int64_t __pyx_v_readLength, uint8_t __pyx_v_oneReadPerBin, uint16_t __pyx_v_samThreads, uint16_t __pyx_v_samFlagExclude, int64_t __pyx_v_shiftForwardStrand53, int64_t __pyx_v_shiftReverseStrand53, int64_t __pyx_v_extendBP, int64_t __pyx_v_maxInsertSize, int64_t __pyx_v_pairedEndMode, int64_t __pyx_v_inferFragmentLength) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 6;
  __pyx_t_2.shiftForwardStrand53 = __pyx_v_shiftForwardStrand53;
  __pyx_t_2.shiftReverseStrand53 = __pyx_v_shiftReverseStrand53;
  __pyx_t_2.extendBP = __pyx_v_extendBP;
  __pyx_t_2.maxInsertSize = __pyx_v_maxInsertSize;
  __pyx_t_2.pairedEndMode = __pyx_v_pairedEndMode;
  __pyx_t_2.inferFragmentLength = __pyx_v_inferFragmentLength;
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_creadBamSegment(__pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_start, __pyx_v_end, __pyx_v_stepSize, __pyx_v_readLength, __pyx_v_oneReadPerBin, __pyx_v_samThreads, __pyx_v_samFlagExclude, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  __pyx_t_3 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_nn___pyx_t_5numpy_uint32_t, (int (*)(char *, PyObject *)) __pyx_memview_set_nn___pyx_t_5numpy_uint32_t, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL; __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.creadBamSegment", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_9creadBamSegment, 0, __pyx_mstate_global-&gt;__pyx_n_u_creadBamSegment, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[4]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_tuple[4]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_creadBamSegment, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[4] = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_1000, __pyx_mstate_global-&gt;__pyx_int_0, __pyx_mstate_global-&gt;__pyx_int_0); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[4])) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[4]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[4]);
/* … */
struct __pyx_opt_args_10consenrich_11cconsenrich_creadBamSegment {
  int __pyx_n;
  int64_t shiftForwardStrand53;
  int64_t shiftReverseStrand53;
  int64_t extendBP;
  int64_t maxInsertSize;
  int64_t pairedEndMode;
  int64_t inferFragmentLength;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">141</span>:     str bamFile,</pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>:     str chromosome,</pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>:     uint32_t start,</pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>:     uint32_t end,</pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>:     uint32_t stepSize,</pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>:     int64_t readLength,</pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>:     uint8_t oneReadPerBin,</pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>:     uint16_t samThreads,</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>:     uint16_t samFlagExclude,</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>:     int64_t shiftForwardStrand53 = 0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>:     int64_t shiftReverseStrand53 = 0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>:     int64_t extendBP = 0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>:     int64_t maxInsertSize=1000,</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>:     int64_t pairedEndMode=0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>:     int64_t inferFragmentLength=0):</pre>
<pre class="cython line score-0">&#xA0;<span class="">156</span>:     r"""Count reads in a BAM file for a given chromosome"""</pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">158</span>:     cdef Py_ssize_t numIntervals = &lt;Py_ssize_t&gt;(((end - start) + stepSize - 1) // stepSize)</pre>
<pre class='cython code score-0 '>  __pyx_v_numIntervals = ((Py_ssize_t)((((__pyx_v_end - __pyx_v_start) + __pyx_v_stepSize) - 1) / __pyx_v_stepSize));
</pre><pre class="cython line score-0">&#xA0;<span class="">159</span>: </pre>
<pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>:     cdef cnp.ndarray[cnp.uint32_t, ndim=1] values_np = np.zeros(numIntervals, dtype=np.uint32)</pre>
<pre class='cython code score-41 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_numIntervals);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_uint32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 160, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_5, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_values_np.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_values_np = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_values_np.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 160, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_values_np.diminfo[0].strides = __pyx_pybuffernd_values_np.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_values_np.diminfo[0].shape = __pyx_pybuffernd_values_np.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_values_np = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">161</span>:     cdef cnp.uint32_t[::1] values = values_np</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_uint32_t(((PyObject *)__pyx_v_values_np), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 161, __pyx_L1_error)</span>
  __pyx_v_values = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">162</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>:     if numIntervals &lt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = (__pyx_v_numIntervals &lt;= 0);
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">164</span>:         return values</pre>
<pre class='cython code score-0 '>    __PYX_INC_MEMVIEW(&amp;__pyx_v_values, 1);
    __pyx_r = __pyx_v_values;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">165</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>:     cdef AlignmentFile aln = AlignmentFile(bamFile, 'rb', threads=samThreads)</pre>
<pre class='cython code score-11 '>  __pyx_t_4 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile);
  __pyx_t_5 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile); 
  __pyx_t_6 = __Pyx_PyLong_From_uint16_t(__pyx_v_samThreads);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = 1;
  {
    PyObject *__pyx_callargs[3 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_v_bamFile, __pyx_mstate_global-&gt;__pyx_n_u_rb};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_threads, __pyx_t_6, __pyx_t_3, __pyx_callargs+3, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_5, __pyx_callargs+__pyx_t_7, (3-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 166, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_1);
  }
  __pyx_v_aln = ((struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>:     cdef AlignedSegment read</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>:     cdef int64_t start64 = start</pre>
<pre class='cython code score-0 '>  __pyx_v_start64 = __pyx_v_start;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>:     cdef int64_t end64 = end</pre>
<pre class='cython code score-0 '>  __pyx_v_end64 = __pyx_v_end;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">170</span>:     cdef int64_t step64 = stepSize</pre>
<pre class='cython code score-0 '>  __pyx_v_step64 = __pyx_v_stepSize;
</pre><pre class="cython line score-0">&#xA0;<span class="">171</span>:     cdef Py_ssize_t i, index0, index1</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>:     cdef Py_ssize_t lastIndex = numIntervals - 1</pre>
<pre class='cython code score-0 '>  __pyx_v_lastIndex = (__pyx_v_numIntervals - 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">173</span>:     cdef bint readIsForward</pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>:     cdef int64_t readStart, readEnd</pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>:     cdef int64_t adjStart, adjEnd, fivePrime, mid, midIndex, tlen, atlen</pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>:     cdef uint16_t flag</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>:     if inferFragmentLength &gt; 0 and pairedEndMode == 0 and extendBP == 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = (__pyx_v_inferFragmentLength &gt; 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_9 = __pyx_t_10;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_10 = (__pyx_v_pairedEndMode == 0);
  if (__pyx_t_10) {
  } else {
    __pyx_t_9 = __pyx_t_10;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_10 = (__pyx_v_extendBP == 0);
  __pyx_t_9 = __pyx_t_10;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_9) {
/* … */
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>:         extendBP = cgetFragmentLength(bamFile,</pre>
<pre class='cython code score-5 '>    __pyx_t_12.__pyx_n = 4;
    __pyx_t_12.samThreads = __pyx_v_samThreads;
    __pyx_t_12.samFlagExclude = __pyx_v_samFlagExclude;
    __pyx_t_12.maxInsertSize = __pyx_v_maxInsertSize;
    __pyx_t_12.minInsertSize = ((int64_t)(__pyx_v_readLength + 1));
    __pyx_t_11 = __pyx_f_10consenrich_11cconsenrich_cgetFragmentLength(__pyx_v_bamFile, __pyx_v_chromosome, ((int64_t)__pyx_v_start), ((int64_t)__pyx_v_end), 0, &amp;__pyx_t_12); if (unlikely(__pyx_t_11 == ((int64_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 178, __pyx_L1_error)</span>
    __pyx_v_extendBP = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">179</span>:          chromosome,</pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>:          &lt;int64_t&gt;start,</pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>:          &lt;int64_t&gt;end,</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>:          samThreads = samThreads,</pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>:          samFlagExclude=samFlagExclude,</pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>:          maxInsertSize=maxInsertSize,</pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>:          minInsertSize=&lt;int64_t&gt;(readLength+1), # xCorr peak &gt; rlen ~~&gt; fraglen</pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>:          )</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>:     try:</pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">188</span>:         with aln:</pre>
<pre class='cython code score-63 '>    /*with:*/ {
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(((PyObject *)__pyx_v_aln), __pyx_mstate_global-&gt;__pyx_n_u_exit);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 188, __pyx_L9_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      __pyx_t_5 = NULL;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(((PyObject *)__pyx_v_aln), __pyx_mstate_global-&gt;__pyx_n_u_enter);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 188, __pyx_L11_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = 1;
      #if CYTHON_UNPACK_METHODS
      if (likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        assert(__pyx_t_5);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
        __pyx_t_7 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_5, NULL};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_7, (1-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L11_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      /*try:*/ {
        {
          /*try:*/ {
/* … */
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          goto __pyx_L20_try_end;
          __pyx_L15_error:;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
          __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
          /*except:*/ {
            <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.creadBamSegment", __pyx_clineno, __pyx_lineno, __pyx_filename);
            if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_6, &amp;__pyx_t_3, &amp;__pyx_t_5) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L17_except_error)</span>
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_6);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
            <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);
            __pyx_t_1 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_6, __pyx_t_3, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 188, __pyx_L17_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_t_1, NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            if (unlikely(!__pyx_t_24)) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L17_except_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
            __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_24);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
            if (__pyx_t_9 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L17_except_error)</span>
            __pyx_t_10 = (!__pyx_t_9);
            if (unlikely(__pyx_t_10)) {
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
              <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
              <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_5);
              <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_6, __pyx_t_3, __pyx_t_5);
              __pyx_t_6 = 0;  __pyx_t_3 = 0;  __pyx_t_5 = 0; 
              <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L17_except_error)</span>
            }
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
            <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
            goto __pyx_L16_exception_handled;
          }
          __pyx_L17_except_error:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_14, __pyx_t_15, __pyx_t_16);
          goto __pyx_L9_error;
          __pyx_L16_exception_handled:;
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
          <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
          <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_14, __pyx_t_15, __pyx_t_16);
          __pyx_L20_try_end:;
        }
      }
      /*finally:*/ {
        /*normal exit:*/{
          if (__pyx_t_13) {
            __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_13, __pyx_mstate_global-&gt;__pyx_tuple[2], NULL);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
            if (unlikely(!__pyx_t_16)) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L9_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          }
          goto __pyx_L14;
        }
        __pyx_L14:;
      }
      goto __pyx_L63;
      __pyx_L11_error:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      goto __pyx_L9_error;
      __pyx_L63:;
    }
  }
/* … */
  __pyx_mstate_global-&gt;__pyx_tuple[2] = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None); if (unlikely(!__pyx_mstate_global-&gt;__pyx_tuple[2])) <span class='error_goto'>__PYX_ERR(0, 188, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[2]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_tuple[2]);
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>:             for read in aln.fetch(chromosome, start64, end64):</pre>
<pre class='cython code score-57 '>            __pyx_t_3 = ((PyObject *)__pyx_v_aln);
            <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
            __pyx_t_5 = __Pyx_PyLong_From_int64_t(__pyx_v_start64);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 189, __pyx_L15_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
            __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_end64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 189, __pyx_L15_error)</span>
            <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
            __pyx_t_7 = 0;
            {
              PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_v_chromosome, __pyx_t_5, __pyx_t_6};
              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fetch, __pyx_callargs+__pyx_t_7, (4-__pyx_t_7) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
              <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
              if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L15_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
            }
            if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
              __pyx_t_6 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
              __pyx_t_17 = 0;
              __pyx_t_18 = NULL;
            } else {
              __pyx_t_17 = -1; __pyx_t_6 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 189, __pyx_L15_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
              __pyx_t_18 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 189, __pyx_L15_error)</span>
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
            for (;;) {
              if (likely(!__pyx_t_18)) {
                if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
                  {
                    Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_6);
                    #if !CYTHON_ASSUME_SAFE_SIZE
                    if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L15_error)</span>
                    #endif
                    if (__pyx_t_17 &gt;= __pyx_temp) break;
                  }
                  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_6, __pyx_t_17);
                  ++__pyx_t_17;
                } else {
                  {
                    Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_6);
                    #if !CYTHON_ASSUME_SAFE_SIZE
                    if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L15_error)</span>
                    #endif
                    if (__pyx_t_17 &gt;= __pyx_temp) break;
                  }
                  #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
                  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_6, __pyx_t_17));
                  #else
                  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_6, __pyx_t_17);
                  #endif
                  ++__pyx_t_17;
                }
                if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L15_error)</span>
              } else {
                __pyx_t_1 = __pyx_t_18(__pyx_t_6);
                if (unlikely(!__pyx_t_1)) {
                  PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
                  if (exc_type) {
                    if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L15_error)</span>
                    <span class='py_c_api'>PyErr_Clear</span>();
                  }
                  break;
                }
              }
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5pysam_18libcalignedsegment_AlignedSegment))))) <span class='error_goto'>__PYX_ERR(0, 189, __pyx_L15_error)</span>
              <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_read, ((struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *)__pyx_t_1));
              __pyx_t_1 = 0;
/* … */
              __pyx_L21_continue:;
            }
            <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>:                 flag = &lt;uint16_t&gt;read.flag</pre>
<pre class='cython code score-8 '>              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_flag);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 190, __pyx_L15_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              __pyx_t_19 = __Pyx_PyLong_As_uint16_t(__pyx_t_1); if (unlikely((__pyx_t_19 == ((uint16_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 190, __pyx_L15_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_v_flag = ((uint16_t)__pyx_t_19);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">191</span>:                 if flag &amp; samFlagExclude:</pre>
<pre class='cython code score-0 '>              __pyx_t_9 = ((__pyx_v_flag &amp; __pyx_v_samFlagExclude) != 0);
              if (__pyx_t_9) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>:                     continue</pre>
<pre class='cython code score-0 '>                goto __pyx_L21_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">193</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">194</span>:                 readIsForward = (flag &amp; 16) == 0</pre>
<pre class='cython code score-0 '>              __pyx_v_readIsForward = ((__pyx_v_flag &amp; 16) == 0);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>:                 readStart = &lt;int64_t&gt;read.reference_start</pre>
<pre class='cython code score-8 '>              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_reference_start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L15_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              __pyx_t_11 = __Pyx_PyLong_As_int64_t(__pyx_t_1); if (unlikely((__pyx_t_11 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 195, __pyx_L15_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_v_readStart = ((int64_t)__pyx_t_11);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>:                 readEnd   = &lt;int64_t&gt;read.reference_end</pre>
<pre class='cython code score-8 '>              __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_reference_end);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 196, __pyx_L15_error)</span>
              <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
              __pyx_t_11 = __Pyx_PyLong_As_int64_t(__pyx_t_1); if (unlikely((__pyx_t_11 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 196, __pyx_L15_error)</span>
              <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
              __pyx_v_readEnd = ((int64_t)__pyx_t_11);
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:                 if pairedEndMode &gt; 0:</pre>
<pre class='cython code score-0 '>              __pyx_t_9 = (__pyx_v_pairedEndMode &gt; 0);
              if (__pyx_t_9) {
/* … */
                goto __pyx_L24;
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:                     if flag &amp; 1 == 0: # not a paired read</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = ((__pyx_v_flag &amp; 1) == 0);
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">200</span>:                         continue</pre>
<pre class='cython code score-0 '>                  goto __pyx_L21_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">201</span>:                     # use first in pair + fragment</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:                     if flag &amp; 128:</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = ((__pyx_v_flag &amp; 0x80) != 0);
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:                         continue</pre>
<pre class='cython code score-0 '>                  goto __pyx_L21_continue;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>:                     if (flag &amp; 8) or read.next_reference_id != read.reference_id:</pre>
<pre class='cython code score-14 '>                __pyx_t_10 = ((__pyx_v_flag &amp; 8) != 0);
                if (!__pyx_t_10) {
                } else {
                  __pyx_t_9 = __pyx_t_10;
                  goto __pyx_L28_bool_binop_done;
                }
                __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_next_reference_id);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 204, __pyx_L15_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
                __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_reference_id);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 204, __pyx_L15_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
                __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_5, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 204, __pyx_L15_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
                __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_10 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 204, __pyx_L15_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_t_9 = __pyx_t_10;
                __pyx_L28_bool_binop_done:;
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>:                         continue</pre>
<pre class='cython code score-0 '>                  goto __pyx_L21_continue;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:                     tlen = &lt;int64_t&gt;read.template_length</pre>
<pre class='cython code score-8 '>                __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read), __pyx_mstate_global-&gt;__pyx_n_u_template_length);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 206, __pyx_L15_error)</span>
                <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
                __pyx_t_11 = __Pyx_PyLong_As_int64_t(__pyx_t_3); if (unlikely((__pyx_t_11 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 206, __pyx_L15_error)</span>
                <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
                __pyx_v_tlen = ((int64_t)__pyx_t_11);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:                     atlen = tlen if tlen &gt;= 0 else -tlen</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = (__pyx_v_tlen &gt;= 0);
                if (__pyx_t_9) {
                  __pyx_t_11 = __pyx_v_tlen;
                } else {
                  __pyx_t_11 = (-__pyx_v_tlen);
                }
                __pyx_v_atlen = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>:                     if atlen == 0 or atlen &gt; maxInsertSize:</pre>
<pre class='cython code score-0 '>                __pyx_t_10 = (__pyx_v_atlen == 0);
                if (!__pyx_t_10) {
                } else {
                  __pyx_t_9 = __pyx_t_10;
                  goto __pyx_L31_bool_binop_done;
                }
                __pyx_t_10 = (__pyx_v_atlen &gt; __pyx_v_maxInsertSize);
                __pyx_t_9 = __pyx_t_10;
                __pyx_L31_bool_binop_done:;
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:                         continue</pre>
<pre class='cython code score-0 '>                  goto __pyx_L21_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:                     if tlen &gt;= 0:</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = (__pyx_v_tlen &gt;= 0);
                if (__pyx_t_9) {
/* … */
                  goto __pyx_L33;
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:                         adjStart = readStart</pre>
<pre class='cython code score-0 '>                  __pyx_v_adjStart = __pyx_v_readStart;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">212</span>:                         adjEnd   = readStart + atlen</pre>
<pre class='cython code score-0 '>                  __pyx_v_adjEnd = (__pyx_v_readStart + __pyx_v_atlen);
</pre><pre class="cython line score-0">&#xA0;<span class="">213</span>:                     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>:                         adjEnd   = readEnd</pre>
<pre class='cython code score-0 '>                /*else*/ {
                  __pyx_v_adjEnd = __pyx_v_readEnd;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">215</span>:                         adjStart = adjEnd - atlen</pre>
<pre class='cython code score-0 '>                  __pyx_v_adjStart = (__pyx_v_adjEnd - __pyx_v_atlen);
                }
                __pyx_L33:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>:                     if shiftForwardStrand53 != 0 or shiftReverseStrand53 != 0:</pre>
<pre class='cython code score-0 '>                __pyx_t_10 = (__pyx_v_shiftForwardStrand53 != 0);
                if (!__pyx_t_10) {
                } else {
                  __pyx_t_9 = __pyx_t_10;
                  goto __pyx_L35_bool_binop_done;
                }
                __pyx_t_10 = (__pyx_v_shiftReverseStrand53 != 0);
                __pyx_t_9 = __pyx_t_10;
                __pyx_L35_bool_binop_done:;
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>:                         if readIsForward:</pre>
<pre class='cython code score-0 '>                  if (__pyx_v_readIsForward) {
/* … */
                    goto __pyx_L37;
                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">218</span>:                             adjStart += shiftForwardStrand53</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjStart = (__pyx_v_adjStart + __pyx_v_shiftForwardStrand53);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>:                             adjEnd   += shiftForwardStrand53</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjEnd = (__pyx_v_adjEnd + __pyx_v_shiftForwardStrand53);
</pre><pre class="cython line score-0">&#xA0;<span class="">220</span>:                         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:                             adjStart -= shiftReverseStrand53</pre>
<pre class='cython code score-0 '>                  /*else*/ {
                    __pyx_v_adjStart = (__pyx_v_adjStart - __pyx_v_shiftReverseStrand53);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:                             adjEnd   -= shiftReverseStrand53</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjEnd = (__pyx_v_adjEnd - __pyx_v_shiftReverseStrand53);
                  }
                  __pyx_L37:;
</pre><pre class="cython line score-0">&#xA0;<span class="">223</span>:                 else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">224</span>:                     # SE</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:                     if readIsForward:</pre>
<pre class='cython code score-0 '>              /*else*/ {
                if (__pyx_v_readIsForward) {
/* … */
                  goto __pyx_L38;
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:                         fivePrime = readStart + shiftForwardStrand53</pre>
<pre class='cython code score-0 '>                  __pyx_v_fivePrime = (__pyx_v_readStart + __pyx_v_shiftForwardStrand53);
</pre><pre class="cython line score-0">&#xA0;<span class="">227</span>:                     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:                         fivePrime = (readEnd - 1) - shiftReverseStrand53</pre>
<pre class='cython code score-0 '>                /*else*/ {
                  __pyx_v_fivePrime = ((__pyx_v_readEnd - 1) - __pyx_v_shiftReverseStrand53);
                }
                __pyx_L38:;
</pre><pre class="cython line score-0">&#xA0;<span class="">229</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>:                     if extendBP &gt; 0:</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = (__pyx_v_extendBP &gt; 0);
                if (__pyx_t_9) {
/* … */
                  goto __pyx_L39;
                }
</pre><pre class="cython line score-0">&#xA0;<span class="">231</span>:                         # from the cut 5' --&gt; 3'</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">232</span>:                         if readIsForward:</pre>
<pre class='cython code score-0 '>                  if (__pyx_v_readIsForward) {
/* … */
                    goto __pyx_L40;
                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">233</span>:                             adjStart = fivePrime</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjStart = __pyx_v_fivePrime;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>:                             adjEnd   = fivePrime + extendBP</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjEnd = (__pyx_v_fivePrime + __pyx_v_extendBP);
</pre><pre class="cython line score-0">&#xA0;<span class="">235</span>:                         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>:                             adjEnd   = fivePrime + 1</pre>
<pre class='cython code score-0 '>                  /*else*/ {
                    __pyx_v_adjEnd = (__pyx_v_fivePrime + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>:                             adjStart = adjEnd - extendBP</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjStart = (__pyx_v_adjEnd - __pyx_v_extendBP);
                  }
                  __pyx_L40:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:                     elif shiftForwardStrand53 != 0 or shiftReverseStrand53 != 0:</pre>
<pre class='cython code score-0 '>                __pyx_t_10 = (__pyx_v_shiftForwardStrand53 != 0);
                if (!__pyx_t_10) {
                } else {
                  __pyx_t_9 = __pyx_t_10;
                  goto __pyx_L41_bool_binop_done;
                }
                __pyx_t_10 = (__pyx_v_shiftReverseStrand53 != 0);
                __pyx_t_9 = __pyx_t_10;
                __pyx_L41_bool_binop_done:;
                if (__pyx_t_9) {
/* … */
                  goto __pyx_L39;
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:                         if readIsForward:</pre>
<pre class='cython code score-0 '>                  if (__pyx_v_readIsForward) {
/* … */
                    goto __pyx_L43;
                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:                             adjStart = readStart + shiftForwardStrand53</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjStart = (__pyx_v_readStart + __pyx_v_shiftForwardStrand53);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:                             adjEnd   = readEnd   + shiftForwardStrand53</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjEnd = (__pyx_v_readEnd + __pyx_v_shiftForwardStrand53);
</pre><pre class="cython line score-0">&#xA0;<span class="">242</span>:                         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:                             adjStart = readStart - shiftReverseStrand53</pre>
<pre class='cython code score-0 '>                  /*else*/ {
                    __pyx_v_adjStart = (__pyx_v_readStart - __pyx_v_shiftReverseStrand53);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:                             adjEnd   = readEnd   - shiftReverseStrand53</pre>
<pre class='cython code score-0 '>                    __pyx_v_adjEnd = (__pyx_v_readEnd - __pyx_v_shiftReverseStrand53);
                  }
                  __pyx_L43:;
</pre><pre class="cython line score-0">&#xA0;<span class="">245</span>:                     else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>:                         adjStart = readStart</pre>
<pre class='cython code score-0 '>                /*else*/ {
                  __pyx_v_adjStart = __pyx_v_readStart;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>:                         adjEnd   = readEnd</pre>
<pre class='cython code score-0 '>                  __pyx_v_adjEnd = __pyx_v_readEnd;
                }
                __pyx_L39:;
              }
              __pyx_L24:;
</pre><pre class="cython line score-0">&#xA0;<span class="">248</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">249</span>:                 if adjEnd &lt;= start64 or adjStart &gt;= end64:</pre>
<pre class='cython code score-0 '>              __pyx_t_10 = (__pyx_v_adjEnd &lt;= __pyx_v_start64);
              if (!__pyx_t_10) {
              } else {
                __pyx_t_9 = __pyx_t_10;
                goto __pyx_L45_bool_binop_done;
              }
              __pyx_t_10 = (__pyx_v_adjStart &gt;= __pyx_v_end64);
              __pyx_t_9 = __pyx_t_10;
              __pyx_L45_bool_binop_done:;
              if (__pyx_t_9) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>:                     continue</pre>
<pre class='cython code score-0 '>                goto __pyx_L21_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>:                 if adjStart &lt; start64:</pre>
<pre class='cython code score-0 '>              __pyx_t_9 = (__pyx_v_adjStart &lt; __pyx_v_start64);
              if (__pyx_t_9) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">252</span>:                     adjStart = start64</pre>
<pre class='cython code score-0 '>                __pyx_v_adjStart = __pyx_v_start64;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>:                 if adjEnd &gt; end64:</pre>
<pre class='cython code score-0 '>              __pyx_t_9 = (__pyx_v_adjEnd &gt; __pyx_v_end64);
              if (__pyx_t_9) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:                     adjEnd = end64</pre>
<pre class='cython code score-0 '>                __pyx_v_adjEnd = __pyx_v_end64;
</pre><pre class="cython line score-0">&#xA0;<span class="">255</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:                 if oneReadPerBin:</pre>
<pre class='cython code score-0 '>              __pyx_t_9 = (__pyx_v_oneReadPerBin != 0);
              if (__pyx_t_9) {
/* … */
                goto __pyx_L49;
              }
</pre><pre class="cython line score-0">&#xA0;<span class="">257</span>:                     # +1 at midpoint of frag.</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>:                     mid = (adjStart + adjEnd) // 2</pre>
<pre class='cython code score-0 '>                __pyx_v_mid = ((__pyx_v_adjStart + __pyx_v_adjEnd) / 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:                     midIndex = &lt;Py_ssize_t&gt;((mid - start64) // step64)</pre>
<pre class='cython code score-0 '>                __pyx_v_midIndex = ((Py_ssize_t)((__pyx_v_mid - __pyx_v_start64) / __pyx_v_step64));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:                     if 0 &lt;= midIndex &lt;= lastIndex:</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = (0 &lt;= __pyx_v_midIndex);
                if (__pyx_t_9) {
                  __pyx_t_9 = (__pyx_v_midIndex &lt;= __pyx_v_lastIndex);
                }
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:                         values[midIndex] += &lt;uint32_t&gt;1</pre>
<pre class='cython code score-0 '>                  __pyx_t_20 = __pyx_v_midIndex;
                  *((__pyx_t_5numpy_uint32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_uint32_t *) __pyx_v_values.data) + __pyx_t_20)) )) += ((uint32_t)1);
</pre><pre class="cython line score-0">&#xA0;<span class="">262</span>:                 else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">263</span>:                     # +1 every interval intersecting frag</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:                     index0 = &lt;Py_ssize_t&gt;((adjStart - start64) // step64)</pre>
<pre class='cython code score-0 '>              /*else*/ {
                __pyx_v_index0 = ((Py_ssize_t)((__pyx_v_adjStart - __pyx_v_start64) / __pyx_v_step64));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:                     index1 = &lt;Py_ssize_t&gt;(((adjEnd - 1) - start64) // step64)</pre>
<pre class='cython code score-0 '>                __pyx_v_index1 = ((Py_ssize_t)(((__pyx_v_adjEnd - 1) - __pyx_v_start64) / __pyx_v_step64));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:                     if index0 &lt; 0:</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = (__pyx_v_index0 &lt; 0);
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">267</span>:                         index0 = &lt;Py_ssize_t&gt;0</pre>
<pre class='cython code score-0 '>                  __pyx_v_index0 = ((Py_ssize_t)0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>:                     if index1 &gt; lastIndex:</pre>
<pre class='cython code score-0 '>                __pyx_t_9 = (__pyx_v_index1 &gt; __pyx_v_lastIndex);
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>:                         index1 = lastIndex</pre>
<pre class='cython code score-0 '>                  __pyx_v_index1 = __pyx_v_lastIndex;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">270</span>:                     if index0 &gt; lastIndex or index1 &lt; 0 or index0 &gt; index1:</pre>
<pre class='cython code score-0 '>                __pyx_t_10 = (__pyx_v_index0 &gt; __pyx_v_lastIndex);
                if (!__pyx_t_10) {
                } else {
                  __pyx_t_9 = __pyx_t_10;
                  goto __pyx_L54_bool_binop_done;
                }
                __pyx_t_10 = (__pyx_v_index1 &lt; 0);
                if (!__pyx_t_10) {
                } else {
                  __pyx_t_9 = __pyx_t_10;
                  goto __pyx_L54_bool_binop_done;
                }
                __pyx_t_10 = (__pyx_v_index0 &gt; __pyx_v_index1);
                __pyx_t_9 = __pyx_t_10;
                __pyx_L54_bool_binop_done:;
                if (__pyx_t_9) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>:                         continue</pre>
<pre class='cython code score-0 '>                  goto __pyx_L21_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>:                     for b_ in range(index0, index1 + 1):</pre>
<pre class='cython code score-0 '>                __pyx_t_21 = (__pyx_v_index1 + 1);
                __pyx_t_22 = __pyx_t_21;
                for (__pyx_t_23 = __pyx_v_index0; __pyx_t_23 &lt; __pyx_t_22; __pyx_t_23+=1) {
                  __pyx_v_b_ = __pyx_t_23;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">273</span>:                         values[b_] += &lt;uint32_t&gt;1</pre>
<pre class='cython code score-0 '>                  __pyx_t_20 = __pyx_v_b_;
                  *((__pyx_t_5numpy_uint32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_uint32_t *) __pyx_v_values.data) + __pyx_t_20)) )) += ((uint32_t)1);
                }
              }
              __pyx_L49:;
</pre><pre class="cython line score-0">&#xA0;<span class="">274</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">275</span>:     finally:</pre>
<pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">276</span>:         aln.close()</pre>
<pre class='cython code score-31 '>  /*finally:*/ {
    /*normal exit:*/{
      __pyx_t_3 = ((PyObject *)__pyx_v_aln);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_7 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_7, (1-__pyx_t_7) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L10;
    }
    __pyx_L9_error:;
    /*exception exit:*/{
      __Pyx_PyThreadState_declare
      __Pyx_PyThreadState_assign
      __pyx_t_13 = 0; __pyx_t_16 = 0; __pyx_t_15 = 0; __pyx_t_14 = 0; __pyx_t_24 = 0; __pyx_t_28 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
      __pyx_t_8.memview = NULL; __pyx_t_8.data = NULL;
       <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_14, &amp;__pyx_t_24, &amp;__pyx_t_28);
      if ( unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_13, &amp;__pyx_t_16, &amp;__pyx_t_15) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_13, &amp;__pyx_t_16, &amp;__pyx_t_15);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_13);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_15);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_14);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_28);
      __pyx_t_25 = __pyx_lineno; __pyx_t_26 = __pyx_clineno; __pyx_t_27 = __pyx_filename;
      {
        __pyx_t_3 = ((PyObject *)__pyx_v_aln);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        __pyx_t_7 = 0;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
          __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_7, (1-__pyx_t_7) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 276, __pyx_L65_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_14, __pyx_t_24, __pyx_t_28);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_15);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_13, __pyx_t_16, __pyx_t_15);
      __pyx_t_13 = 0; __pyx_t_16 = 0; __pyx_t_15 = 0; __pyx_t_14 = 0; __pyx_t_24 = 0; __pyx_t_28 = 0;
      __pyx_lineno = __pyx_t_25; __pyx_clineno = __pyx_t_26; __pyx_filename = __pyx_t_27;
      goto __pyx_L1_error;
      __pyx_L65_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_14);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_24);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_28);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_14, __pyx_t_24, __pyx_t_28);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      __pyx_t_14 = 0; __pyx_t_24 = 0; __pyx_t_28 = 0;
      goto __pyx_L1_error;
    }
    __pyx_L10:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">277</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>:     return values</pre>
<pre class='cython code score-0 '>  __PYX_INC_MEMVIEW(&amp;__pyx_v_values, 1);
  __pyx_r = __pyx_v_values;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">279</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">280</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">281</span>: </pre>
<pre class="cython line score-91" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>: cpdef cnp.ndarray[cnp.float32_t, ndim=2] cinvertMatrixE(cnp.ndarray[cnp.float32_t, ndim=1] muncMatrixIter, cnp.float32_t priorCovarianceOO):</pre>
<pre class='cython code score-91 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_11cinvertMatrixE(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyArrayObject *__pyx_f_10consenrich_11cconsenrich_cinvertMatrixE(PyArrayObject *__pyx_v_muncMatrixIter, __pyx_t_5numpy_float32_t __pyx_v_priorCovarianceOO, CYTHON_UNUSED int __pyx_skip_dispatch) {
  int __pyx_v_m;
  PyArrayObject *__pyx_v_inverse = 0;
  PyArrayObject *__pyx_v_muncMatrixInverse = 0;
  float __pyx_v_sqrtPrior;
  PyArrayObject *__pyx_v_uVec = 0;
  float __pyx_v_divisor;
  float __pyx_v_scale;
  float __pyx_v_uVecI;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_inverse;
  __Pyx_Buffer __pyx_pybuffer_inverse;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_muncMatrixInverse;
  __Pyx_Buffer __pyx_pybuffer_muncMatrixInverse;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_muncMatrixIter;
  __Pyx_Buffer __pyx_pybuffer_muncMatrixIter;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_uVec;
  __Pyx_Buffer __pyx_pybuffer_uVec;
  PyArrayObject *__pyx_r = NULL;
  __pyx_pybuffer_inverse.pybuffer.buf = NULL;
  __pyx_pybuffer_inverse.refcount = 0;
  __pyx_pybuffernd_inverse.data = NULL;
  __pyx_pybuffernd_inverse.rcbuffer = &amp;__pyx_pybuffer_inverse;
  __pyx_pybuffer_muncMatrixInverse.pybuffer.buf = NULL;
  __pyx_pybuffer_muncMatrixInverse.refcount = 0;
  __pyx_pybuffernd_muncMatrixInverse.data = NULL;
  __pyx_pybuffernd_muncMatrixInverse.rcbuffer = &amp;__pyx_pybuffer_muncMatrixInverse;
  __pyx_pybuffer_uVec.pybuffer.buf = NULL;
  __pyx_pybuffer_uVec.refcount = 0;
  __pyx_pybuffernd_uVec.data = NULL;
  __pyx_pybuffernd_uVec.rcbuffer = &amp;__pyx_pybuffer_uVec;
  __pyx_pybuffer_muncMatrixIter.pybuffer.buf = NULL;
  __pyx_pybuffer_muncMatrixIter.refcount = 0;
  __pyx_pybuffernd_muncMatrixIter.data = NULL;
  __pyx_pybuffernd_muncMatrixIter.rcbuffer = &amp;__pyx_pybuffer_muncMatrixIter;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_muncMatrixIter, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_muncMatrixIter.diminfo[0].strides = __pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_muncMatrixIter.diminfo[0].shape = __pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cinvertMatrixE", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_inverse);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_muncMatrixInverse);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_uVec);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_11cinvertMatrixE(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_10cinvertMatrixE, "Invert the residual covariance matrix during the forward pass.\n\n    :param muncMatrixIter: The diagonal elements of the covariance matrix at a given genomic interval.\n    :type muncMatrixIter: cnp.ndarray[cnp.float32_t, ndim=1]\n    :param priorCovarianceOO: The a priori 'primary' state variance :math:`P_{[i|i-1,11]}`.\n    :type priorCovarianceOO: cnp.float32_t\n    :return: The inverted covariance matrix.\n    :rtype: cnp.ndarray[cnp.float32_t, ndim=2]\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_11cinvertMatrixE = {"cinvertMatrixE", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_11cinvertMatrixE, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_10cinvertMatrixE};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_11cinvertMatrixE(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_muncMatrixIter = 0;
  __pyx_t_5numpy_float32_t __pyx_v_priorCovarianceOO;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cinvertMatrixE (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_muncMatrixIter,&amp;__pyx_mstate_global-&gt;__pyx_n_u_priorCovarianceOO,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cinvertMatrixE", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cinvertMatrixE", 1, 2, 2, i); <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
    }
    __pyx_v_muncMatrixIter = ((PyArrayObject *)values[0]);
    __pyx_v_priorCovarianceOO = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[1]); if (unlikely((__pyx_v_priorCovarianceOO == ((npy_float32)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cinvertMatrixE", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cinvertMatrixE", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_muncMatrixIter), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "muncMatrixIter", 0))) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_10cinvertMatrixE(__pyx_self, __pyx_v_muncMatrixIter, __pyx_v_priorCovarianceOO);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_10cinvertMatrixE(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_muncMatrixIter, __pyx_t_5numpy_float32_t __pyx_v_priorCovarianceOO) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_muncMatrixIter;
  __Pyx_Buffer __pyx_pybuffer_muncMatrixIter;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_muncMatrixIter.pybuffer.buf = NULL;
  __pyx_pybuffer_muncMatrixIter.refcount = 0;
  __pyx_pybuffernd_muncMatrixIter.data = NULL;
  __pyx_pybuffernd_muncMatrixIter.rcbuffer = &amp;__pyx_pybuffer_muncMatrixIter;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_muncMatrixIter, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_muncMatrixIter.diminfo[0].strides = __pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_muncMatrixIter.diminfo[0].shape = __pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer.shape[0];
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_10consenrich_11cconsenrich_cinvertMatrixE(__pyx_v_muncMatrixIter, __pyx_v_priorCovarianceOO, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 282, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cinvertMatrixE", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_11cinvertMatrixE, 0, __pyx_mstate_global-&gt;__pyx_n_u_cinvertMatrixE, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[5]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 282, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cinvertMatrixE, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 282, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">283</span>:     r"""Invert the residual covariance matrix during the forward pass.</pre>
<pre class="cython line score-0">&#xA0;<span class="">284</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">285</span>:     :param muncMatrixIter: The diagonal elements of the covariance matrix at a given genomic interval.</pre>
<pre class="cython line score-0">&#xA0;<span class="">286</span>:     :type muncMatrixIter: cnp.ndarray[cnp.float32_t, ndim=1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">287</span>:     :param priorCovarianceOO: The a priori 'primary' state variance :math:`P_{[i|i-1,11]}`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">288</span>:     :type priorCovarianceOO: cnp.float32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">289</span>:     :return: The inverted covariance matrix.</pre>
<pre class="cython line score-0">&#xA0;<span class="">290</span>:     :rtype: cnp.ndarray[cnp.float32_t, ndim=2]</pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>:     cdef int m = muncMatrixIter.size</pre>
<pre class='cython code score-0 '>  __pyx_v_m = __pyx_f_5numpy_7ndarray_4size_size(((PyArrayObject *)__pyx_v_muncMatrixIter));
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>:     # we have to invert a P.D. covariance (diagonal) and rank-one (1*priorCovariance) matrix</pre>
<pre class="cython line score-49" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>:     cdef cnp.ndarray[cnp.float32_t, ndim=2] inverse = np.empty((m, m), dtype=np.float32)</pre>
<pre class='cython code score-49 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3) != (0)) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5) != (0)) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>;
  __pyx_t_3 = 0;
  __pyx_t_5 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_float32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_3, __pyx_t_5, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_inverse = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 295, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_inverse.diminfo[0].strides = __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_inverse.diminfo[0].shape = __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_inverse.diminfo[1].strides = __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_inverse.diminfo[1].shape = __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.shape[1];
    }
  }
  __pyx_v_inverse = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">296</span>:     # note, not actually an m-dim matrix, just the diagonal elements taken as input</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">297</span>:     cdef cnp.ndarray[cnp.float32_t, ndim=1] muncMatrixInverse = np.empty(m, dtype=np.float32)</pre>
<pre class='cython code score-38 '>  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_float32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_t_5};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_2, __pyx_t_6, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_muncMatrixInverse = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 297, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_muncMatrixInverse.diminfo[0].strides = __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_muncMatrixInverse.diminfo[0].shape = __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_muncMatrixInverse = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>:     cdef float sqrtPrior = np.sqrt(priorCovarianceOO)</pre>
<pre class='cython code score-33 '>  __pyx_t_3 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_priorCovarianceOO);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    assert(__pyx_t_3);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(__pyx_t_1); if (unlikely((__pyx_t_8 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_sqrtPrior = __pyx_t_8;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>:     cdef cnp.ndarray[cnp.float32_t, ndim=1] uVec = np.empty(m, dtype=np.float32)</pre>
<pre class='cython code score-38 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_m);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_float32);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_6};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_4, __pyx_t_5, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_uVec = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 299, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_uVec.diminfo[0].strides = __pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_uVec.diminfo[0].shape = __pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_uVec = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">300</span>:     cdef float divisor = 1.0</pre>
<pre class='cython code score-0 '>  __pyx_v_divisor = 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">301</span>:     cdef float scale</pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>:     cdef float uVecI</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>:     cdef Py_ssize_t i, j</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>:     for i in range(m):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_m;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0">&#xA0;<span class="">305</span>:         # two birds: build up the trace while taking the reciprocals</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">306</span>:         muncMatrixInverse[i] = 1.0/(muncMatrixIter[i])</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_muncMatrixInverse.diminfo[0].strides) = (1.0 / ((double)(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_muncMatrixIter.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_muncMatrixIter.diminfo[0].strides))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">307</span>:         divisor += priorCovarianceOO*muncMatrixInverse[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_v_divisor = (__pyx_v_divisor + (__pyx_v_priorCovarianceOO * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_muncMatrixInverse.diminfo[0].strides))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">308</span>:     # we can combine these two loops, keeping construction</pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>:     # of muncMatrixInverse and uVec separate for now in case</pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>:     # we want to parallelize this later</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">311</span>:     for i in range(m):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_m;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>:         uVec[i] = sqrtPrior*muncMatrixInverse[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_uVec.diminfo[0].strides) = (__pyx_v_sqrtPrior * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_muncMatrixInverse.diminfo[0].strides)));
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>:     scale = 1.0 / divisor</pre>
<pre class='cython code score-0 '>  __pyx_v_scale = (1.0 / ((double)__pyx_v_divisor));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:     for i in range(m):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_m;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:         uVecI = uVec[i]</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_v_uVecI = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_uVec.diminfo[0].strides));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>:         inverse[i, i] = muncMatrixInverse[i]-(scale*uVecI*uVecI)</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = __pyx_v_i;
    __pyx_t_14 = __pyx_v_i;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_inverse.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_inverse.diminfo[1].strides) = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_muncMatrixInverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_muncMatrixInverse.diminfo[0].strides)) - ((__pyx_v_scale * __pyx_v_uVecI) * __pyx_v_uVecI));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:         for j in range(i + 1, m):</pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __pyx_v_m;
    __pyx_t_16 = __pyx_t_15;
    for (__pyx_t_17 = (__pyx_v_i + 1); __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
      __pyx_v_j = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:             inverse[i, j] = -scale * (uVecI*uVec[j])</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_j;
      __pyx_t_14 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_inverse.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_inverse.diminfo[1].strides) = ((-__pyx_v_scale) * (__pyx_v_uVecI * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_uVec.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_uVec.diminfo[0].strides))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:             inverse[j, i] = inverse[i, j]</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = __pyx_v_i;
      __pyx_t_13 = __pyx_v_j;
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_18 = __pyx_v_i;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_inverse.diminfo[0].strides, __pyx_t_18, __pyx_pybuffernd_inverse.diminfo[1].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_inverse.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_inverse.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_inverse.diminfo[1].strides));
    }
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:     return inverse</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_inverse);
  __pyx_r = ((PyArrayObject *)__pyx_v_inverse);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">321</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">322</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>: cpdef cnp.ndarray[cnp.float32_t, ndim=1] cgetStateCovarTrace(</pre>
<pre class='cython code score-51 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_13cgetStateCovarTrace(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyArrayObject *__pyx_f_10consenrich_11cconsenrich_cgetStateCovarTrace(__Pyx_memviewslice __pyx_v_stateCovarMatrices, CYTHON_UNUSED int __pyx_skip_dispatch) {
  Py_ssize_t __pyx_v_n;
  PyArrayObject *__pyx_v_trace = 0;
  __Pyx_memviewslice __pyx_v_traceView = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_trace;
  __Pyx_Buffer __pyx_pybuffer_trace;
  PyArrayObject *__pyx_r = NULL;
  __pyx_pybuffer_trace.pybuffer.buf = NULL;
  __pyx_pybuffer_trace.refcount = 0;
  __pyx_pybuffernd_trace.data = NULL;
  __pyx_pybuffernd_trace.rcbuffer = &amp;__pyx_pybuffer_trace;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_trace.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetStateCovarTrace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_trace.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_trace);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_traceView, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_13cgetStateCovarTrace(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_13cgetStateCovarTrace = {"cgetStateCovarTrace", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_13cgetStateCovarTrace, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_13cgetStateCovarTrace(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_stateCovarMatrices = { 0, 0, { 0 }, { 0 }, { 0 } };
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cgetStateCovarTrace (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_stateCovarMatrices,0};
  PyObject* values[1] = {0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cgetStateCovarTrace", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 1; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetStateCovarTrace", 1, 1, 1, i); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 1)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
    }
    __pyx_v_stateCovarMatrices = __Pyx_PyObject_to_MemoryviewSlice_d_d_dc_nn___pyx_t_5numpy_float32_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_stateCovarMatrices.memview)) __PYX_ERR(0, 324, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetStateCovarTrace", 1, 1, 1, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_stateCovarMatrices, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetStateCovarTrace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_12cgetStateCovarTrace(__pyx_self, __pyx_v_stateCovarMatrices);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_stateCovarMatrices, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_12cgetStateCovarTrace(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_stateCovarMatrices) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_10consenrich_11cconsenrich_cgetStateCovarTrace(__pyx_v_stateCovarMatrices, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetStateCovarTrace", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_13cgetStateCovarTrace, 0, __pyx_mstate_global-&gt;__pyx_n_u_cgetStateCovarTrace, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[6]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cgetStateCovarTrace, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 323, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">324</span>:     cnp.float32_t[:, :, ::1] stateCovarMatrices</pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>: ):</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:     cdef Py_ssize_t n = stateCovarMatrices.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n = (__pyx_v_stateCovarMatrices.shape[0]);
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">327</span>:     cdef cnp.ndarray[cnp.float32_t, ndim=1] trace = np.empty(n, dtype=np.float32)</pre>
<pre class='cython code score-41 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_5, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_trace.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_trace = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_trace.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 327, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_trace.diminfo[0].strides = __pyx_pybuffernd_trace.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_trace.diminfo[0].shape = __pyx_pybuffernd_trace.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_trace = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:     cdef cnp.float32_t[::1] traceView = trace</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_float32_t(((PyObject *)__pyx_v_trace), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 328, __pyx_L1_error)</span>
  __pyx_v_traceView = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">329</span>:     cdef Py_ssize_t i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>:     for i in range(n):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>:         traceView[i] = stateCovarMatrices[i, 0, 0] + stateCovarMatrices[i, 1, 1]</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_i;
    __pyx_t_13 = 0;
    __pyx_t_14 = 0;
    __pyx_t_15 = __pyx_v_i;
    __pyx_t_16 = 1;
    __pyx_t_17 = 1;
    __pyx_t_18 = __pyx_v_i;
    *((__pyx_t_5numpy_float32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_float32_t *) __pyx_v_traceView.data) + __pyx_t_18)) )) = ((*((__pyx_t_5numpy_float32_t *) ( /* dim=2 */ ((char *) (((__pyx_t_5numpy_float32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_stateCovarMatrices.data + __pyx_t_12 * __pyx_v_stateCovarMatrices.strides[0]) ) + __pyx_t_13 * __pyx_v_stateCovarMatrices.strides[1]) )) + __pyx_t_14)) ))) + (*((__pyx_t_5numpy_float32_t *) ( /* dim=2 */ ((char *) (((__pyx_t_5numpy_float32_t *) ( /* dim=1 */ (( /* dim=0 */ (__pyx_v_stateCovarMatrices.data + __pyx_t_15 * __pyx_v_stateCovarMatrices.strides[0]) ) + __pyx_t_16 * __pyx_v_stateCovarMatrices.strides[1]) )) + __pyx_t_17)) ))));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">332</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:     return trace</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_trace);
  __pyx_r = ((PyArrayObject *)__pyx_v_trace);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">334</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>: cpdef cnp.ndarray[cnp.float32_t, ndim=1] cgetPrecisionWeightedResidual(</pre>
<pre class='cython code score-55 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_15cgetPrecisionWeightedResidual(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyArrayObject *__pyx_f_10consenrich_11cconsenrich_cgetPrecisionWeightedResidual(__Pyx_memviewslice __pyx_v_postFitResiduals, __Pyx_memviewslice __pyx_v_matrixMunc, CYTHON_UNUSED int __pyx_skip_dispatch) {
  Py_ssize_t __pyx_v_n;
  Py_ssize_t __pyx_v_m;
  PyArrayObject *__pyx_v_out = 0;
  __Pyx_memviewslice __pyx_v_outv = { 0, 0, { 0 }, { 0 }, { 0 } };
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  float __pyx_v_wsum;
  float __pyx_v_rwsum;
  float __pyx_v_w;
  float __pyx_v_eps;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_out;
  __Pyx_Buffer __pyx_pybuffer_out;
  PyArrayObject *__pyx_r = NULL;
  __pyx_pybuffer_out.pybuffer.buf = NULL;
  __pyx_pybuffer_out.refcount = 0;
  __pyx_pybuffernd_out.data = NULL;
  __pyx_pybuffernd_out.rcbuffer = &amp;__pyx_pybuffer_out;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_8, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetPrecisionWeightedResidual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_out);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_outv, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_15cgetPrecisionWeightedResidual(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_15cgetPrecisionWeightedResidual = {"cgetPrecisionWeightedResidual", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_15cgetPrecisionWeightedResidual, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_15cgetPrecisionWeightedResidual(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_postFitResiduals = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_matrixMunc = { 0, 0, { 0 }, { 0 }, { 0 } };
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cgetPrecisionWeightedResidual (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_postFitResiduals,&amp;__pyx_mstate_global-&gt;__pyx_n_u_matrixMunc,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cgetPrecisionWeightedResidual", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetPrecisionWeightedResidual", 1, 2, 2, i); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
    }
    __pyx_v_postFitResiduals = __Pyx_PyObject_to_MemoryviewSlice_d_dc_nn___pyx_t_5numpy_float32_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_postFitResiduals.memview)) __PYX_ERR(0, 337, __pyx_L3_error)</span>
    __pyx_v_matrixMunc = __Pyx_PyObject_to_MemoryviewSlice_d_dc_nn___pyx_t_5numpy_float32_t(values[1], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_matrixMunc.memview)) __PYX_ERR(0, 338, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetPrecisionWeightedResidual", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_postFitResiduals, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_matrixMunc, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetPrecisionWeightedResidual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_14cgetPrecisionWeightedResidual(__pyx_self, __pyx_v_postFitResiduals, __pyx_v_matrixMunc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_postFitResiduals, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_matrixMunc, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_14cgetPrecisionWeightedResidual(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_postFitResiduals, __Pyx_memviewslice __pyx_v_matrixMunc) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_10consenrich_11cconsenrich_cgetPrecisionWeightedResidual(__pyx_v_postFitResiduals, __pyx_v_matrixMunc, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetPrecisionWeightedResidual", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_15cgetPrecisionWeightedResidual, 0, __pyx_mstate_global-&gt;__pyx_n_u_cgetPrecisionWeightedResidual, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[7]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cgetPrecisionWeightedResidual, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 336, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>:     cnp.float32_t[:, ::1] postFitResiduals,</pre>
<pre class="cython line score-0">&#xA0;<span class="">338</span>:     cnp.float32_t[:, ::1] matrixMunc,</pre>
<pre class="cython line score-0">&#xA0;<span class="">339</span>: ):</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:     cdef Py_ssize_t n = postFitResiduals.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n = (__pyx_v_postFitResiduals.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:     cdef Py_ssize_t m = postFitResiduals.shape[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_m = (__pyx_v_postFitResiduals.shape[1]);
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>:     cdef cnp.ndarray[cnp.float32_t, ndim=1] out = np.empty(n, dtype=np.float32)</pre>
<pre class='cython code score-41 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_5, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_out = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_out.diminfo[0].strides = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_out.diminfo[0].shape = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_out = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>:     cdef cnp.float32_t[::1] outv = out</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_float32_t(((PyObject *)__pyx_v_out), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_8.memview)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
  __pyx_v_outv = __pyx_t_8;
  __pyx_t_8.memview = NULL;
  __pyx_t_8.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">344</span>:     cdef Py_ssize_t i, j</pre>
<pre class="cython line score-0">&#xA0;<span class="">345</span>:     cdef float wsum, rwsum, w</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:     cdef float eps = 1e-12  # guard for zeros</pre>
<pre class='cython code score-0 '>  __pyx_v_eps = 1e-12;
</pre><pre class="cython line score-0">&#xA0;<span class="">347</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>:     for i in range(n):</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = __pyx_v_n;
  __pyx_t_10 = __pyx_t_9;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_10; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:         wsum = 0.0</pre>
<pre class='cython code score-0 '>    __pyx_v_wsum = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:         rwsum = 0.0</pre>
<pre class='cython code score-0 '>    __pyx_v_rwsum = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">351</span>:         for j in range(m):</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = __pyx_v_m;
    __pyx_t_13 = __pyx_t_12;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_13; __pyx_t_14+=1) {
      __pyx_v_j = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:             w = 1.0 / (&lt;float&gt;matrixMunc[j, i] + eps)   # weightsIter[j]</pre>
<pre class='cython code score-0 '>      __pyx_t_15 = __pyx_v_j;
      __pyx_t_16 = __pyx_v_i;
      __pyx_v_w = (1.0 / ((double)(((float)(*((__pyx_t_5numpy_float32_t *) ( /* dim=1 */ ((char *) (((__pyx_t_5numpy_float32_t *) ( /* dim=0 */ (__pyx_v_matrixMunc.data + __pyx_t_15 * __pyx_v_matrixMunc.strides[0]) )) + __pyx_t_16)) )))) + __pyx_v_eps)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:             rwsum += (&lt;float&gt;postFitResiduals[i, j]) * w  # residualsIter[j] * w</pre>
<pre class='cython code score-0 '>      __pyx_t_16 = __pyx_v_i;
      __pyx_t_15 = __pyx_v_j;
      __pyx_v_rwsum = (__pyx_v_rwsum + (((float)(*((__pyx_t_5numpy_float32_t *) ( /* dim=1 */ ((char *) (((__pyx_t_5numpy_float32_t *) ( /* dim=0 */ (__pyx_v_postFitResiduals.data + __pyx_t_16 * __pyx_v_postFitResiduals.strides[0]) )) + __pyx_t_15)) )))) * __pyx_v_w));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:             wsum  += w</pre>
<pre class='cython code score-0 '>      __pyx_v_wsum = (__pyx_v_wsum + __pyx_v_w);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:         outv[i] = &lt;cnp.float32_t&gt;(rwsum / wsum) if wsum &gt; 0.0 else &lt;cnp.float32_t&gt;0.0</pre>
<pre class='cython code score-0 '>    __pyx_t_18 = (__pyx_v_wsum &gt; 0.0);
    if (__pyx_t_18) {
      __pyx_t_17 = ((__pyx_t_5numpy_float32_t)(__pyx_v_rwsum / __pyx_v_wsum));
    } else {
      __pyx_t_17 = ((__pyx_t_5numpy_float32_t)0.0);
    }
    __pyx_t_15 = __pyx_v_i;
    *((__pyx_t_5numpy_float32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_float32_t *) __pyx_v_outv.data) + __pyx_t_15)) )) = __pyx_t_17;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">356</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">357</span>:     return out</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_out);
  __pyx_r = ((PyArrayObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">358</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">359</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">360</span>: </pre>
<pre class="cython line score-162" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>: cpdef tuple updateProcessNoiseCovariance(cnp.ndarray[cnp.float32_t, ndim=2] matrixQ,</pre>
<pre class='cython code score-162 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_17updateProcessNoiseCovariance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyObject *__pyx_f_10consenrich_11cconsenrich_updateProcessNoiseCovariance(PyArrayObject *__pyx_v_matrixQ, PyArrayObject *__pyx_v_matrixQCopy, float __pyx_v_dStat, float __pyx_v_dStatAlpha, float __pyx_v_dStatd, float __pyx_v_dStatPC, int __pyx_v_inflatedQ, float __pyx_v_maxQ, float __pyx_v_minQ, CYTHON_UNUSED int __pyx_skip_dispatch) {
  float __pyx_v_scaleQ;
  float __pyx_v_fac;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_matrixQ;
  __Pyx_Buffer __pyx_pybuffer_matrixQ;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_matrixQCopy;
  __Pyx_Buffer __pyx_pybuffer_matrixQCopy;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_matrixQ.pybuffer.buf = NULL;
  __pyx_pybuffer_matrixQ.refcount = 0;
  __pyx_pybuffernd_matrixQ.data = NULL;
  __pyx_pybuffernd_matrixQ.rcbuffer = &amp;__pyx_pybuffer_matrixQ;
  __pyx_pybuffer_matrixQCopy.pybuffer.buf = NULL;
  __pyx_pybuffer_matrixQCopy.refcount = 0;
  __pyx_pybuffernd_matrixQCopy.data = NULL;
  __pyx_pybuffernd_matrixQCopy.rcbuffer = &amp;__pyx_pybuffer_matrixQCopy;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_matrixQ, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_matrixQ.diminfo[0].strides = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_matrixQ.diminfo[0].shape = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_matrixQ.diminfo[1].strides = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_matrixQ.diminfo[1].shape = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_matrixQCopy, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_matrixQCopy.diminfo[0].strides = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_matrixQCopy.diminfo[0].shape = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_matrixQCopy.diminfo[1].strides = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_matrixQCopy.diminfo[1].shape = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.shape[1];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.updateProcessNoiseCovariance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_17updateProcessNoiseCovariance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_16updateProcessNoiseCovariance, "Adjust process noise covariance matrix :math:`\\mathbf{Q}_{[i]}`\n\n    :param matrixQ: Current process noise covariance\n    :param matrixQCopy: A copy of the initial original covariance matrix :math:`\\mathbf{Q}_{[.]}`\n    :param inflatedQ: Flag indicating if the process noise covariance is inflated\n    :return: Updated process noise covariance matrix and inflated flag\n    :rtype: tuple\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_17updateProcessNoiseCovariance = {"updateProcessNoiseCovariance", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_17updateProcessNoiseCovariance, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_16updateProcessNoiseCovariance};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_17updateProcessNoiseCovariance(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_matrixQ = 0;
  PyArrayObject *__pyx_v_matrixQCopy = 0;
  float __pyx_v_dStat;
  float __pyx_v_dStatAlpha;
  float __pyx_v_dStatd;
  float __pyx_v_dStatPC;
  int __pyx_v_inflatedQ;
  float __pyx_v_maxQ;
  float __pyx_v_minQ;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("updateProcessNoiseCovariance (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_matrixQ,&amp;__pyx_mstate_global-&gt;__pyx_n_u_matrixQCopy,&amp;__pyx_mstate_global-&gt;__pyx_n_u_dStat,&amp;__pyx_mstate_global-&gt;__pyx_n_u_dStatAlpha,&amp;__pyx_mstate_global-&gt;__pyx_n_u_dStatd,&amp;__pyx_mstate_global-&gt;__pyx_n_u_dStatPC,&amp;__pyx_mstate_global-&gt;__pyx_n_u_inflatedQ,&amp;__pyx_mstate_global-&gt;__pyx_n_u_maxQ,&amp;__pyx_mstate_global-&gt;__pyx_n_u_minQ,0};
  PyObject* values[9] = {0,0,0,0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  9:
        values[8] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 8);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[8])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  8:
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "updateProcessNoiseCovariance", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 9; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("updateProcessNoiseCovariance", 1, 9, 9, i); <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 9)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
      values[8] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 8);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[8])) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
    }
    __pyx_v_matrixQ = ((PyArrayObject *)values[0]);
    __pyx_v_matrixQCopy = ((PyArrayObject *)values[1]);
    __pyx_v_dStat = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[2]); if (unlikely((__pyx_v_dStat == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 363, __pyx_L3_error)</span>
    __pyx_v_dStatAlpha = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[3]); if (unlikely((__pyx_v_dStatAlpha == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L3_error)</span>
    __pyx_v_dStatd = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[4]); if (unlikely((__pyx_v_dStatd == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 365, __pyx_L3_error)</span>
    __pyx_v_dStatPC = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[5]); if (unlikely((__pyx_v_dStatPC == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L3_error)</span>
    __pyx_v_inflatedQ = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(values[6]); if (unlikely((__pyx_v_inflatedQ == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 367, __pyx_L3_error)</span>
    __pyx_v_maxQ = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[7]); if (unlikely((__pyx_v_maxQ == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L3_error)</span>
    __pyx_v_minQ = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(values[8]); if (unlikely((__pyx_v_minQ == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 369, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("updateProcessNoiseCovariance", 1, 9, 9, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.updateProcessNoiseCovariance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_matrixQ), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "matrixQ", 0))) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_matrixQCopy), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "matrixQCopy", 0))) <span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_16updateProcessNoiseCovariance(__pyx_self, __pyx_v_matrixQ, __pyx_v_matrixQCopy, __pyx_v_dStat, __pyx_v_dStatAlpha, __pyx_v_dStatd, __pyx_v_dStatPC, __pyx_v_inflatedQ, __pyx_v_maxQ, __pyx_v_minQ);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_16updateProcessNoiseCovariance(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_matrixQ, PyArrayObject *__pyx_v_matrixQCopy, float __pyx_v_dStat, float __pyx_v_dStatAlpha, float __pyx_v_dStatd, float __pyx_v_dStatPC, int __pyx_v_inflatedQ, float __pyx_v_maxQ, float __pyx_v_minQ) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_matrixQ;
  __Pyx_Buffer __pyx_pybuffer_matrixQ;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_matrixQCopy;
  __Pyx_Buffer __pyx_pybuffer_matrixQCopy;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_matrixQ.pybuffer.buf = NULL;
  __pyx_pybuffer_matrixQ.refcount = 0;
  __pyx_pybuffernd_matrixQ.data = NULL;
  __pyx_pybuffernd_matrixQ.rcbuffer = &amp;__pyx_pybuffer_matrixQ;
  __pyx_pybuffer_matrixQCopy.pybuffer.buf = NULL;
  __pyx_pybuffer_matrixQCopy.refcount = 0;
  __pyx_pybuffernd_matrixQCopy.data = NULL;
  __pyx_pybuffernd_matrixQCopy.rcbuffer = &amp;__pyx_pybuffer_matrixQCopy;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_matrixQ, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_matrixQ.diminfo[0].strides = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_matrixQ.diminfo[0].shape = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_matrixQ.diminfo[1].strides = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_matrixQ.diminfo[1].shape = __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.shape[1];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_matrixQCopy, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_matrixQCopy.diminfo[0].strides = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_matrixQCopy.diminfo[0].shape = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.shape[0]; __pyx_pybuffernd_matrixQCopy.diminfo[1].strides = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.strides[1]; __pyx_pybuffernd_matrixQCopy.diminfo[1].shape = __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.shape[1];
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_updateProcessNoiseCovariance(__pyx_v_matrixQ, __pyx_v_matrixQCopy, __pyx_v_dStat, __pyx_v_dStatAlpha, __pyx_v_dStatd, __pyx_v_dStatPC, __pyx_v_inflatedQ, __pyx_v_maxQ, __pyx_v_minQ, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.updateProcessNoiseCovariance", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_17updateProcessNoiseCovariance, 0, __pyx_mstate_global-&gt;__pyx_n_u_updateProcessNoiseCovariance, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[8]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_updateProcessNoiseCovariance, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">362</span>:         cnp.ndarray[cnp.float32_t, ndim=2] matrixQCopy,</pre>
<pre class="cython line score-0">&#xA0;<span class="">363</span>:         float dStat,</pre>
<pre class="cython line score-0">&#xA0;<span class="">364</span>:         float dStatAlpha,</pre>
<pre class="cython line score-0">&#xA0;<span class="">365</span>:         float dStatd,</pre>
<pre class="cython line score-0">&#xA0;<span class="">366</span>:         float dStatPC,</pre>
<pre class="cython line score-0">&#xA0;<span class="">367</span>:         bint inflatedQ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">368</span>:         float maxQ,</pre>
<pre class="cython line score-0">&#xA0;<span class="">369</span>:         float minQ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">370</span>:     r"""Adjust process noise covariance matrix :math:`\mathbf{Q}_{[i]}`</pre>
<pre class="cython line score-0">&#xA0;<span class="">371</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">372</span>:     :param matrixQ: Current process noise covariance</pre>
<pre class="cython line score-0">&#xA0;<span class="">373</span>:     :param matrixQCopy: A copy of the initial original covariance matrix :math:`\mathbf{Q}_{[.]}`</pre>
<pre class="cython line score-0">&#xA0;<span class="">374</span>:     :param inflatedQ: Flag indicating if the process noise covariance is inflated</pre>
<pre class="cython line score-0">&#xA0;<span class="">375</span>:     :return: Updated process noise covariance matrix and inflated flag</pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>:     :rtype: tuple</pre>
<pre class="cython line score-0">&#xA0;<span class="">377</span>:     """</pre>
<pre class="cython line score-0">&#xA0;<span class="">378</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">379</span>:     cdef float scaleQ, fac</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:     if dStat &gt; dStatAlpha:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_dStat &gt; __pyx_v_dStatAlpha);
  if (__pyx_t_1) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:         scaleQ = np.sqrt(dStatd * np.abs(dStat-dStatAlpha) + dStatPC)</pre>
<pre class='cython code score-77 '>    __pyx_t_3 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dStatd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_mstate_global-&gt;__pyx_n_u_abs);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_dStat - __pyx_v_dStatAlpha));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      assert(__pyx_t_7);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, __pyx_t_8};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_9, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    __pyx_t_9 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dStatPC);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_9, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      assert(__pyx_t_3);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_4};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_5, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_11 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_scaleQ = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:         if matrixQ[0, 0] * scaleQ &lt;= maxQ:</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_1 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides)) * __pyx_v_scaleQ) &lt;= __pyx_v_maxQ);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L4;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:             matrixQ[0, 0] *= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_12 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[1].strides) *= __pyx_v_scaleQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>:             matrixQ[0, 1] *= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 0;
      __pyx_t_13 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides) *= __pyx_v_scaleQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">385</span>:             matrixQ[1, 0] *= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 1;
      __pyx_t_12 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[1].strides) *= __pyx_v_scaleQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:             matrixQ[1, 1] *= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 1;
      __pyx_t_13 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides) *= __pyx_v_scaleQ;
</pre><pre class="cython line score-0">&#xA0;<span class="">387</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>:             fac = maxQ / matrixQCopy[0, 0]</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_13 = 0;
      __pyx_t_12 = 0;
      __pyx_v_fac = (((__pyx_t_5numpy_float32_t)__pyx_v_maxQ) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQCopy.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQCopy.diminfo[1].strides)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>:             matrixQ[0, 0] = maxQ</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 0;
      __pyx_t_13 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = __pyx_v_maxQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:             matrixQ[0, 1] = matrixQCopy[0, 1] * fac</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_12 = 1;
      __pyx_t_14 = 0;
      __pyx_t_15 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQCopy.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQCopy.diminfo[1].strides)) * __pyx_v_fac);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:             matrixQ[1, 0] = matrixQCopy[1, 0] * fac</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 1;
      __pyx_t_13 = 0;
      __pyx_t_15 = 1;
      __pyx_t_14 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQCopy.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQCopy.diminfo[1].strides)) * __pyx_v_fac);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:             matrixQ[1, 1] = maxQ</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 1;
      __pyx_t_12 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = __pyx_v_maxQ;
    }
    __pyx_L4:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:         inflatedQ = True</pre>
<pre class='cython code score-0 '>    __pyx_v_inflatedQ = 1;
</pre><pre class="cython line score-0">&#xA0;<span class="">394</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:     elif dStat &lt; dStatAlpha and inflatedQ:</pre>
<pre class='cython code score-0 '>  __pyx_t_16 = (__pyx_v_dStat &lt; __pyx_v_dStatAlpha);
  if (__pyx_t_16) {
  } else {
    __pyx_t_1 = __pyx_t_16;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_1 = __pyx_v_inflatedQ;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_1) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-77" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">396</span>:         scaleQ = np.sqrt(dStatd * np.abs(dStat-dStatAlpha) + dStatPC)</pre>
<pre class='cython code score-77 '>    __pyx_t_5 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_sqrt);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dStatd);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_9 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_mstate_global-&gt;__pyx_n_u_abs);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyFloat_FromDouble</span>((__pyx_v_dStat - __pyx_v_dStatAlpha));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      assert(__pyx_t_9);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_9, __pyx_t_8};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    __pyx_t_7 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_4, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_dStatPC);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_10 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_5);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_10 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_5, __pyx_t_4};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_10, (2-__pyx_t_10) | (__pyx_t_10*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyFloat_AsFloat</span>(__pyx_t_2); if (unlikely((__pyx_t_11 == (float)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 396, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_v_scaleQ = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:         if matrixQ[0, 0] / scaleQ &gt;= minQ:</pre>
<pre class='cython code score-0 '>    __pyx_t_12 = 0;
    __pyx_t_13 = 0;
    __pyx_t_1 = (((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides)) / ((__pyx_t_5numpy_float32_t)__pyx_v_scaleQ)) &gt;= __pyx_v_minQ);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L7;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">398</span>:             matrixQ[0, 0] /= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_12 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[1].strides) /= __pyx_v_scaleQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:             matrixQ[0, 1] /= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 0;
      __pyx_t_13 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides) /= __pyx_v_scaleQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:             matrixQ[1, 0] /= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 1;
      __pyx_t_12 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[1].strides) /= __pyx_v_scaleQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:             matrixQ[1, 1] /= scaleQ</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 1;
      __pyx_t_13 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides) /= __pyx_v_scaleQ;
</pre><pre class="cython line score-0">&#xA0;<span class="">402</span>:         else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">403</span>:             # we've hit the minimum, no longer 'inflated'</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">404</span>:             fac = minQ / matrixQCopy[0, 0]</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_t_13 = 0;
      __pyx_t_12 = 0;
      __pyx_v_fac = (((__pyx_t_5numpy_float32_t)__pyx_v_minQ) / (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQCopy.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQCopy.diminfo[1].strides)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:             matrixQ[0, 0] = minQ</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 0;
      __pyx_t_13 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = __pyx_v_minQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:             matrixQ[0, 1] = matrixQCopy[0, 1] * fac</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 0;
      __pyx_t_12 = 1;
      __pyx_t_14 = 0;
      __pyx_t_15 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_14, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_15, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQCopy.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQCopy.diminfo[1].strides)) * __pyx_v_fac);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:             matrixQ[1, 0] = matrixQCopy[1, 0] * fac</pre>
<pre class='cython code score-0 '>      __pyx_t_12 = 1;
      __pyx_t_13 = 0;
      __pyx_t_15 = 1;
      __pyx_t_14 = 0;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_15, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQCopy.rcbuffer-&gt;pybuffer.buf, __pyx_t_12, __pyx_pybuffernd_matrixQCopy.diminfo[0].strides, __pyx_t_13, __pyx_pybuffernd_matrixQCopy.diminfo[1].strides)) * __pyx_v_fac);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">408</span>:             matrixQ[1, 1] = minQ</pre>
<pre class='cython code score-0 '>      __pyx_t_13 = 1;
      __pyx_t_12 = 1;
      *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_matrixQ.rcbuffer-&gt;pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_matrixQ.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_matrixQ.diminfo[1].strides) = __pyx_v_minQ;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">409</span>:             inflatedQ = False</pre>
<pre class='cython code score-0 '>      __pyx_v_inflatedQ = 0;
    }
    __pyx_L7:;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:     return matrixQ, inflatedQ</pre>
<pre class='cython code score-13 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_inflatedQ);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 410, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 410, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_matrixQ);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_v_matrixQ);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_v_matrixQ)) != (0)) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L1_error)</span>;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  if (<span class='pyx_c_api'>__Pyx_PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2) != (0)) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L1_error)</span>;
  __pyx_t_2 = 0;
  __pyx_r = ((PyObject*)__pyx_t_3);
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">411</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">412</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>: cdef void _blockMax(double[::1] valuesView,</pre>
<pre class='cython code score-0 '>static void __pyx_f_10consenrich_11cconsenrich__blockMax(__Pyx_memviewslice __pyx_v_valuesView, __Pyx_memviewslice __pyx_v_blockStartIndices, __Pyx_memviewslice __pyx_v_blockSizes, __Pyx_memviewslice __pyx_v_outputView) {
  Py_ssize_t __pyx_v_iterIndex;
  Py_ssize_t __pyx_v_elementIndex;
  Py_ssize_t __pyx_v_startIndex;
  Py_ssize_t __pyx_v_blockLength;
  double __pyx_v_currentMax;
  double __pyx_v_currentValue;
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">414</span>:                     Py_ssize_t[::1] blockStartIndices,</pre>
<pre class="cython line score-0">&#xA0;<span class="">415</span>:                     Py_ssize_t[::1] blockSizes,</pre>
<pre class="cython line score-0">&#xA0;<span class="">416</span>:                     double[::1] outputView) noexcept:</pre>
<pre class="cython line score-0">&#xA0;<span class="">417</span>:     cdef Py_ssize_t iterIndex, elementIndex, startIndex, blockLength</pre>
<pre class="cython line score-0">&#xA0;<span class="">418</span>:     cdef double currentMax, currentValue</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">419</span>:     for iterIndex in range(outputView.shape[0]):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = (__pyx_v_outputView.shape[0]);
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_iterIndex = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">420</span>:         startIndex = blockStartIndices[iterIndex]</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_iterIndex;
    __pyx_v_startIndex = (*((Py_ssize_t *) ( /* dim=0 */ ((char *) (((Py_ssize_t *) __pyx_v_blockStartIndices.data) + __pyx_t_4)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>:         blockLength = blockSizes[iterIndex] # note, length of blocks affects upcoming loop</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_iterIndex;
    __pyx_v_blockLength = (*((Py_ssize_t *) ( /* dim=0 */ ((char *) (((Py_ssize_t *) __pyx_v_blockSizes.data) + __pyx_t_4)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>:         currentMax = valuesView[startIndex]</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_startIndex;
    __pyx_v_currentMax = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_valuesView.data) + __pyx_t_4)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">423</span>:         for elementIndex in range(1, blockLength):</pre>
<pre class='cython code score-0 '>    __pyx_t_5 = __pyx_v_blockLength;
    __pyx_t_6 = __pyx_t_5;
    for (__pyx_t_7 = 1; __pyx_t_7 &lt; __pyx_t_6; __pyx_t_7+=1) {
      __pyx_v_elementIndex = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:             currentValue = valuesView[startIndex + elementIndex]</pre>
<pre class='cython code score-0 '>      __pyx_t_4 = (__pyx_v_startIndex + __pyx_v_elementIndex);
      __pyx_v_currentValue = (*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_valuesView.data) + __pyx_t_4)) )));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">425</span>:             if currentValue &gt; currentMax:</pre>
<pre class='cython code score-0 '>      __pyx_t_8 = (__pyx_v_currentValue &gt; __pyx_v_currentMax);
      if (__pyx_t_8) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">426</span>:                 currentMax = currentValue</pre>
<pre class='cython code score-0 '>        __pyx_v_currentMax = __pyx_v_currentValue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>:         outputView[iterIndex] = currentMax</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_iterIndex;
    *((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_outputView.data) + __pyx_t_4)) )) = __pyx_v_currentMax;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">428</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">429</span>: </pre>
<pre class="cython line score-162" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>: cpdef double[::1] csampleBlockStats(cnp.ndarray[cnp.uint32_t, ndim=1] intervals,</pre>
<pre class='cython code score-162 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_19csampleBlockStats(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static __Pyx_memviewslice __pyx_f_10consenrich_11cconsenrich_csampleBlockStats(PyArrayObject *__pyx_v_intervals, PyArrayObject *__pyx_v_values, int __pyx_v_expectedBlockSize, int __pyx_v_iters, int __pyx_v_randSeed, PyArrayObject *__pyx_v_excludeIdxMask, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyArrayObject *__pyx_v_valuesArr = 0;
  __Pyx_memviewslice __pyx_v_valuesView = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_sizesArr = 0;
  PyArrayObject *__pyx_v_out = 0;
  Py_ssize_t __pyx_v_maxBlockLength;
  Py_ssize_t __pyx_v_maxSize;
  Py_ssize_t __pyx_v_minSize;
  Py_ssize_t __pyx_v_n;
  double __pyx_v_maxBlockScale;
  double __pyx_v_minBlockScale;
  PyObject *__pyx_v_support = 0;
  __pyx_t_5numpy_intp_t __pyx_v_i_;
  PyArrayObject *__pyx_v_samples = 0;
  __Pyx_memviewslice __pyx_v_startsView = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_sizesView = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_outView = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_excludeIdxMask;
  __Pyx_Buffer __pyx_pybuffer_excludeIdxMask;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_intervals;
  __Pyx_Buffer __pyx_pybuffer_intervals;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_out;
  __Pyx_Buffer __pyx_pybuffer_out;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_samples;
  __Pyx_Buffer __pyx_pybuffer_samples;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sizesArr;
  __Pyx_Buffer __pyx_pybuffer_sizesArr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_values;
  __Pyx_Buffer __pyx_pybuffer_values;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_valuesArr;
  __Pyx_Buffer __pyx_pybuffer_valuesArr;
  __Pyx_memviewslice __pyx_r = { 0, 0, { 0 }, { 0 }, { 0 } };
  __pyx_pybuffer_valuesArr.pybuffer.buf = NULL;
  __pyx_pybuffer_valuesArr.refcount = 0;
  __pyx_pybuffernd_valuesArr.data = NULL;
  __pyx_pybuffernd_valuesArr.rcbuffer = &amp;__pyx_pybuffer_valuesArr;
  __pyx_pybuffer_sizesArr.pybuffer.buf = NULL;
  __pyx_pybuffer_sizesArr.refcount = 0;
  __pyx_pybuffernd_sizesArr.data = NULL;
  __pyx_pybuffernd_sizesArr.rcbuffer = &amp;__pyx_pybuffer_sizesArr;
  __pyx_pybuffer_out.pybuffer.buf = NULL;
  __pyx_pybuffer_out.refcount = 0;
  __pyx_pybuffernd_out.data = NULL;
  __pyx_pybuffernd_out.rcbuffer = &amp;__pyx_pybuffer_out;
  __pyx_pybuffer_samples.pybuffer.buf = NULL;
  __pyx_pybuffer_samples.refcount = 0;
  __pyx_pybuffernd_samples.data = NULL;
  __pyx_pybuffernd_samples.rcbuffer = &amp;__pyx_pybuffer_samples;
  __pyx_pybuffer_intervals.pybuffer.buf = NULL;
  __pyx_pybuffer_intervals.refcount = 0;
  __pyx_pybuffernd_intervals.data = NULL;
  __pyx_pybuffernd_intervals.rcbuffer = &amp;__pyx_pybuffer_intervals;
  __pyx_pybuffer_values.pybuffer.buf = NULL;
  __pyx_pybuffer_values.refcount = 0;
  __pyx_pybuffernd_values.data = NULL;
  __pyx_pybuffernd_values.rcbuffer = &amp;__pyx_pybuffer_values;
  __pyx_pybuffer_excludeIdxMask.pybuffer.buf = NULL;
  __pyx_pybuffer_excludeIdxMask.refcount = 0;
  __pyx_pybuffernd_excludeIdxMask.data = NULL;
  __pyx_pybuffernd_excludeIdxMask.rcbuffer = &amp;__pyx_pybuffer_excludeIdxMask;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_intervals, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_intervals.diminfo[0].strides = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_intervals.diminfo[0].shape = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_values.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_values, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_values.diminfo[0].strides = __pyx_pybuffernd_values.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_values.diminfo[0].shape = __pyx_pybuffernd_values.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_excludeIdxMask, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_excludeIdxMask.diminfo[0].strides = __pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_excludeIdxMask.diminfo[0].shape = __pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_21, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_samples.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_values.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_valuesArr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  __pyx_r.data = NULL;
  __pyx_r.memview = NULL;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.csampleBlockStats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_samples.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_values.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_valuesArr.rcbuffer-&gt;pybuffer);
  if (unlikely(!__pyx_r.memview)) {
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "Memoryview return value is not initialized");
  }
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_valuesArr);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_valuesView, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sizesArr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_support);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_samples);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_startsView, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_sizesView, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_outView, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_19csampleBlockStats(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_18csampleBlockStats, "Sample contiguous blocks in the response sequence (xCorr), record maxima, and repeat.\n\n    Used to build an empirical null distribution and determine significance of response outputs.\n    The size of blocks is drawn from a truncated geometric distribution, preserving rough equality\n    in expectation but allowing for variability to account for the sampling across different phases\n    in the response sequence.\n\n    :param values: The response sequence to sample from.\n    :type values: cnp.ndarray[cnp.float64_t, ndim=1]\n    :param expectedBlockSize: The expected size (geometric) of the blocks to sample.\n    :type expectedBlockSize: int\n    :param iters: The number of blocks to sample.\n    :type iters: int\n    :param randSeed: Random seed for reproducibility.\n    :type randSeed: int\n    :return: An array of sampled block maxima.\n    :rtype: cnp.ndarray[cnp.float64_t, ndim=1]\n    :seealso: :func:`consenrich.matching.matchWavelet`\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_19csampleBlockStats = {"csampleBlockStats", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_19csampleBlockStats, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_18csampleBlockStats};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_19csampleBlockStats(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyArrayObject *__pyx_v_intervals = 0;
  PyArrayObject *__pyx_v_values = 0;
  int __pyx_v_expectedBlockSize;
  int __pyx_v_iters;
  int __pyx_v_randSeed;
  PyArrayObject *__pyx_v_excludeIdxMask = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("csampleBlockStats (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_intervals,&amp;__pyx_mstate_global-&gt;__pyx_n_u_values,&amp;__pyx_mstate_global-&gt;__pyx_n_u_expectedBlockSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_iters,&amp;__pyx_mstate_global-&gt;__pyx_n_u_randSeed,&amp;__pyx_mstate_global-&gt;__pyx_n_u_excludeIdxMask,0};
  PyObject* values[6] = {0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "csampleBlockStats", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 6; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("csampleBlockStats", 1, 6, 6, i); <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 6)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
      values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
      values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
    }
    __pyx_v_intervals = ((PyArrayObject *)values[0]);
    __pyx_v_values = ((PyArrayObject *)values[1]);
    __pyx_v_expectedBlockSize = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[2]); if (unlikely((__pyx_v_expectedBlockSize == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 432, __pyx_L3_error)</span>
    __pyx_v_iters = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[3]); if (unlikely((__pyx_v_iters == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 433, __pyx_L3_error)</span>
    __pyx_v_randSeed = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[4]); if (unlikely((__pyx_v_randSeed == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 434, __pyx_L3_error)</span>
    __pyx_v_excludeIdxMask = ((PyArrayObject *)values[5]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("csampleBlockStats", 1, 6, 6, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.csampleBlockStats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_intervals), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "intervals", 0))) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_values), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "values", 0))) <span class='error_goto'>__PYX_ERR(0, 431, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_excludeIdxMask), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "excludeIdxMask", 0))) <span class='error_goto'>__PYX_ERR(0, 435, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_18csampleBlockStats(__pyx_self, __pyx_v_intervals, __pyx_v_values, __pyx_v_expectedBlockSize, __pyx_v_iters, __pyx_v_randSeed, __pyx_v_excludeIdxMask);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_18csampleBlockStats(CYTHON_UNUSED PyObject *__pyx_self, PyArrayObject *__pyx_v_intervals, PyArrayObject *__pyx_v_values, int __pyx_v_expectedBlockSize, int __pyx_v_iters, int __pyx_v_randSeed, PyArrayObject *__pyx_v_excludeIdxMask) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_excludeIdxMask;
  __Pyx_Buffer __pyx_pybuffer_excludeIdxMask;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_intervals;
  __Pyx_Buffer __pyx_pybuffer_intervals;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_values;
  __Pyx_Buffer __pyx_pybuffer_values;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_intervals.pybuffer.buf = NULL;
  __pyx_pybuffer_intervals.refcount = 0;
  __pyx_pybuffernd_intervals.data = NULL;
  __pyx_pybuffernd_intervals.rcbuffer = &amp;__pyx_pybuffer_intervals;
  __pyx_pybuffer_values.pybuffer.buf = NULL;
  __pyx_pybuffer_values.refcount = 0;
  __pyx_pybuffernd_values.data = NULL;
  __pyx_pybuffernd_values.rcbuffer = &amp;__pyx_pybuffer_values;
  __pyx_pybuffer_excludeIdxMask.pybuffer.buf = NULL;
  __pyx_pybuffer_excludeIdxMask.refcount = 0;
  __pyx_pybuffernd_excludeIdxMask.data = NULL;
  __pyx_pybuffernd_excludeIdxMask.rcbuffer = &amp;__pyx_pybuffer_excludeIdxMask;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_intervals, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_intervals.diminfo[0].strides = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_intervals.diminfo[0].shape = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_values.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_values, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_values.diminfo[0].strides = __pyx_pybuffernd_values.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_values.diminfo[0].shape = __pyx_pybuffernd_values.rcbuffer-&gt;pybuffer.shape[0];
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_excludeIdxMask, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_excludeIdxMask.diminfo[0].strides = __pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_excludeIdxMask.diminfo[0].shape = __pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer.shape[0];
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_csampleBlockStats(__pyx_v_intervals, __pyx_v_values, __pyx_v_expectedBlockSize, __pyx_v_iters, __pyx_v_randSeed, __pyx_v_excludeIdxMask, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1.memview)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_memoryview_fromslice(__pyx_t_1, 1, (PyObject *(*)(char *)) __pyx_memview_get_double, (int (*)(char *, PyObject *)) __pyx_memview_set_double, 0);;<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  __pyx_t_1.memview = NULL; __pyx_t_1.data = NULL;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_1, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_values.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.csampleBlockStats", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_excludeIdxMask.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_values.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_19csampleBlockStats, 0, __pyx_mstate_global-&gt;__pyx_n_u_csampleBlockStats, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[9]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_csampleBlockStats, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 430, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">431</span>:                         cnp.ndarray[cnp.float64_t, ndim=1] values,</pre>
<pre class="cython line score-0">&#xA0;<span class="">432</span>:                         int expectedBlockSize,</pre>
<pre class="cython line score-0">&#xA0;<span class="">433</span>:                         int iters,</pre>
<pre class="cython line score-0">&#xA0;<span class="">434</span>:                         int randSeed,</pre>
<pre class="cython line score-0">&#xA0;<span class="">435</span>:                         cnp.ndarray[cnp.uint8_t, ndim=1] excludeIdxMask):</pre>
<pre class="cython line score-0">&#xA0;<span class="">436</span>:     r"""Sample contiguous blocks in the response sequence (xCorr), record maxima, and repeat.</pre>
<pre class="cython line score-0">&#xA0;<span class="">437</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">438</span>:     Used to build an empirical null distribution and determine significance of response outputs.</pre>
<pre class="cython line score-0">&#xA0;<span class="">439</span>:     The size of blocks is drawn from a truncated geometric distribution, preserving rough equality</pre>
<pre class="cython line score-0">&#xA0;<span class="">440</span>:     in expectation but allowing for variability to account for the sampling across different phases</pre>
<pre class="cython line score-0">&#xA0;<span class="">441</span>:     in the response sequence.</pre>
<pre class="cython line score-0">&#xA0;<span class="">442</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">443</span>:     :param values: The response sequence to sample from.</pre>
<pre class="cython line score-0">&#xA0;<span class="">444</span>:     :type values: cnp.ndarray[cnp.float64_t, ndim=1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">445</span>:     :param expectedBlockSize: The expected size (geometric) of the blocks to sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">446</span>:     :type expectedBlockSize: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">447</span>:     :param iters: The number of blocks to sample.</pre>
<pre class="cython line score-0">&#xA0;<span class="">448</span>:     :type iters: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">449</span>:     :param randSeed: Random seed for reproducibility.</pre>
<pre class="cython line score-0">&#xA0;<span class="">450</span>:     :type randSeed: int</pre>
<pre class="cython line score-0">&#xA0;<span class="">451</span>:     :return: An array of sampled block maxima.</pre>
<pre class="cython line score-0">&#xA0;<span class="">452</span>:     :rtype: cnp.ndarray[cnp.float64_t, ndim=1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">453</span>:     :seealso: :func:`consenrich.matching.matchWavelet`</pre>
<pre class="cython line score-0">&#xA0;<span class="">454</span>:     """</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:     np.random.seed(randSeed)</pre>
<pre class='cython code score-14 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_t_4;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_randSeed);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 455, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_seed, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 455, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">456</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] valuesArr = np.ascontiguousarray(values, dtype=np.float64)</pre>
<pre class='cython code score-35 '>  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_ascontiguousarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, ((PyObject *)__pyx_v_values)};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_3, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 456, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_2, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 456, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 456, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_valuesArr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_valuesArr = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_valuesArr.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 456, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_valuesArr.diminfo[0].strides = __pyx_pybuffernd_valuesArr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_valuesArr.diminfo[0].shape = __pyx_pybuffernd_valuesArr.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_valuesArr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:     cdef double[::1] valuesView = valuesArr</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_v_valuesArr), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 457, __pyx_L1_error)</span>
  __pyx_v_valuesView = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">458</span>:     cdef cnp.ndarray[cnp.intp_t, ndim=1] sizesArr</pre>
<pre class="cython line score-0">&#xA0;<span class="">459</span>:     cdef cnp.ndarray[cnp.intp_t, ndim=1] startsArr</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">460</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] out = np.empty(iters, dtype=np.float64)</pre>
<pre class='cython code score-38 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_iters);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_8, __pyx_t_4, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_6, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_out = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 460, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_out.diminfo[0].strides = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_out.diminfo[0].shape = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_out = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">461</span>:     cdef Py_ssize_t maxBlockLength, maxSize, minSize</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:     cdef Py_ssize_t n = &lt;Py_ssize_t&gt;intervals.size</pre>
<pre class='cython code score-0 '>  __pyx_v_n = ((Py_ssize_t)__pyx_f_5numpy_7ndarray_4size_size(((PyArrayObject *)__pyx_v_intervals)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">463</span>:     cdef double maxBlockScale = &lt;double&gt;3.0</pre>
<pre class='cython code score-0 '>  __pyx_v_maxBlockScale = ((double)3.0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">464</span>:     cdef double minBlockScale = &lt;double&gt; (1.0 / 3.0)</pre>
<pre class='cython code score-0 '>  __pyx_v_minBlockScale = ((double)(1.0 / 3.0));
</pre><pre class="cython line score-0">&#xA0;<span class="">465</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">466</span>:     minSize = &lt;Py_ssize_t&gt; max(3, expectedBlockSize * minBlockScale)</pre>
<pre class='cython code score-0 '>  __pyx_t_9 = (__pyx_v_expectedBlockSize * __pyx_v_minBlockScale);
  __pyx_t_10 = 3;
  __pyx_t_12 = (__pyx_t_9 &gt; __pyx_t_10);
  if (__pyx_t_12) {
    __pyx_t_11 = __pyx_t_9;
  } else {
    __pyx_t_11 = __pyx_t_10;
  }
  __pyx_v_minSize = ((Py_ssize_t)__pyx_t_11);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:     maxSize = &lt;Py_ssize_t&gt; min(maxBlockScale * expectedBlockSize, n)</pre>
<pre class='cython code score-0 '>  __pyx_t_13 = __pyx_v_n;
  __pyx_t_11 = (__pyx_v_maxBlockScale * __pyx_v_expectedBlockSize);
  __pyx_t_12 = (__pyx_t_13 &lt; __pyx_t_11);
  if (__pyx_t_12) {
    __pyx_t_9 = __pyx_t_13;
  } else {
    __pyx_t_9 = __pyx_t_11;
  }
  __pyx_v_maxSize = ((Py_ssize_t)__pyx_t_9);
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:     sizesArr = np.random.geometric(1.0 / expectedBlockSize, size=iters).astype(np.intp, copy=False)</pre>
<pre class='cython code score-60 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_random);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_8 = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
  __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>((1.0 / ((double)__pyx_v_expectedBlockSize)));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_iters);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_8, __pyx_t_3};
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_size, __pyx_t_14, __pyx_t_15, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_geometric, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  }
  __pyx_t_6 = __pyx_t_4;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_intp);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_6, __pyx_t_15};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_copy, Py_False, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_astype, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer);
    __pyx_t_16 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_16 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_17, &amp;__pyx_t_18, &amp;__pyx_t_19);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sizesArr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_19);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_17, __pyx_t_18, __pyx_t_19);
      }
      __pyx_t_17 = __pyx_t_18 = __pyx_t_19 = 0;
    }
    __pyx_pybuffernd_sizesArr.diminfo[0].strides = __pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sizesArr.diminfo[0].shape = __pyx_pybuffernd_sizesArr.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely((__pyx_t_16 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 468, __pyx_L1_error)</span>
  }
  __pyx_v_sizesArr = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-37" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">469</span>:     np.clip(sizesArr, minSize, maxSize, out=sizesArr)</pre>
<pre class='cython code score-37 '>  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_clip);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_minSize);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_6 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_maxSize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_15))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_15);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_15);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_15, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[4 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, ((PyObject *)__pyx_v_sizesArr), __pyx_t_2, __pyx_t_6};
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_out, ((PyObject *)__pyx_v_sizesArr), __pyx_t_14, __pyx_callargs+4, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_15, __pyx_callargs+__pyx_t_5, (4-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_14);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 469, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:     maxBlockLength = sizesArr.max()</pre>
<pre class='cython code score-12 '>  __pyx_t_15 = ((PyObject *)__pyx_v_sizesArr);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_15, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_max, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_t_1); if (unlikely((__pyx_t_13 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 470, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_maxBlockLength = __pyx_t_13;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:     cdef list support = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 471, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_support = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">472</span>:     cdef cnp.intp_t i_ = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_i_ = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:     while i_ &lt; n-maxBlockLength:</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_12 = (__pyx_v_i_ &lt; (__pyx_v_n - __pyx_v_maxBlockLength));
    if (!__pyx_t_12) break;
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:         if excludeIdxMask[i_:i_ + maxBlockLength].any():</pre>
<pre class='cython code score-25 '>    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_From_npy_intp</span>(__pyx_v_i_);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
    __pyx_t_6 = <span class='py_c_api'>PyLong_FromSsize_t</span>((__pyx_v_i_ + __pyx_v_maxBlockLength));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_14, __pyx_t_6, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_excludeIdxMask), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_15 = __pyx_t_6;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_15);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_15, NULL};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_any, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 474, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely((__pyx_t_12 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 474, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (__pyx_t_12) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">475</span>:             i_ = i_ + maxBlockLength + 1</pre>
<pre class='cython code score-0 '>      __pyx_v_i_ = ((__pyx_v_i_ + __pyx_v_maxBlockLength) + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:             continue</pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:         support.append(i_)</pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_npy_intp</span>(__pyx_v_i_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_20 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_support, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_20 == ((int)-1))) __PYX_ERR(0, 477, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">478</span>:         i_ = i_ + 1</pre>
<pre class='cython code score-0 '>    __pyx_v_i_ = (__pyx_v_i_ + 1);
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">479</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:     cdef cnp.ndarray[cnp.intp_t, ndim=1] samples = np.random.choice(</pre>
<pre class='cython code score-6 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_14, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_14, __pyx_mstate_global-&gt;__pyx_n_u_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
  __pyx_t_2 = __pyx_t_4;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">481</span>:         support,</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:         size=iters,</pre>
<pre class='cython code score-2 '>  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_iters);<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 482, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
</pre><pre class="cython line score-0">&#xA0;<span class="">483</span>:         replace=True,</pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">484</span>:         p=None</pre>
<pre class='cython code score-15 '>  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 3 : 0)] = {__pyx_t_2, __pyx_v_support};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 480, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_size, __pyx_t_14, __pyx_t_3, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_replace, Py_True, __pyx_t_3, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_p, Py_None, __pyx_t_3, __pyx_callargs+2, 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
    __pyx_t_15 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_choice, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_14); __pyx_t_14 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_15)) <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  }
  __pyx_t_6 = __pyx_t_15;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">485</span>:         ).astype(np.intp)</pre>
<pre class='cython code score-15 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_intp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 485, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_6, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_astype, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 485, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 485, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_samples.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_samples = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_samples.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 480, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_samples.diminfo[0].strides = __pyx_pybuffernd_samples.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_samples.diminfo[0].shape = __pyx_pybuffernd_samples.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_samples = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">486</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>:     cdef Py_ssize_t[::1] startsView = samples</pre>
<pre class='cython code score-2 '>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t</span>(((PyObject *)__pyx_v_samples), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  __pyx_v_startsView = __pyx_t_21;
  __pyx_t_21.memview = NULL;
  __pyx_t_21.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:     cdef Py_ssize_t[::1] sizesView = sizesArr</pre>
<pre class='cython code score-2 '>  __pyx_t_21 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_Py_ssize_t</span>(((PyObject *)__pyx_v_sizesArr), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_21.memview)) __PYX_ERR(0, 488, __pyx_L1_error)</span>
  __pyx_v_sizesView = __pyx_t_21;
  __pyx_t_21.memview = NULL;
  __pyx_t_21.data = NULL;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:     cdef double[::1] outView = out</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_v_out), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 489, __pyx_L1_error)</span>
  __pyx_v_outView = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:     _blockMax(valuesView, startsView, sizesView, outView)</pre>
<pre class='cython code score-0 '>  __pyx_f_10consenrich_11cconsenrich__blockMax(__pyx_v_valuesView, __pyx_v_startsView, __pyx_v_sizesView, __pyx_v_outView);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:     return out</pre>
<pre class='cython code score-2 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(((PyObject *)__pyx_v_out), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  __pyx_r = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">492</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">493</span>: </pre>
<pre class="cython line score-63" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>: cpdef cSparseAvg(cnp.float32_t[::1] trackALV, dict sparseMap):</pre>
<pre class='cython code score-63 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_21cSparseAvg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyObject *__pyx_f_10consenrich_11cconsenrich_cSparseAvg(__Pyx_memviewslice __pyx_v_trackALV, PyObject *__pyx_v_sparseMap, CYTHON_UNUSED int __pyx_skip_dispatch) {
  Py_ssize_t __pyx_v_n;
  PyArrayObject *__pyx_v_out = 0;
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_j;
  Py_ssize_t __pyx_v_m;
  float __pyx_v_sumNearestVariances;
  PyArrayObject *__pyx_v_idxs = 0;
  __Pyx_memviewslice __pyx_v_idx_view = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_LocalBuf_ND __pyx_pybuffernd_idxs;
  __Pyx_Buffer __pyx_pybuffer_idxs;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_out;
  __Pyx_Buffer __pyx_pybuffer_out;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_out.pybuffer.buf = NULL;
  __pyx_pybuffer_out.refcount = 0;
  __pyx_pybuffernd_out.data = NULL;
  __pyx_pybuffernd_out.rcbuffer = &amp;__pyx_pybuffer_out;
  __pyx_pybuffer_idxs.pybuffer.buf = NULL;
  __pyx_pybuffer_idxs.refcount = 0;
  __pyx_pybuffernd_idxs.data = NULL;
  __pyx_pybuffernd_idxs.rcbuffer = &amp;__pyx_pybuffer_idxs;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_15, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cSparseAvg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_out);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_idxs);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_idx_view, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_21cSparseAvg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_20cSparseAvg, "Fast access and average of `numNearest` sparse elements.\n\n    See :func:`consenrich.core.getMuncTrack`\n\n    :param trackALV: See :func:`consenrich.core.getAverageLocalVarianceTrack`\n    :type trackALV: float[::1]\n    :param sparseMap: See :func:`consenrich.core.getSparseMap`\n    :type sparseMap: dict[int, np.ndarray]\n    :return: array of mena('nearest local variances') same length as `trackALV`\n    :rtype: cnp.ndarray[cnp.float32_t, ndim=1]\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_21cSparseAvg = {"cSparseAvg", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_21cSparseAvg, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_20cSparseAvg};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_21cSparseAvg(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  __Pyx_memviewslice __pyx_v_trackALV = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_sparseMap = 0;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cSparseAvg (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_trackALV,&amp;__pyx_mstate_global-&gt;__pyx_n_u_sparseMap,0};
  PyObject* values[2] = {0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cSparseAvg", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 2; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cSparseAvg", 1, 2, 2, i); <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 2)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
    }
    __pyx_v_trackALV = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_float32_t(values[0], PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_v_trackALV.memview)) __PYX_ERR(0, 494, __pyx_L3_error)</span>
    __pyx_v_sparseMap = ((PyObject*)values[1]);
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cSparseAvg", 1, 2, 2, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_trackALV, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cSparseAvg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_sparseMap), (&amp;PyDict_Type), 1, "sparseMap", 1))) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_20cSparseAvg(__pyx_self, __pyx_v_trackALV, __pyx_v_sparseMap);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_trackALV, 1);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_20cSparseAvg(CYTHON_UNUSED PyObject *__pyx_self, __Pyx_memviewslice __pyx_v_trackALV, PyObject *__pyx_v_sparseMap) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_cSparseAvg(__pyx_v_trackALV, __pyx_v_sparseMap, 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cSparseAvg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_21cSparseAvg, 0, __pyx_mstate_global-&gt;__pyx_n_u_cSparseAvg, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[10]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 494, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cSparseAvg, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 494, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">495</span>:     r"""Fast access and average of `numNearest` sparse elements.</pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">497</span>:     See :func:`consenrich.core.getMuncTrack`</pre>
<pre class="cython line score-0">&#xA0;<span class="">498</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">499</span>:     :param trackALV: See :func:`consenrich.core.getAverageLocalVarianceTrack`</pre>
<pre class="cython line score-0">&#xA0;<span class="">500</span>:     :type trackALV: float[::1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">501</span>:     :param sparseMap: See :func:`consenrich.core.getSparseMap`</pre>
<pre class="cython line score-0">&#xA0;<span class="">502</span>:     :type sparseMap: dict[int, np.ndarray]</pre>
<pre class="cython line score-0">&#xA0;<span class="">503</span>:     :return: array of mena('nearest local variances') same length as `trackALV`</pre>
<pre class="cython line score-0">&#xA0;<span class="">504</span>:     :rtype: cnp.ndarray[cnp.float32_t, ndim=1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">505</span>:     """</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:     cdef Py_ssize_t n = &lt;Py_ssize_t&gt;trackALV.shape[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_n = ((Py_ssize_t)(__pyx_v_trackALV.shape[0]));
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:     cdef cnp.ndarray[cnp.float32_t, ndim=1] out = np.empty(n, dtype=np.float32)</pre>
<pre class='cython code score-41 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_mstate_global-&gt;__pyx_n_u_float32);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_7 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_7 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_6, __pyx_t_5, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_7, (2-__pyx_t_7) | (__pyx_t_7*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_out.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float32_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_out = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 507, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_out.diminfo[0].strides = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_out.diminfo[0].shape = __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_out = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">508</span>:     cdef Py_ssize_t i, j, m</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:     cdef float sumNearestVariances = 0.0</pre>
<pre class='cython code score-0 '>  __pyx_v_sumNearestVariances = 0.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">510</span>:     cdef cnp.ndarray[cnp.intp_t, ndim=1] idxs</pre>
<pre class="cython line score-0">&#xA0;<span class="">511</span>:     cdef cnp.intp_t[::1] idx_view</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:     for i in range(n):</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_n;
  __pyx_t_9 = __pyx_t_8;
  for (__pyx_t_10 = 0; __pyx_t_10 &lt; __pyx_t_9; __pyx_t_10+=1) {
    __pyx_v_i = __pyx_t_10;
</pre><pre class="cython line score-34" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">513</span>:         idxs = &lt;cnp.ndarray[cnp.intp_t, ndim=1]&gt; sparseMap[i] # FFR: to avoid the cast, create sparseMap as dict[intp, np.ndarray[intp]]</pre>
<pre class='cython code score-34 '>    if (unlikely(__pyx_v_sparseMap == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
      <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
    }
    __pyx_t_1 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_i);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyDict_GetItem</span>(__pyx_v_sparseMap, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 513, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = __pyx_t_4;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer);
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_11 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_12, &amp;__pyx_t_13, &amp;__pyx_t_14);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_idxs, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_12, __pyx_t_13, __pyx_t_14);
        }
        __pyx_t_12 = __pyx_t_13 = __pyx_t_14 = 0;
      }
      __pyx_pybuffernd_idxs.diminfo[0].strides = __pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_idxs.diminfo[0].shape = __pyx_pybuffernd_idxs.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 513, __pyx_L1_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_idxs, ((PyArrayObject *)__pyx_t_1));
    __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">514</span>:         idx_view = idxs</pre>
<pre class='cython code score-0 '>    __pyx_t_15 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_intp_t(((PyObject *)__pyx_v_idxs), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_15.memview)) __PYX_ERR(0, 514, __pyx_L1_error)</span>
    __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_idx_view, 1);
    __pyx_v_idx_view = __pyx_t_15;
    __pyx_t_15.memview = NULL;
    __pyx_t_15.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">515</span>:         m = idx_view.shape[0] # FFR: maybe enforce strict `m == numNearest` in future releases to avoid extra overhead</pre>
<pre class='cython code score-0 '>    __pyx_v_m = (__pyx_v_idx_view.shape[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">516</span>:         if m == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_16 = (__pyx_v_m == 0);
    if (__pyx_t_16) {
/* … */
    }
</pre><pre class="cython line score-0">&#xA0;<span class="">517</span>:             # this case probably warrants an exception or np.nan</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">518</span>:             out[i] = 0.0</pre>
<pre class='cython code score-0 '>      __pyx_t_17 = __pyx_v_i;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_out.diminfo[0].strides) = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">519</span>:             continue</pre>
<pre class='cython code score-0 '>      goto __pyx_L3_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">520</span>:         sumNearestVariances = 0.0</pre>
<pre class='cython code score-0 '>    __pyx_v_sumNearestVariances = 0.0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>:         with nogil:</pre>
<pre class='cython code score-4 '>    {
        PyThreadState *_save;
        _save = NULL;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            goto __pyx_L10;
          }
          __pyx_L10:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:             for j in range(m):</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = __pyx_v_m;
          __pyx_t_19 = __pyx_t_18;
          for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
            __pyx_v_j = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">523</span>:                 sumNearestVariances += trackALV[idx_view[j]]</pre>
<pre class='cython code score-0 '>            __pyx_t_17 = __pyx_v_j;
            __pyx_t_21 = (*((__pyx_t_5numpy_intp_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_intp_t *) __pyx_v_idx_view.data) + __pyx_t_17)) )));
            __pyx_v_sumNearestVariances = (__pyx_v_sumNearestVariances + (*((__pyx_t_5numpy_float32_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_float32_t *) __pyx_v_trackALV.data) + __pyx_t_21)) ))));
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">524</span>:         out[i] = sumNearestVariances/m</pre>
<pre class='cython code score-0 '>    __pyx_t_17 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float32_t *, __pyx_pybuffernd_out.rcbuffer-&gt;pybuffer.buf, __pyx_t_17, __pyx_pybuffernd_out.diminfo[0].strides) = (__pyx_v_sumNearestVariances / ((float)__pyx_v_m));
    __pyx_L3_continue:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">525</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">526</span>:     return out</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_out);
  __pyx_r = ((PyObject *)__pyx_v_out);
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">527</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">528</span>: </pre>
<pre class="cython line score-250" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>: cpdef int64_t cgetFragmentLength(</pre>
<pre class='cython code score-250 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_23cgetFragmentLength(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static int64_t __pyx_f_10consenrich_11cconsenrich_cgetFragmentLength(PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, int64_t __pyx_v_start, int64_t __pyx_v_end, CYTHON_UNUSED int __pyx_skip_dispatch, struct __pyx_opt_args_10consenrich_11cconsenrich_cgetFragmentLength *__pyx_optional_args) {
  uint16_t __pyx_v_samThreads = ((uint16_t)0);
  uint16_t __pyx_v_samFlagExclude = ((uint16_t)0xF04);
  int64_t __pyx_v_maxInsertSize = ((int64_t)0x3E8);
  int64_t __pyx_v_minInsertSize = ((int64_t)50);
  int64_t __pyx_v_iters = ((int64_t)0x3E8);
  int64_t __pyx_v_blockSize = ((int64_t)0x1388);
  int64_t __pyx_v_fallBack = ((int64_t)0x93);
  int64_t __pyx_v_rollingChunkSize = ((int64_t)0xFA);
  int64_t __pyx_v_lagStep = ((int64_t)5);
  int64_t __pyx_v_earlyExit = ((int64_t)0x64);
  int64_t __pyx_v_randSeed = ((int64_t)42);
  int64_t __pyx_v_regionLen;
  int64_t __pyx_v_numRollSteps;
  int64_t __pyx_v_numChunks;
  PyArrayObject *__pyx_v_rawArr = 0;
  PyArrayObject *__pyx_v_medArr = 0;
  struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *__pyx_v_aln = 0;
  struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *__pyx_v_read_ = 0;
  PyObject *__pyx_v_coverageIdxTopK = 0;
  PyObject *__pyx_v_blockCenters = 0;
  PyObject *__pyx_v_bestLags = 0;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_idxVal;
  int __pyx_v_startIdx;
  int __pyx_v_endIdx;
  int __pyx_v_winSize;
  int __pyx_v_takeK;
  int __pyx_v_blockHalf;
  int __pyx_v_readFlag;
  int __pyx_v_chosenLag;
  int __pyx_v_lag;
  int __pyx_v_maxValidLag;
  int64_t __pyx_v_blockStartBP;
  int64_t __pyx_v_blockEndBP;
  int64_t __pyx_v_readStart;
  int64_t __pyx_v_readEnd;
  int64_t __pyx_v_med;
  double __pyx_v_score;
  PyArrayObject *__pyx_v_unsortedIdx = 0;
  PyArrayObject *__pyx_v_sortedIdx = 0;
  PyArrayObject *__pyx_v_expandedIdx = 0;
  __Pyx_memviewslice __pyx_v_expandedIdxView = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyArrayObject *__pyx_v_unsortedVals = 0;
  PyArrayObject *__pyx_v_seen = 0;
  PyArrayObject *__pyx_v_fwd = 0;
  PyArrayObject *__pyx_v_rev = 0;
  PyArrayObject *__pyx_v_fwdDiff = 0;
  PyArrayObject *__pyx_v_revDiff = 0;
  int64_t __pyx_v_diffS;
  int64_t __pyx_v_diffE;
  PyArrayObject *__pyx_v_xCorr = 0;
  PyArrayObject *__pyx_v_bestLagsArr = 0;
  int __pyx_v_samThreads_;
  PyObject *__pyx_v_numCPUs = NULL;
  int __pyx_v_expandedLen;
  long __pyx_v_strand;
  CYTHON_UNUSED int64_t __pyx_v_posInBlock;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_bestLagsArr;
  __Pyx_Buffer __pyx_pybuffer_bestLagsArr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_expandedIdx;
  __Pyx_Buffer __pyx_pybuffer_expandedIdx;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_fwd;
  __Pyx_Buffer __pyx_pybuffer_fwd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_fwdDiff;
  __Pyx_Buffer __pyx_pybuffer_fwdDiff;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_medArr;
  __Pyx_Buffer __pyx_pybuffer_medArr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_rawArr;
  __Pyx_Buffer __pyx_pybuffer_rawArr;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_rev;
  __Pyx_Buffer __pyx_pybuffer_rev;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_revDiff;
  __Pyx_Buffer __pyx_pybuffer_revDiff;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_seen;
  __Pyx_Buffer __pyx_pybuffer_seen;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_sortedIdx;
  __Pyx_Buffer __pyx_pybuffer_sortedIdx;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_unsortedIdx;
  __Pyx_Buffer __pyx_pybuffer_unsortedIdx;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_unsortedVals;
  __Pyx_Buffer __pyx_pybuffer_unsortedVals;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_xCorr;
  __Pyx_Buffer __pyx_pybuffer_xCorr;
  int64_t __pyx_r;
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_samThreads = __pyx_optional_args-&gt;samThreads;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_samFlagExclude = __pyx_optional_args-&gt;samFlagExclude;
        if (__pyx_optional_args-&gt;__pyx_n &gt; 2) {
          __pyx_v_maxInsertSize = __pyx_optional_args-&gt;maxInsertSize;
          if (__pyx_optional_args-&gt;__pyx_n &gt; 3) {
            __pyx_v_minInsertSize = __pyx_optional_args-&gt;minInsertSize;
            if (__pyx_optional_args-&gt;__pyx_n &gt; 4) {
              __pyx_v_iters = __pyx_optional_args-&gt;iters;
              if (__pyx_optional_args-&gt;__pyx_n &gt; 5) {
                __pyx_v_blockSize = __pyx_optional_args-&gt;blockSize;
                if (__pyx_optional_args-&gt;__pyx_n &gt; 6) {
                  __pyx_v_fallBack = __pyx_optional_args-&gt;fallBack;
                  if (__pyx_optional_args-&gt;__pyx_n &gt; 7) {
                    __pyx_v_rollingChunkSize = __pyx_optional_args-&gt;rollingChunkSize;
                    if (__pyx_optional_args-&gt;__pyx_n &gt; 8) {
                      __pyx_v_lagStep = __pyx_optional_args-&gt;lagStep;
                      if (__pyx_optional_args-&gt;__pyx_n &gt; 9) {
                        __pyx_v_earlyExit = __pyx_optional_args-&gt;earlyExit;
                        if (__pyx_optional_args-&gt;__pyx_n &gt; 10) {
                          __pyx_v_randSeed = __pyx_optional_args-&gt;randSeed;
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  __pyx_pybuffer_rawArr.pybuffer.buf = NULL;
  __pyx_pybuffer_rawArr.refcount = 0;
  __pyx_pybuffernd_rawArr.data = NULL;
  __pyx_pybuffernd_rawArr.rcbuffer = &amp;__pyx_pybuffer_rawArr;
  __pyx_pybuffer_medArr.pybuffer.buf = NULL;
  __pyx_pybuffer_medArr.refcount = 0;
  __pyx_pybuffernd_medArr.data = NULL;
  __pyx_pybuffernd_medArr.rcbuffer = &amp;__pyx_pybuffer_medArr;
  __pyx_pybuffer_unsortedIdx.pybuffer.buf = NULL;
  __pyx_pybuffer_unsortedIdx.refcount = 0;
  __pyx_pybuffernd_unsortedIdx.data = NULL;
  __pyx_pybuffernd_unsortedIdx.rcbuffer = &amp;__pyx_pybuffer_unsortedIdx;
  __pyx_pybuffer_sortedIdx.pybuffer.buf = NULL;
  __pyx_pybuffer_sortedIdx.refcount = 0;
  __pyx_pybuffernd_sortedIdx.data = NULL;
  __pyx_pybuffernd_sortedIdx.rcbuffer = &amp;__pyx_pybuffer_sortedIdx;
  __pyx_pybuffer_expandedIdx.pybuffer.buf = NULL;
  __pyx_pybuffer_expandedIdx.refcount = 0;
  __pyx_pybuffernd_expandedIdx.data = NULL;
  __pyx_pybuffernd_expandedIdx.rcbuffer = &amp;__pyx_pybuffer_expandedIdx;
  __pyx_pybuffer_unsortedVals.pybuffer.buf = NULL;
  __pyx_pybuffer_unsortedVals.refcount = 0;
  __pyx_pybuffernd_unsortedVals.data = NULL;
  __pyx_pybuffernd_unsortedVals.rcbuffer = &amp;__pyx_pybuffer_unsortedVals;
  __pyx_pybuffer_seen.pybuffer.buf = NULL;
  __pyx_pybuffer_seen.refcount = 0;
  __pyx_pybuffernd_seen.data = NULL;
  __pyx_pybuffernd_seen.rcbuffer = &amp;__pyx_pybuffer_seen;
  __pyx_pybuffer_fwd.pybuffer.buf = NULL;
  __pyx_pybuffer_fwd.refcount = 0;
  __pyx_pybuffernd_fwd.data = NULL;
  __pyx_pybuffernd_fwd.rcbuffer = &amp;__pyx_pybuffer_fwd;
  __pyx_pybuffer_rev.pybuffer.buf = NULL;
  __pyx_pybuffer_rev.refcount = 0;
  __pyx_pybuffernd_rev.data = NULL;
  __pyx_pybuffernd_rev.rcbuffer = &amp;__pyx_pybuffer_rev;
  __pyx_pybuffer_fwdDiff.pybuffer.buf = NULL;
  __pyx_pybuffer_fwdDiff.refcount = 0;
  __pyx_pybuffernd_fwdDiff.data = NULL;
  __pyx_pybuffernd_fwdDiff.rcbuffer = &amp;__pyx_pybuffer_fwdDiff;
  __pyx_pybuffer_revDiff.pybuffer.buf = NULL;
  __pyx_pybuffer_revDiff.refcount = 0;
  __pyx_pybuffernd_revDiff.data = NULL;
  __pyx_pybuffernd_revDiff.rcbuffer = &amp;__pyx_pybuffer_revDiff;
  __pyx_pybuffer_xCorr.pybuffer.buf = NULL;
  __pyx_pybuffer_xCorr.refcount = 0;
  __pyx_pybuffernd_xCorr.data = NULL;
  __pyx_pybuffernd_xCorr.rcbuffer = &amp;__pyx_pybuffer_xCorr;
  __pyx_pybuffer_bestLagsArr.pybuffer.buf = NULL;
  __pyx_pybuffer_bestLagsArr.refcount = 0;
  __pyx_pybuffernd_bestLagsArr.data = NULL;
  __pyx_pybuffernd_bestLagsArr.rcbuffer = &amp;__pyx_pybuffer_bestLagsArr;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_22, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetFragmentLength", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rawArr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_medArr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_aln);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_read_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_coverageIdxTopK);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_blockCenters);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bestLags);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_unsortedIdx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_sortedIdx);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_expandedIdx);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_expandedIdxView, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_unsortedVals);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_seen);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_fwd);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_rev);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_fwdDiff);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_revDiff);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_xCorr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_bestLagsArr);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_numCPUs);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_23cgetFragmentLength(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_23cgetFragmentLength = {"cgetFragmentLength", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_23cgetFragmentLength, __Pyx_METH_FASTCALL|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_23cgetFragmentLength(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_bamFile = 0;
  PyObject *__pyx_v_chromosome = 0;
  int64_t __pyx_v_start;
  int64_t __pyx_v_end;
  uint16_t __pyx_v_samThreads;
  uint16_t __pyx_v_samFlagExclude;
  int64_t __pyx_v_maxInsertSize;
  int64_t __pyx_v_minInsertSize;
  int64_t __pyx_v_iters;
  int64_t __pyx_v_blockSize;
  int64_t __pyx_v_fallBack;
  int64_t __pyx_v_rollingChunkSize;
  int64_t __pyx_v_lagStep;
  int64_t __pyx_v_earlyExit;
  int64_t __pyx_v_randSeed;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cgetFragmentLength (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_bamFile,&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromosome,&amp;__pyx_mstate_global-&gt;__pyx_n_u_start,&amp;__pyx_mstate_global-&gt;__pyx_n_u_end,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samThreads,&amp;__pyx_mstate_global-&gt;__pyx_n_u_samFlagExclude,&amp;__pyx_mstate_global-&gt;__pyx_n_u_maxInsertSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_minInsertSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_iters,&amp;__pyx_mstate_global-&gt;__pyx_n_u_blockSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_fallBack,&amp;__pyx_mstate_global-&gt;__pyx_n_u_rollingChunkSize,&amp;__pyx_mstate_global-&gt;__pyx_n_u_lagStep,&amp;__pyx_mstate_global-&gt;__pyx_n_u_earlyExit,&amp;__pyx_mstate_global-&gt;__pyx_n_u_randSeed,0};
  PyObject* values[15] = {0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case 15:
        values[14] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 14);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[14])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 14:
        values[13] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 13);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[13])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 13:
        values[12] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 12);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[12])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 12:
        values[11] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 11);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[11])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 11:
        values[10] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 10);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[10])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 10:
        values[9] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 9);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[9])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  9:
        values[8] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 8);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[8])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  8:
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cgetFragmentLength", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 4; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetFragmentLength", 0, 4, 15, i); <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span> }
      }
    } else {
      switch (__pyx_nargs) {
        case 15:
        values[14] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 14);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[14])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 14:
        values[13] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 13);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[13])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 13:
        values[12] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 12);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[12])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 12:
        values[11] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 11);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[11])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 11:
        values[10] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 10);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[10])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case 10:
        values[9] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 9);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[9])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  9:
        values[8] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 8);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[8])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  8:
        values[7] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 7);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[7])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  7:
        values[6] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 6);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[6])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  6:
        values[5] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 5);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[5])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  5:
        values[4] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 4);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[4])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_bamFile = ((PyObject*)values[0]);
    __pyx_v_chromosome = ((PyObject*)values[1]);
    __pyx_v_start = __Pyx_PyLong_As_int64_t(values[2]); if (unlikely((__pyx_v_start == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 532, __pyx_L3_error)</span>
    __pyx_v_end = __Pyx_PyLong_As_int64_t(values[3]); if (unlikely((__pyx_v_end == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 533, __pyx_L3_error)</span>
    if (values[4]) {
      __pyx_v_samThreads = __Pyx_PyLong_As_uint16_t(values[4]); if (unlikely((__pyx_v_samThreads == ((uint16_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 534, __pyx_L3_error)</span>
    } else {
      __pyx_v_samThreads = ((uint16_t)0);
    }
    if (values[5]) {
      __pyx_v_samFlagExclude = __Pyx_PyLong_As_uint16_t(values[5]); if (unlikely((__pyx_v_samFlagExclude == ((uint16_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 535, __pyx_L3_error)</span>
    } else {
      __pyx_v_samFlagExclude = ((uint16_t)0xF04);
    }
    if (values[6]) {
      __pyx_v_maxInsertSize = __Pyx_PyLong_As_int64_t(values[6]); if (unlikely((__pyx_v_maxInsertSize == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 536, __pyx_L3_error)</span>
    } else {
      __pyx_v_maxInsertSize = ((int64_t)0x3E8);
    }
    if (values[7]) {
      __pyx_v_minInsertSize = __Pyx_PyLong_As_int64_t(values[7]); if (unlikely((__pyx_v_minInsertSize == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 537, __pyx_L3_error)</span>
    } else {
      __pyx_v_minInsertSize = ((int64_t)50);
    }
    if (values[8]) {
      __pyx_v_iters = __Pyx_PyLong_As_int64_t(values[8]); if (unlikely((__pyx_v_iters == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 538, __pyx_L3_error)</span>
    } else {
      __pyx_v_iters = ((int64_t)0x3E8);
    }
    if (values[9]) {
      __pyx_v_blockSize = __Pyx_PyLong_As_int64_t(values[9]); if (unlikely((__pyx_v_blockSize == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 539, __pyx_L3_error)</span>
    } else {
      __pyx_v_blockSize = ((int64_t)0x1388);
    }
    if (values[10]) {
      __pyx_v_fallBack = __Pyx_PyLong_As_int64_t(values[10]); if (unlikely((__pyx_v_fallBack == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 540, __pyx_L3_error)</span>
    } else {
      __pyx_v_fallBack = ((int64_t)0x93);
    }
    if (values[11]) {
      __pyx_v_rollingChunkSize = __Pyx_PyLong_As_int64_t(values[11]); if (unlikely((__pyx_v_rollingChunkSize == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 541, __pyx_L3_error)</span>
    } else {
      __pyx_v_rollingChunkSize = ((int64_t)0xFA);
    }
    if (values[12]) {
      __pyx_v_lagStep = __Pyx_PyLong_As_int64_t(values[12]); if (unlikely((__pyx_v_lagStep == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 542, __pyx_L3_error)</span>
    } else {
      __pyx_v_lagStep = ((int64_t)5);
    }
    if (values[13]) {
      __pyx_v_earlyExit = __Pyx_PyLong_As_int64_t(values[13]); if (unlikely((__pyx_v_earlyExit == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 543, __pyx_L3_error)</span>
    } else {
      __pyx_v_earlyExit = ((int64_t)0x64);
    }
    if (values[14]) {
      __pyx_v_randSeed = __Pyx_PyLong_As_int64_t(values[14]); if (unlikely((__pyx_v_randSeed == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 544, __pyx_L3_error)</span>
    } else {
      __pyx_v_randSeed = ((int64_t)42);
    }
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cgetFragmentLength", 0, 4, 15, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetFragmentLength", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bamFile), (&amp;PyUnicode_Type), 1, "bamFile", 1))) <span class='error_goto'>__PYX_ERR(0, 530, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chromosome), (&amp;PyUnicode_Type), 1, "chromosome", 1))) <span class='error_goto'>__PYX_ERR(0, 531, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_22cgetFragmentLength(__pyx_self, __pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_start, __pyx_v_end, __pyx_v_samThreads, __pyx_v_samFlagExclude, __pyx_v_maxInsertSize, __pyx_v_minInsertSize, __pyx_v_iters, __pyx_v_blockSize, __pyx_v_fallBack, __pyx_v_rollingChunkSize, __pyx_v_lagStep, __pyx_v_earlyExit, __pyx_v_randSeed);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_22cgetFragmentLength(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_bamFile, PyObject *__pyx_v_chromosome, int64_t __pyx_v_start, int64_t __pyx_v_end, uint16_t __pyx_v_samThreads, uint16_t __pyx_v_samFlagExclude, int64_t __pyx_v_maxInsertSize, int64_t __pyx_v_minInsertSize, int64_t __pyx_v_iters, int64_t __pyx_v_blockSize, int64_t __pyx_v_fallBack, int64_t __pyx_v_rollingChunkSize, int64_t __pyx_v_lagStep, int64_t __pyx_v_earlyExit, int64_t __pyx_v_randSeed) {
  PyObject *__pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 11;
  __pyx_t_2.samThreads = __pyx_v_samThreads;
  __pyx_t_2.samFlagExclude = __pyx_v_samFlagExclude;
  __pyx_t_2.maxInsertSize = __pyx_v_maxInsertSize;
  __pyx_t_2.minInsertSize = __pyx_v_minInsertSize;
  __pyx_t_2.iters = __pyx_v_iters;
  __pyx_t_2.blockSize = __pyx_v_blockSize;
  __pyx_t_2.fallBack = __pyx_v_fallBack;
  __pyx_t_2.rollingChunkSize = __pyx_v_rollingChunkSize;
  __pyx_t_2.lagStep = __pyx_v_lagStep;
  __pyx_t_2.earlyExit = __pyx_v_earlyExit;
  __pyx_t_2.randSeed = __pyx_v_randSeed;
  __pyx_t_1 = __pyx_f_10consenrich_11cconsenrich_cgetFragmentLength(__pyx_v_bamFile, __pyx_v_chromosome, __pyx_v_start, __pyx_v_end, 1, &amp;__pyx_t_2); if (unlikely(__pyx_t_1 == ((int64_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>
  __pyx_t_3 = __Pyx_PyLong_From_int64_t(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 529, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cgetFragmentLength", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_23cgetFragmentLength, 0, __pyx_mstate_global-&gt;__pyx_n_u_cgetFragmentLength, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[11]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 529, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_tuple[5]);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cgetFragmentLength, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 529, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
/* … */
struct __pyx_opt_args_10consenrich_11cconsenrich_cgetFragmentLength {
  int __pyx_n;
  uint16_t samThreads;
  uint16_t samFlagExclude;
  int64_t maxInsertSize;
  int64_t minInsertSize;
  int64_t iters;
  int64_t blockSize;
  int64_t fallBack;
  int64_t rollingChunkSize;
  int64_t lagStep;
  int64_t earlyExit;
  int64_t randSeed;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">530</span>:     str bamFile,</pre>
<pre class="cython line score-0">&#xA0;<span class="">531</span>:     str chromosome,</pre>
<pre class="cython line score-0">&#xA0;<span class="">532</span>:     int64_t start,</pre>
<pre class="cython line score-0">&#xA0;<span class="">533</span>:     int64_t end,</pre>
<pre class="cython line score-0">&#xA0;<span class="">534</span>:     uint16_t samThreads=0,</pre>
<pre class="cython line score-0">&#xA0;<span class="">535</span>:     uint16_t samFlagExclude=3844,</pre>
<pre class="cython line score-0">&#xA0;<span class="">536</span>:     int64_t maxInsertSize=1000,</pre>
<pre class="cython line score-0">&#xA0;<span class="">537</span>:     int64_t minInsertSize=50,</pre>
<pre class="cython line score-0">&#xA0;<span class="">538</span>:     int64_t iters=1000,</pre>
<pre class="cython line score-0">&#xA0;<span class="">539</span>:     int64_t blockSize=5000,</pre>
<pre class="cython line score-0">&#xA0;<span class="">540</span>:     int64_t fallBack=147,</pre>
<pre class="cython line score-0">&#xA0;<span class="">541</span>:     int64_t rollingChunkSize=250,</pre>
<pre class="cython line score-0">&#xA0;<span class="">542</span>:     int64_t lagStep=5,</pre>
<pre class="cython line score-0">&#xA0;<span class="">543</span>:     int64_t earlyExit=100,</pre>
<pre class="cython line score-0">&#xA0;<span class="">544</span>:     int64_t randSeed=42,</pre>
<pre class="cython line score-0">&#xA0;<span class="">545</span>: ):</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">546</span>:     np.random.seed(randSeed)</pre>
<pre class='cython code score-12 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_2 = __pyx_t_4;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyLong_From_int64_t(__pyx_v_randSeed);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 546, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = 0;
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_seed, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 546, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">547</span>:     cdef int64_t regionLen, numRollSteps, numChunks</pre>
<pre class="cython line score-0">&#xA0;<span class="">548</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] rawArr</pre>
<pre class="cython line score-0">&#xA0;<span class="">549</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] medArr</pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>:     cdef AlignmentFile aln</pre>
<pre class="cython line score-0">&#xA0;<span class="">551</span>:     cdef AlignedSegment read_</pre>
<pre class="cython line score-0">&#xA0;<span class="">552</span>:     cdef list coverageIdxTopK</pre>
<pre class="cython line score-0">&#xA0;<span class="">553</span>:     cdef list blockCenters</pre>
<pre class="cython line score-0">&#xA0;<span class="">554</span>:     cdef list bestLags</pre>
<pre class="cython line score-0">&#xA0;<span class="">555</span>:     cdef int i, j, k, idxVal</pre>
<pre class="cython line score-0">&#xA0;<span class="">556</span>:     cdef int startIdx, endIdx</pre>
<pre class="cython line score-0">&#xA0;<span class="">557</span>:     cdef int winSize, takeK</pre>
<pre class="cython line score-0">&#xA0;<span class="">558</span>:     cdef int blockHalf, readFlag</pre>
<pre class="cython line score-0">&#xA0;<span class="">559</span>:     cdef int chosenLag, lag, maxValidLag</pre>
<pre class="cython line score-0">&#xA0;<span class="">560</span>:     cdef int64_t blockStartBP, blockEndBP, readStart, readEnd, med</pre>
<pre class="cython line score-0">&#xA0;<span class="">561</span>:     cdef double score</pre>
<pre class="cython line score-0">&#xA0;<span class="">562</span>:     cdef cnp.ndarray[cnp.intp_t, ndim=1] unsortedIdx, sortedIdx, expandedIdx</pre>
<pre class="cython line score-0">&#xA0;<span class="">563</span>:     cdef cnp.intp_t[::1] expandedIdxView</pre>
<pre class="cython line score-0">&#xA0;<span class="">564</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] unsortedVals</pre>
<pre class="cython line score-0">&#xA0;<span class="">565</span>:     cdef cnp.ndarray[cnp.uint8_t, ndim=1] seen</pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] fwd = np.zeros(blockSize, dtype=np.float64, order='C')</pre>
<pre class='cython code score-38 '>  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyLong_From_int64_t(__pyx_v_blockSize);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_4, __pyx_t_3};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_7, __pyx_t_6, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_order, __pyx_mstate_global-&gt;__pyx_n_u_C, __pyx_t_6, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_2, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_fwd = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 566, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_fwd.diminfo[0].strides = __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_fwd.diminfo[0].shape = __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_fwd = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] rev = np.zeros(blockSize, dtype=np.float64, order='C')</pre>
<pre class='cython code score-38 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_blockSize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_2, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 567, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_4, __pyx_t_3, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_order, __pyx_mstate_global-&gt;__pyx_n_u_C, __pyx_t_3, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_7, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_rev = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 567, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_rev.diminfo[0].strides = __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rev.diminfo[0].shape = __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_rev = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">568</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] fwdDiff = np.zeros(blockSize + 1, dtype=np.float64, order='C')</pre>
<pre class='cython code score-38 '>  __pyx_t_7 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyLong_From_int64_t((__pyx_v_blockSize + 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_7);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_7, __pyx_t_3};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_2, __pyx_t_6, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_order, __pyx_mstate_global-&gt;__pyx_n_u_C, __pyx_t_6, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_fwdDiff = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 568, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_fwdDiff.diminfo[0].strides = __pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_fwdDiff.diminfo[0].shape = __pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_fwdDiff = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] revDiff = np.zeros(blockSize + 1, dtype=np.float64, order='C')</pre>
<pre class='cython code score-38 '>  __pyx_t_4 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyLong_From_int64_t((__pyx_v_blockSize + 1));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    assert(__pyx_t_4);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_4, __pyx_t_6};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 569, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_7, __pyx_t_3, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_order, __pyx_mstate_global-&gt;__pyx_n_u_C, __pyx_t_3, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_2, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_revDiff = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 569, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_revDiff.diminfo[0].strides = __pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_revDiff.diminfo[0].shape = __pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_revDiff = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:     cdef int64_t diffS, diffE = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_diffE = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">571</span>:     cdef cnp.ndarray[cnp.float64_t, ndim=1] xCorr</pre>
<pre class="cython line score-0">&#xA0;<span class="">572</span>:     cdef cnp.ndarray[cnp.uint32_t, ndim=1] bestLagsArr</pre>
<pre class="cython line score-0">&#xA0;<span class="">573</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">574</span>:     earlyExit = min(earlyExit, iters)</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_iters;
  __pyx_t_9 = __pyx_v_earlyExit;
  __pyx_t_11 = (__pyx_t_8 &lt; __pyx_t_9);
  if (__pyx_t_11) {
    __pyx_t_10 = __pyx_t_8;
  } else {
    __pyx_t_10 = __pyx_t_9;
  }
  __pyx_v_earlyExit = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">575</span>:     regionLen = end - start</pre>
<pre class='cython code score-0 '>  __pyx_v_regionLen = (__pyx_v_end - __pyx_v_start);
</pre><pre class="cython line score-0">&#xA0;<span class="">576</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">577</span>:     samThreads_ = &lt;int&gt;samThreads</pre>
<pre class='cython code score-0 '>  __pyx_v_samThreads_ = ((int)__pyx_v_samThreads);
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">578</span>:     numCPUs = os.cpu_count()</pre>
<pre class='cython code score-19 '>  __pyx_t_2 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_os);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_cpu_count);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 578, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    assert(__pyx_t_2);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_2, NULL};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 578, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_v_numCPUs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">579</span>:     if numCPUs is None:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_numCPUs == Py_None);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">580</span>:         numCPUs = 1</pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_mstate_global-&gt;__pyx_int_1);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_numCPUs, __pyx_mstate_global-&gt;__pyx_int_1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:     if samThreads &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_samThreads &lt; 1);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">582</span>:         samThreads_ = &lt;int&gt;min(max(1,numCPUs // 2), 4)</pre>
<pre class='cython code score-42 '>    __pyx_t_12 = 4;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_FloorDivideObjC</span>(__pyx_v_numCPUs, __pyx_mstate_global-&gt;__pyx_int_2, 2, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = 1;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyLong_From_long</span>(__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_11) {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_7 = __pyx_t_1;
    } else {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_long</span>(__pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = __pyx_t_3;
      __pyx_t_3 = 0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    __pyx_t_1 = __pyx_t_7;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyLong_From_long</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (__pyx_t_11) {
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyLong_From_long</span>(__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 582, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = __pyx_t_2;
      __pyx_t_2 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_7 = __pyx_t_1;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_7); if (unlikely((__pyx_t_14 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 582, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_v_samThreads_ = ((int)__pyx_t_14);
</pre><pre class="cython line score-0">&#xA0;<span class="">583</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">584</span>:     if regionLen &lt; blockSize or regionLen &lt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_15 = (__pyx_v_regionLen &lt; __pyx_v_blockSize);
  if (!__pyx_t_15) {
  } else {
    __pyx_t_11 = __pyx_t_15;
    goto __pyx_L6_bool_binop_done;
  }
  __pyx_t_15 = (__pyx_v_regionLen &lt;= 0);
  __pyx_t_11 = __pyx_t_15;
  __pyx_L6_bool_binop_done:;
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:         return &lt;int64_t&gt;fallBack</pre>
<pre class='cython code score-0 '>    __pyx_r = ((int64_t)__pyx_v_fallBack);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">586</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:     if maxInsertSize &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_maxInsertSize &lt; 1);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">588</span>:         maxInsertSize = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_maxInsertSize = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">589</span>:     if minInsertSize &lt; 1:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_minInsertSize &lt; 1);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:         minInsertSize = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_minInsertSize = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:     if minInsertSize &gt; maxInsertSize:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_minInsertSize &gt; __pyx_v_maxInsertSize);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">592</span>:         minInsertSize, maxInsertSize = maxInsertSize, minInsertSize</pre>
<pre class='cython code score-0 '>    __pyx_t_10 = __pyx_v_maxInsertSize;
    __pyx_t_8 = __pyx_v_minInsertSize;
    __pyx_v_minInsertSize = __pyx_t_10;
    __pyx_v_maxInsertSize = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">593</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">594</span>:     # first, we build a coarse read coverage track from `start` to `end`</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">595</span>:     numRollSteps = regionLen // rollingChunkSize</pre>
<pre class='cython code score-0 '>  __pyx_v_numRollSteps = (__pyx_v_regionLen / __pyx_v_rollingChunkSize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">596</span>:     if numRollSteps &lt;= 0:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_numRollSteps &lt;= 0);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">597</span>:         numRollSteps = 1</pre>
<pre class='cython code score-0 '>    __pyx_v_numRollSteps = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">598</span>:     numChunks = &lt;int&gt;numRollSteps</pre>
<pre class='cython code score-0 '>  __pyx_v_numChunks = ((int)__pyx_v_numRollSteps);
</pre><pre class="cython line score-0">&#xA0;<span class="">599</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">600</span>:     rawArr = np.zeros(numChunks, dtype=np.float64)</pre>
<pre class='cython code score-51 '>  __pyx_t_1 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyLong_From_int64_t(__pyx_v_numChunks);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 600, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    assert(__pyx_t_1);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_1, __pyx_t_2};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_4, __pyx_t_6, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  }
  if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_7), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_14 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_rawArr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
      }
      __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
    }
    __pyx_pybuffernd_rawArr.diminfo[0].strides = __pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rawArr.diminfo[0].shape = __pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 600, __pyx_L1_error)</span>
  }
  __pyx_v_rawArr = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">601</span>:     medArr = np.zeros(numChunks, dtype=np.float64)</pre>
<pre class='cython code score-51 '>  __pyx_t_3 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_numChunks);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    assert(__pyx_t_3);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, __pyx_t_6};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 601, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_1, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  }
  if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer);
    __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_7), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_14 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_medArr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
      }
      __pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;
    }
    __pyx_pybuffernd_medArr.diminfo[0].strides = __pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_medArr.diminfo[0].shape = __pyx_pybuffernd_medArr.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 601, __pyx_L1_error)</span>
  }
  __pyx_v_medArr = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">602</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">603</span>:     aln = AlignmentFile(bamFile, "rb", threads=samThreads_)</pre>
<pre class='cython code score-13 '>  __pyx_t_4 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile);
  __pyx_t_2 = ((PyObject *)__pyx_mstate_global-&gt;__pyx_ptype_5pysam_17libcalignmentfile_AlignmentFile); 
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_samThreads_);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = 1;
  {
    PyObject *__pyx_callargs[3 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_v_bamFile, __pyx_mstate_global-&gt;__pyx_n_u_rb};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 603, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_threads, __pyx_t_1, __pyx_t_6, __pyx_callargs+3, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_2, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 603, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>((PyObject *)__pyx_t_7);
  }
  __pyx_v_aln = ((struct __pyx_obj_5pysam_17libcalignmentfile_AlignmentFile *)__pyx_t_7);
  __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">604</span>:     try:</pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">605</span>:         for read_ in aln.fetch(chromosome, start, end):</pre>
<pre class='cython code score-57 '>    __pyx_t_2 = ((PyObject *)__pyx_v_aln);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 605, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_1 = __Pyx_PyLong_From_int64_t(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[4] = {__pyx_t_2, __pyx_v_chromosome, __pyx_t_6, __pyx_t_1};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fetch, __pyx_callargs+__pyx_t_5, (4-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    }
    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
      __pyx_t_1 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_19 = 0;
      __pyx_t_20 = NULL;
    } else {
      __pyx_t_19 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 605, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_20 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 605, __pyx_L13_error)</span>
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    for (;;) {
      if (likely(!__pyx_t_20)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L13_error)</span>
            #endif
            if (__pyx_t_19 &gt;= __pyx_temp) break;
          }
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_1, __pyx_t_19);
          ++__pyx_t_19;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L13_error)</span>
            #endif
            if (__pyx_t_19 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_19));
          #else
          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_19);
          #endif
          ++__pyx_t_19;
        }
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L13_error)</span>
      } else {
        __pyx_t_7 = __pyx_t_20(__pyx_t_1);
        if (unlikely(!__pyx_t_7)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L13_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_ptype_5pysam_18libcalignedsegment_AlignedSegment))))) <span class='error_goto'>__PYX_ERR(0, 605, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_read_, ((struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *)__pyx_t_7));
      __pyx_t_7 = 0;
/* … */
      __pyx_L15_continue:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:             if (read_.flag &amp; samFlagExclude) != 0:</pre>
<pre class='cython code score-12 '>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_flag);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 606, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_6 = __Pyx_PyLong_From_uint16_t(__pyx_v_samFlagExclude);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 606, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_And</span>(__pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 606, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_11 = (<span class='pyx_c_api'>__Pyx_PyLong_BoolNeObjC</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_int_0, 0, 0)); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 606, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">607</span>:                 continue</pre>
<pre class='cython code score-0 '>        goto __pyx_L15_continue;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">608</span>:             if read_.reference_start &lt; start or read_.reference_end &gt;= end:</pre>
<pre class='cython code score-24 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_start);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_2, __pyx_t_6, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely((__pyx_t_15 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (!__pyx_t_15) {
      } else {
        __pyx_t_11 = __pyx_t_15;
        goto __pyx_L19_bool_binop_done;
      }
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_end);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_7, __pyx_t_6, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_15 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 608, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_11 = __pyx_t_15;
      __pyx_L19_bool_binop_done:;
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">609</span>:                 continue</pre>
<pre class='cython code score-0 '>        goto __pyx_L15_continue;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">610</span>:             j = &lt;int&gt;((read_.reference_start - start) // rollingChunkSize)</pre>
<pre class='cython code score-24 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_start);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 610, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_2, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 610, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyLong_From_int64_t(__pyx_v_rollingChunkSize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 610, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 610, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_14 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 610, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_v_j = ((int)__pyx_t_14);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">611</span>:             if 0 &lt;= j &lt; numChunks:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (0 &lt;= __pyx_v_j);
      if (__pyx_t_11) {
        __pyx_t_11 = (__pyx_v_j &lt; __pyx_v_numChunks);
      }
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">612</span>:                 rawArr[j] += 1.0</pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_j;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rawArr.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_rawArr.diminfo[0].strides) += 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">613</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">614</span>:         # second, we apply a rolling/moving/local/weywtci order-statistic filter (median)</pre>
<pre class="cython line score-0">&#xA0;<span class="">615</span>:         # ...the size of the kernel is based on the blockSize -- we want high-coverage</pre>
<pre class="cython line score-0">&#xA0;<span class="">616</span>:         # ...blocks as measured by their local median read counts</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">617</span>:         winSize = &lt;int&gt;(blockSize // rollingChunkSize)</pre>
<pre class='cython code score-0 '>    __pyx_v_winSize = ((int)(__pyx_v_blockSize / __pyx_v_rollingChunkSize));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">618</span>:         if winSize &lt; 1:</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = (__pyx_v_winSize &lt; 1);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">619</span>:             winSize = 1</pre>
<pre class='cython code score-0 '>      __pyx_v_winSize = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">620</span>:         if (winSize &amp; 1) == 0:</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = ((__pyx_v_winSize &amp; 1) == 0);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">621</span>:             winSize += 1</pre>
<pre class='cython code score-0 '>      __pyx_v_winSize = (__pyx_v_winSize + 1);
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">622</span>:         medArr[:] = ndimage.median_filter(rawArr, size=winSize, mode="nearest")</pre>
<pre class='cython code score-35 '>    __pyx_t_2 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_ndimage);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_n_u_median_filter);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 622, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_winSize);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      assert(__pyx_t_2);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 2 : 0)] = {__pyx_t_2, ((PyObject *)__pyx_v_rawArr)};
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_size, __pyx_t_6, __pyx_t_4, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 622, __pyx_L13_error)</span>
      if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_mode, __pyx_mstate_global-&gt;__pyx_n_u_nearest, __pyx_t_4, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 622, __pyx_L13_error)</span>
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_7, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 622, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    if (unlikely((<span class='py_c_api'>PyObject_SetItem</span>(((PyObject *)__pyx_v_medArr), __pyx_mstate_global-&gt;__pyx_slice[0], __pyx_t_1) &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 622, __pyx_L13_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">623</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">624</span>:         # we pick the largest local-medians and form a block around each</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">625</span>:         takeK = iters if iters &lt; numChunks else numChunks</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = (__pyx_v_iters &lt; __pyx_v_numChunks);
    if (__pyx_t_11) {
      __pyx_t_8 = __pyx_v_iters;
    } else {
      __pyx_t_8 = __pyx_v_numChunks;
    }
    __pyx_v_takeK = __pyx_t_8;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:         unsortedIdx = np.argpartition(medArr, -takeK)[-takeK:]</pre>
<pre class='cython code score-45 '>    __pyx_t_7 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_argpartition);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>((-__pyx_v_takeK));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      assert(__pyx_t_7);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[3] = {__pyx_t_7, ((PyObject *)__pyx_v_medArr), __pyx_t_4};
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_6, __pyx_callargs+__pyx_t_5, (3-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_t_1, (-__pyx_v_takeK), 0, NULL, NULL, NULL, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L13_error)</span>
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_14 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_unsortedIdx, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
        }
        __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
      }
      __pyx_pybuffernd_unsortedIdx.diminfo[0].strides = __pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_unsortedIdx.diminfo[0].shape = __pyx_pybuffernd_unsortedIdx.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 626, __pyx_L13_error)</span>
    }
    __pyx_v_unsortedIdx = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">627</span>:         unsortedVals = medArr[unsortedIdx]</pre>
<pre class='cython code score-22 '>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_medArr), ((PyObject *)__pyx_v_unsortedIdx));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 627, __pyx_L13_error)</span>
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_14 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_unsortedVals, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
        }
        __pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;
      }
      __pyx_pybuffernd_unsortedVals.diminfo[0].strides = __pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_unsortedVals.diminfo[0].shape = __pyx_pybuffernd_unsortedVals.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 627, __pyx_L13_error)</span>
    }
    __pyx_v_unsortedVals = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:         sortedIdx = unsortedIdx[np.argsort(unsortedVals)[::-1]]</pre>
<pre class='cython code score-50 '>    __pyx_t_1 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_argsort);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      assert(__pyx_t_1);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_1, ((PyObject *)__pyx_v_unsortedVals)};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_7, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_slice[1]);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_unsortedIdx), __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L13_error)</span>
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_14 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_sortedIdx, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
        }
        __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
      }
      __pyx_pybuffernd_sortedIdx.diminfo[0].strides = __pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_sortedIdx.diminfo[0].shape = __pyx_pybuffernd_sortedIdx.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L13_error)</span>
    }
    __pyx_v_sortedIdx = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
/* … */
  __pyx_mstate_global-&gt;__pyx_slice[1] = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, __pyx_mstate_global-&gt;__pyx_int_neg_1); if (unlikely(!__pyx_mstate_global-&gt;__pyx_slice[1])) <span class='error_goto'>__PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_mstate_global-&gt;__pyx_slice[1]);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_mstate_global-&gt;__pyx_slice[1]);
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">629</span>:         coverageIdxTopK = sortedIdx[:takeK].tolist()</pre>
<pre class='cython code score-23 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_takeK);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_4 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_1, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_sortedIdx), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_7 = __pyx_t_1;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    __pyx_t_5 = 0;
    {
      PyObject *__pyx_callargs[2] = {__pyx_t_7, NULL};
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_tolist, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))||((__pyx_t_6) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("list", __pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 629, __pyx_L13_error)</span>
    __pyx_v_coverageIdxTopK = ((PyObject*)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">630</span>:         expandedLen = takeK*winSize</pre>
<pre class='cython code score-0 '>    __pyx_v_expandedLen = (__pyx_v_takeK * __pyx_v_winSize);
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>:         expandedIdx = np.empty(expandedLen, dtype=np.intp)</pre>
<pre class='cython code score-53 '>    __pyx_t_1 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_n_u_empty);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_expandedLen);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 631, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_intp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
      assert(__pyx_t_1);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_1, __pyx_t_7};
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 631, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_3, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L13_error)</span>
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L13_error)</span>
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_14 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_expandedIdx, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
        }
        __pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;
      }
      __pyx_pybuffernd_expandedIdx.diminfo[0].strides = __pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_expandedIdx.diminfo[0].shape = __pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L13_error)</span>
    }
    __pyx_v_expandedIdx = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:         expandedIdxView = expandedIdx</pre>
<pre class='cython code score-0 '>    __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_intp_t(((PyObject *)__pyx_v_expandedIdx), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 632, __pyx_L13_error)</span>
    __pyx_v_expandedIdxView = __pyx_t_22;
    __pyx_t_22.memview = NULL;
    __pyx_t_22.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">633</span>:         k = 0</pre>
<pre class='cython code score-0 '>    __pyx_v_k = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">634</span>:         for i in range(takeK):</pre>
<pre class='cython code score-0 '>    __pyx_t_14 = __pyx_v_takeK;
    __pyx_t_23 = __pyx_t_14;
    for (__pyx_t_24 = 0; __pyx_t_24 &lt; __pyx_t_23; __pyx_t_24+=1) {
      __pyx_v_i = __pyx_t_24;
</pre><pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">635</span>:             idxVal = coverageIdxTopK[i]</pre>
<pre class='cython code score-14 '>      if (unlikely(__pyx_v_coverageIdxTopK == Py_None)) {
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not subscriptable");
        <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L13_error)</span>
      }
      __pyx_t_25 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(<span class='pyx_c_api'>__Pyx_PyList_GET_ITEM</span>(__pyx_v_coverageIdxTopK, __pyx_v_i)); if (unlikely((__pyx_t_25 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 635, __pyx_L13_error)</span>
      __pyx_v_idxVal = __pyx_t_25;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">636</span>:             startIdx = idxVal - (winSize // 2)</pre>
<pre class='cython code score-0 '>      __pyx_v_startIdx = (__pyx_v_idxVal - (__pyx_v_winSize / 2));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>:             endIdx = startIdx + winSize</pre>
<pre class='cython code score-0 '>      __pyx_v_endIdx = (__pyx_v_startIdx + __pyx_v_winSize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">638</span>:             if startIdx &lt; 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_startIdx &lt; 0);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>:                 startIdx = 0</pre>
<pre class='cython code score-0 '>        __pyx_v_startIdx = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">640</span>:                 endIdx = winSize if winSize &lt; numChunks else numChunks</pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_winSize &lt; __pyx_v_numChunks);
        if (__pyx_t_11) {
          __pyx_t_8 = __pyx_v_winSize;
        } else {
          __pyx_t_8 = __pyx_v_numChunks;
        }
        __pyx_v_endIdx = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">641</span>:             if endIdx &gt; numChunks:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_endIdx &gt; __pyx_v_numChunks);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">642</span>:                 endIdx = numChunks</pre>
<pre class='cython code score-0 '>        __pyx_v_endIdx = __pyx_v_numChunks;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:                 startIdx = endIdx - winSize if winSize &lt;= numChunks else 0</pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_winSize &lt;= __pyx_v_numChunks);
        if (__pyx_t_11) {
          __pyx_t_25 = (__pyx_v_endIdx - __pyx_v_winSize);
        } else {
          __pyx_t_25 = 0;
        }
        __pyx_v_startIdx = __pyx_t_25;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">644</span>:             for j in range(startIdx, endIdx):</pre>
<pre class='cython code score-0 '>      __pyx_t_25 = __pyx_v_endIdx;
      __pyx_t_26 = __pyx_t_25;
      for (__pyx_t_27 = __pyx_v_startIdx; __pyx_t_27 &lt; __pyx_t_26; __pyx_t_27+=1) {
        __pyx_v_j = __pyx_t_27;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">645</span>:                 expandedIdxView[k] = j</pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_k;
        *((__pyx_t_5numpy_intp_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_intp_t *) __pyx_v_expandedIdxView.data) + __pyx_t_21)) )) = __pyx_v_j;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">646</span>:                 k += 1</pre>
<pre class='cython code score-0 '>        __pyx_v_k = (__pyx_v_k + 1);
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">647</span>:         if k &lt; expandedLen:</pre>
<pre class='cython code score-0 '>    __pyx_t_11 = (__pyx_v_k &lt; __pyx_v_expandedLen);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">648</span>:             expandedIdx = expandedIdx[:k]</pre>
<pre class='cython code score-32 '>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_k);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 648, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_4 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_6, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 648, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_expandedIdx), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 648, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L13_error)</span>
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_14 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_expandedIdx, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_intp_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
          }
          __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
        }
        __pyx_pybuffernd_expandedIdx.diminfo[0].strides = __pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_expandedIdx.diminfo[0].shape = __pyx_pybuffernd_expandedIdx.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 648, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_expandedIdx, ((PyArrayObject *)__pyx_t_6));
      __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">649</span>:             expandedIdxView = expandedIdx</pre>
<pre class='cython code score-0 '>      __pyx_t_22 = __Pyx_PyObject_to_MemoryviewSlice_dc_nn___pyx_t_5numpy_intp_t(((PyObject *)__pyx_v_expandedIdx), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_22.memview)) __PYX_ERR(0, 649, __pyx_L13_error)</span>
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_expandedIdxView, 1);
      __pyx_v_expandedIdxView = __pyx_t_22;
      __pyx_t_22.memview = NULL;
      __pyx_t_22.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">650</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">651</span>:         seen = np.zeros(numChunks, dtype=np.uint8)</pre>
<pre class='cython code score-51 '>    __pyx_t_4 = NULL;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 651, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 651, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = __Pyx_PyLong_From_int64_t(__pyx_v_numChunks);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 651, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 651, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_n_u_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 651, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_5 = 1;
    #if CYTHON_UNPACK_METHODS
    if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      assert(__pyx_t_4);
      PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
      __pyx_t_5 = 0;
    }
    #endif
    {
      PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_t_2};
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 651, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_1, __pyx_t_7, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L13_error)</span>
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L13_error)</span>
    {
      __Pyx_BufFmt_StackElem __pyx_stack[1];
      <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
      if (unlikely(__pyx_t_14 &lt; 0)) {
        <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
        if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_seen, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
          Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);
          <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
        } else {
          <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
        }
        __pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;
      }
      __pyx_pybuffernd_seen.diminfo[0].strides = __pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_seen.diminfo[0].shape = __pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer.shape[0];
      if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 651, __pyx_L13_error)</span>
    }
    __pyx_v_seen = ((PyArrayObject *)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">652</span>:         blockCenters = []</pre>
<pre class='cython code score-5 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 652, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_v_blockCenters = ((PyObject*)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">653</span>:         for i in range(expandedIdx.shape[0]):</pre>
<pre class='cython code score-0 '>    __pyx_t_28 = (__pyx_f_5numpy_7ndarray_5shape_shape(((PyArrayObject *)__pyx_v_expandedIdx))[0]);
    __pyx_t_29 = __pyx_t_28;
    for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_29; __pyx_t_14+=1) {
      __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">654</span>:             j = &lt;int&gt;expandedIdxView[i]</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_i;
      __pyx_v_j = ((int)(*((__pyx_t_5numpy_intp_t *) ( /* dim=0 */ ((char *) (((__pyx_t_5numpy_intp_t *) __pyx_v_expandedIdxView.data) + __pyx_t_21)) ))));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">655</span>:             if seen[j] == 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_21 = __pyx_v_j;
      __pyx_t_11 = ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_seen.diminfo[0].strides)) == 0);
      if (__pyx_t_11) {
/* … */
      }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">656</span>:                 seen[j] = 1</pre>
<pre class='cython code score-0 '>        __pyx_t_21 = __pyx_v_j;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_uint8_t *, __pyx_pybuffernd_seen.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_seen.diminfo[0].strides) = 1;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">657</span>:                 blockCenters.append(j)</pre>
<pre class='cython code score-5 '>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_j);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 657, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_blockCenters, __pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 657, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">658</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">659</span>:         if len(blockCenters) &gt; 1:</pre>
<pre class='cython code score-2 '>    __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_blockCenters);<span class='error_goto'> if (unlikely(__pyx_t_19 == ((Py_ssize_t)-1))) __PYX_ERR(0, 659, __pyx_L13_error)</span>
    __pyx_t_11 = (__pyx_t_19 &gt; 1);
    if (__pyx_t_11) {
/* … */
    }
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">660</span>:             blockCenters = np.random.choice(</pre>
<pre class='cython code score-6 '>      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 660, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 660, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_1 = __pyx_t_4;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
</pre><pre class="cython line score-0">&#xA0;<span class="">661</span>:                 blockCenters,</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">662</span>:                 size=len(blockCenters),</pre>
<pre class='cython code score-7 '>      __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_blockCenters);<span class='error_goto'> if (unlikely(__pyx_t_19 == ((Py_ssize_t)-1))) __PYX_ERR(0, 662, __pyx_L13_error)</span>
      __pyx_t_2 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_t_19);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 662, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-0">&#xA0;<span class="">663</span>:                 replace=False,</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">664</span>:                 p=None</pre>
<pre class='cython code score-19 '>      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 3 : 0)] = {__pyx_t_1, __pyx_v_blockCenters};
        __pyx_t_31 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 660, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_size, __pyx_t_2, __pyx_t_31, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L13_error)</span>
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_replace, Py_False, __pyx_t_31, __pyx_callargs+2, 1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L13_error)</span>
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_p, Py_None, __pyx_t_31, __pyx_callargs+2, 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L13_error)</span>
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_Object_VectorcallMethod_CallFromBuilder</span>(__pyx_mstate_global-&gt;__pyx_n_u_choice, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_31);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      __pyx_t_3 = __pyx_t_7;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_tolist, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">665</span>:             ).tolist()</pre>
<pre class='cython code score-8 '>      if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))||((__pyx_t_6) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("list", __pyx_t_6))) <span class='error_goto'>__PYX_ERR(0, 665, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_blockCenters, ((PyObject*)__pyx_t_6));
      __pyx_t_6 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">666</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">667</span>:         bestLags = []</pre>
<pre class='cython code score-5 '>    __pyx_t_6 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L13_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_v_bestLags = ((PyObject*)__pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">668</span>:         blockHalf = blockSize // 2</pre>
<pre class='cython code score-0 '>    __pyx_v_blockHalf = (__pyx_v_blockSize / 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">669</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">670</span>:         for idxVal in blockCenters:</pre>
<pre class='cython code score-20 '>    if (unlikely(__pyx_v_blockCenters == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L13_error)</span>
    }
    __pyx_t_6 = __pyx_v_blockCenters; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
    __pyx_t_19 = 0;
    for (;;) {
      {
        Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_6);
        #if !CYTHON_ASSUME_SAFE_SIZE
        if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L13_error)</span>
        #endif
        if (__pyx_t_19 &gt;= __pyx_temp) break;
      }
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_6, __pyx_t_19);
      ++__pyx_t_19;
      if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_7); if (unlikely((__pyx_t_14 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 670, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_idxVal = __pyx_t_14;
/* … */
      __pyx_L36_continue:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L57_for_end;
    __pyx_L37_break:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    goto __pyx_L57_for_end;
    __pyx_L57_for_end:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">671</span>:             # this should map back to genomic coordinates</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">672</span>:             blockStartBP = start + idxVal * rollingChunkSize + (rollingChunkSize // 2) - blockHalf</pre>
<pre class='cython code score-0 '>      __pyx_v_blockStartBP = (((__pyx_v_start + (__pyx_v_idxVal * __pyx_v_rollingChunkSize)) + (__pyx_v_rollingChunkSize / 2)) - __pyx_v_blockHalf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:             if blockStartBP &lt; start:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_blockStartBP &lt; __pyx_v_start);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">674</span>:                 blockStartBP = start</pre>
<pre class='cython code score-0 '>        __pyx_v_blockStartBP = __pyx_v_start;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:             blockEndBP = blockStartBP + blockSize</pre>
<pre class='cython code score-0 '>      __pyx_v_blockEndBP = (__pyx_v_blockStartBP + __pyx_v_blockSize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">676</span>:             if blockEndBP &gt; end:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_blockEndBP &gt; __pyx_v_end);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">677</span>:                 blockEndBP = end</pre>
<pre class='cython code score-0 '>        __pyx_v_blockEndBP = __pyx_v_end;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">678</span>:                 blockStartBP = blockEndBP - blockSize</pre>
<pre class='cython code score-0 '>        __pyx_v_blockStartBP = (__pyx_v_blockEndBP - __pyx_v_blockSize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">679</span>:                 if blockStartBP &lt; start:</pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_blockStartBP &lt; __pyx_v_start);
        if (__pyx_t_11) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">680</span>:                     continue</pre>
<pre class='cython code score-0 '>          goto __pyx_L36_continue;
</pre><pre class="cython line score-0">&#xA0;<span class="">681</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">682</span>:             # now we build strand-specific tracks over each block</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">683</span>:             fwd.fill(0.0)</pre>
<pre class='cython code score-5 '>      __pyx_t_3 = ((PyObject *)__pyx_v_fwd);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_float_0_0};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fill, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 683, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">684</span>:             fwdDiff.fill(0.0)</pre>
<pre class='cython code score-5 '>      __pyx_t_3 = ((PyObject *)__pyx_v_fwdDiff);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_float_0_0};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fill, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 684, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">685</span>:             rev.fill(0.0)</pre>
<pre class='cython code score-5 '>      __pyx_t_3 = ((PyObject *)__pyx_v_rev);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_float_0_0};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fill, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 685, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">686</span>:             revDiff.fill(0.0)</pre>
<pre class='cython code score-5 '>      __pyx_t_3 = ((PyObject *)__pyx_v_revDiff);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_mstate_global-&gt;__pyx_float_0_0};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fill, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 686, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">687</span>:             readFlag = -1</pre>
<pre class='cython code score-0 '>      __pyx_v_readFlag = -1;
</pre><pre class="cython line score-0">&#xA0;<span class="">688</span>: </pre>
<pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">689</span>:             for read_ in aln.fetch(chromosome, blockStartBP, blockEndBP):</pre>
<pre class='cython code score-57 '>      __pyx_t_3 = ((PyObject *)__pyx_v_aln);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_4 = __Pyx_PyLong_From_int64_t(__pyx_v_blockStartBP);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_31 = __Pyx_PyLong_From_int64_t(__pyx_v_blockEndBP);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 689, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_3, __pyx_v_chromosome, __pyx_t_4, __pyx_t_31};
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_fetch, __pyx_callargs+__pyx_t_5, (4-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
        if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      }
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_7)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_7)) {
        __pyx_t_31 = __pyx_t_7; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_31);
        __pyx_t_32 = 0;
        __pyx_t_20 = NULL;
      } else {
        __pyx_t_32 = -1; __pyx_t_31 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 689, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
        __pyx_t_20 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_31);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 689, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      for (;;) {
        if (likely(!__pyx_t_20)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_31))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_31);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L13_error)</span>
              #endif
              if (__pyx_t_32 &gt;= __pyx_temp) break;
            }
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_31, __pyx_t_32);
            ++__pyx_t_32;
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_31);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L13_error)</span>
              #endif
              if (__pyx_t_32 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_31, __pyx_t_32));
            #else
            __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_31, __pyx_t_32);
            #endif
            ++__pyx_t_32;
          }
          if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L13_error)</span>
        } else {
          __pyx_t_7 = __pyx_t_20(__pyx_t_31);
          if (unlikely(!__pyx_t_7)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L13_error)</span>
              <span class='py_c_api'>PyErr_Clear</span>();
            }
            break;
          }
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (!(likely(((__pyx_t_7) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_7, __pyx_mstate_global-&gt;__pyx_ptype_5pysam_18libcalignedsegment_AlignedSegment))))) <span class='error_goto'>__PYX_ERR(0, 689, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_read_, ((struct __pyx_obj_5pysam_18libcalignedsegment_AlignedSegment *)__pyx_t_7));
        __pyx_t_7 = 0;
/* … */
        __pyx_L41_continue:;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">690</span>:                 readFlag = read_.flag</pre>
<pre class='cython code score-10 '>        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_flag);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 690, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_7); if (unlikely((__pyx_t_14 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 690, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_v_readFlag = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">691</span>:                 if (readFlag &amp; samFlagExclude) != 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_11 = ((__pyx_v_readFlag &amp; __pyx_v_samFlagExclude) != 0);
        if (__pyx_t_11) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">692</span>:                     continue</pre>
<pre class='cython code score-0 '>          goto __pyx_L41_continue;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">693</span>:                 readStart = min(read_.reference_start, read_.reference_end)</pre>
<pre class='cython code score-22 '>        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_end);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 693, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 693, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
        __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_7, __pyx_t_4, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 693, __pyx_L13_error)</span>
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 693, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (__pyx_t_11) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          __pyx_t_3 = __pyx_t_7;
        } else {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
          __pyx_t_3 = __pyx_t_4;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        __pyx_t_8 = __Pyx_PyLong_As_int64_t(__pyx_t_3); if (unlikely((__pyx_t_8 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 693, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_v_readStart = __pyx_t_8;
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">694</span>:                 readEnd = max(read_.reference_start, read_.reference_end)</pre>
<pre class='cython code score-22 '>        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_end);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 694, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_read_), __pyx_mstate_global-&gt;__pyx_n_u_reference_start);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 694, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_7, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 694, __pyx_L13_error)</span>
        __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely((__pyx_t_11 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 694, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (__pyx_t_11) {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          __pyx_t_4 = __pyx_t_3;
        } else {
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          __pyx_t_4 = __pyx_t_7;
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_t_8 = __Pyx_PyLong_As_int64_t(__pyx_t_4); if (unlikely((__pyx_t_8 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 694, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        __pyx_v_readEnd = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">695</span>:                 diffS = readStart - blockStartBP</pre>
<pre class='cython code score-0 '>        __pyx_v_diffS = (__pyx_v_readStart - __pyx_v_blockStartBP);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">696</span>:                 diffE = readEnd - blockStartBP</pre>
<pre class='cython code score-0 '>        __pyx_v_diffE = (__pyx_v_readEnd - __pyx_v_blockStartBP);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">697</span>:                 strand = readFlag &amp; 16</pre>
<pre class='cython code score-0 '>        __pyx_v_strand = (__pyx_v_readFlag &amp; 16);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">698</span>:                 if readStart &lt; blockStartBP or readEnd &gt; blockEndBP:</pre>
<pre class='cython code score-0 '>        __pyx_t_15 = (__pyx_v_readStart &lt; __pyx_v_blockStartBP);
        if (!__pyx_t_15) {
        } else {
          __pyx_t_11 = __pyx_t_15;
          goto __pyx_L45_bool_binop_done;
        }
        __pyx_t_15 = (__pyx_v_readEnd &gt; __pyx_v_blockEndBP);
        __pyx_t_11 = __pyx_t_15;
        __pyx_L45_bool_binop_done:;
        if (__pyx_t_11) {
/* … */
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">699</span>:                     continue</pre>
<pre class='cython code score-0 '>          goto __pyx_L41_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">700</span>:                 posInBlock = readStart - blockStartBP</pre>
<pre class='cython code score-0 '>        __pyx_v_posInBlock = (__pyx_v_readStart - __pyx_v_blockStartBP);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">701</span>:                 if strand == 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_11 = (__pyx_v_strand == 0);
        if (__pyx_t_11) {
/* … */
          goto __pyx_L47;
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">702</span>:                     # forward</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">703</span>:                     fwdDiff[diffS] += 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_diffS;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_fwdDiff.diminfo[0].strides) += 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">704</span>:                     fwdDiff[diffE] -= 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_diffE;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_fwdDiff.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_fwdDiff.diminfo[0].strides) -= 1.0;
</pre><pre class="cython line score-0">&#xA0;<span class="">705</span>:                 else:</pre>
<pre class="cython line score-0">&#xA0;<span class="">706</span>:                     # reverse</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">707</span>:                     revDiff[diffS] += 1.0</pre>
<pre class='cython code score-0 '>        /*else*/ {
          __pyx_t_21 = __pyx_v_diffS;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_revDiff.diminfo[0].strides) += 1.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">708</span>:                     revDiff[diffE] -= 1.0</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_diffE;
          *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_revDiff.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_revDiff.diminfo[0].strides) -= 1.0;
        }
        __pyx_L47:;
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">709</span>:             fwd = np.cumsum(fwdDiff[:len(fwdDiff)-1], dtype=np.float64)</pre>
<pre class='cython code score-71 '>      __pyx_t_4 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_32 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_fwdDiff));<span class='error_goto'> if (unlikely(__pyx_t_32 == ((Py_ssize_t)-1))) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      __pyx_t_3 = <span class='py_c_api'>PyLong_FromSsize_t</span>((__pyx_t_32 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_2 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_3, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_fwdDiff), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        assert(__pyx_t_4);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_t_3};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 709, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_1, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L13_error)</span>
        __pyx_t_31 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_7, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_31)) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      }
      if (!(likely(((__pyx_t_31) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_31, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L13_error)</span>
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_31), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_14 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_fwd, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
          }
          __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
        }
        __pyx_pybuffernd_fwd.diminfo[0].strides = __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_fwd.diminfo[0].shape = __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 709, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fwd, ((PyArrayObject *)__pyx_t_31));
      __pyx_t_31 = 0;
</pre><pre class="cython line score-71" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">710</span>:             rev = np.cumsum(revDiff[:len(revDiff)-1], dtype=np.float64)</pre>
<pre class='cython code score-71 '>      __pyx_t_7 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_cumsum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_32 = <span class='py_c_api'>PyObject_Length</span>(((PyObject *)__pyx_v_revDiff));<span class='error_goto'> if (unlikely(__pyx_t_32 == ((Py_ssize_t)-1))) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      __pyx_t_2 = <span class='py_c_api'>PyLong_FromSsize_t</span>((__pyx_t_32 - 1));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_3 = <span class='py_c_api'>PySlice_New</span>(Py_None, __pyx_t_2, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_revDiff), __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        assert(__pyx_t_7);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_7, __pyx_t_2};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 710, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_4, __pyx_t_3, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L13_error)</span>
        __pyx_t_31 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_31)) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      }
      if (!(likely(((__pyx_t_31) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_31, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L13_error)</span>
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_31), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_14 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_rev, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
          }
          __pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;
        }
        __pyx_pybuffernd_rev.diminfo[0].strides = __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rev.diminfo[0].shape = __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 710, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rev, ((PyArrayObject *)__pyx_t_31));
      __pyx_t_31 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">711</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">712</span>:             # maximizes the crossCovar(forward, reverse, lag) wrt lag.</pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">713</span>:             fwd = (fwd - np.mean(fwd))</pre>
<pre class='cython code score-46 '>      __pyx_t_1 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 713, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_n_u_mean);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        assert(__pyx_t_1);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_1, ((PyObject *)__pyx_v_fwd)};
        __pyx_t_31 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_4, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        if (unlikely(!__pyx_t_31)) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      }
      __pyx_t_4 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_fwd), __pyx_t_31);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 713, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
      if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L13_error)</span>
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_4), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_14 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_fwd, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
          }
          __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
        }
        __pyx_pybuffernd_fwd.diminfo[0].strides = __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_fwd.diminfo[0].shape = __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 713, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fwd, ((PyArrayObject *)__pyx_t_4));
      __pyx_t_4 = 0;
</pre><pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">714</span>:             rev = (rev - np.mean(rev))</pre>
<pre class='cython code score-46 '>      __pyx_t_31 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 714, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_n_u_mean);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_31 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        assert(__pyx_t_31);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_31);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_31, ((PyObject *)__pyx_v_rev)};
        __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_4)) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      }
      __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(((PyObject *)__pyx_v_rev), __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 714, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L13_error)</span>
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_3), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_14 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_rev, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_18); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
          }
          __pyx_t_18 = __pyx_t_17 = __pyx_t_16 = 0;
        }
        __pyx_pybuffernd_rev.diminfo[0].strides = __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_rev.diminfo[0].shape = __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 714, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_rev, ((PyArrayObject *)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">715</span>:             maxValidLag = maxInsertSize if (maxInsertSize &lt; blockSize) else (blockSize - 1)</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_maxInsertSize &lt; __pyx_v_blockSize);
      if (__pyx_t_11) {
        __pyx_t_8 = __pyx_v_maxInsertSize;
      } else {
        __pyx_t_8 = (__pyx_v_blockSize - 1);
      }
      __pyx_v_maxValidLag = __pyx_t_8;
</pre><pre class="cython line score-52" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">716</span>:             xCorr = np.zeros(maxInsertSize + 1, dtype=np.float64)</pre>
<pre class='cython code score-52 '>      __pyx_t_4 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_31, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 716, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_31, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
      __pyx_t_31 = __Pyx_PyLong_From_int64_t((__pyx_v_maxInsertSize + 1));<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 716, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 716, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_float64);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 716, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        assert(__pyx_t_4);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_4, __pyx_t_31};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 716, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_7, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 716, __pyx_L13_error)</span>
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_1, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 716, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      }
      if (!(likely(((__pyx_t_3) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_3, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 716, __pyx_L13_error)</span>
      {
        __Pyx_BufFmt_StackElem __pyx_stack[1];
        <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_3), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack);
        if (unlikely(__pyx_t_14 &lt; 0)) {
          <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
          if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_xCorr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
            Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_18);
            <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
          } else {
            <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
          }
          __pyx_t_16 = __pyx_t_17 = __pyx_t_18 = 0;
        }
        __pyx_pybuffernd_xCorr.diminfo[0].strides = __pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_xCorr.diminfo[0].shape = __pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer.shape[0];
        if (unlikely((__pyx_t_14 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 716, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_xCorr, ((PyArrayObject *)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-66" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">717</span>:             for lag in range(minInsertSize, maxValidLag + 1, lagStep):</pre>
<pre class='cython code score-66 '>      __pyx_t_1 = NULL;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_range);
      __pyx_t_2 = __pyx_builtin_range; 
      __pyx_t_7 = __Pyx_PyLong_From_int64_t(__pyx_v_minInsertSize);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 717, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_31 = <span class='pyx_c_api'>__Pyx_PyLong_From_long</span>((__pyx_v_maxValidLag + 1));<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 717, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      __pyx_t_4 = __Pyx_PyLong_From_int64_t(__pyx_v_lagStep);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 717, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_5 = 1;
      {
        PyObject *__pyx_callargs[4] = {__pyx_t_1, __pyx_t_7, __pyx_t_31, __pyx_t_4};
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_2, __pyx_callargs+__pyx_t_5, (4-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      }
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_3)) {
        __pyx_t_2 = __pyx_t_3; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        __pyx_t_32 = 0;
        __pyx_t_20 = NULL;
      } else {
        __pyx_t_32 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_20 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_20)) __PYX_ERR(0, 717, __pyx_L13_error)</span>
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      for (;;) {
        if (likely(!__pyx_t_20)) {
          if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L13_error)</span>
              #endif
              if (__pyx_t_32 &gt;= __pyx_temp) break;
            }
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_2, __pyx_t_32);
            ++__pyx_t_32;
          } else {
            {
              Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_2);
              #if !CYTHON_ASSUME_SAFE_SIZE
              if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L13_error)</span>
              #endif
              if (__pyx_t_32 &gt;= __pyx_temp) break;
            }
            #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_32));
            #else
            __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_2, __pyx_t_32);
            #endif
            ++__pyx_t_32;
          }
          if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L13_error)</span>
        } else {
          __pyx_t_3 = __pyx_t_20(__pyx_t_2);
          if (unlikely(!__pyx_t_3)) {
            PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
            if (exc_type) {
              if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L13_error)</span>
              <span class='py_c_api'>PyErr_Clear</span>();
            }
            break;
          }
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_14 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        __pyx_v_lag = __pyx_t_14;
/* … */
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">718</span>:                 score = 0.0</pre>
<pre class='cython code score-0 '>        __pyx_v_score = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">719</span>:                 for i in range(blockSize - lag):</pre>
<pre class='cython code score-0 '>        __pyx_t_8 = (__pyx_v_blockSize - __pyx_v_lag);
        __pyx_t_10 = __pyx_t_8;
        for (__pyx_t_14 = 0; __pyx_t_14 &lt; __pyx_t_10; __pyx_t_14+=1) {
          __pyx_v_i = __pyx_t_14;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">720</span>:                     score += fwd[i] * rev[i + lag]</pre>
<pre class='cython code score-0 '>          __pyx_t_21 = __pyx_v_i;
          __pyx_t_33 = (__pyx_v_i + __pyx_v_lag);
          __pyx_v_score = (__pyx_v_score + ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_fwd.rcbuffer-&gt;pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_fwd.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rev.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_rev.diminfo[0].strides))));
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">721</span>:                 xCorr[lag] = score</pre>
<pre class='cython code score-0 '>        __pyx_t_33 = __pyx_v_lag;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_xCorr.rcbuffer-&gt;pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_xCorr.diminfo[0].strides) = __pyx_v_score;
</pre><pre class="cython line score-0">&#xA0;<span class="">722</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">723</span>:             if maxValidLag &lt; minInsertSize:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_maxValidLag &lt; __pyx_v_minInsertSize);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:                 continue</pre>
<pre class='cython code score-0 '>        goto __pyx_L36_continue;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">725</span>:             chosenLag = -1</pre>
<pre class='cython code score-0 '>      __pyx_v_chosenLag = -1;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:             chosenLag = int(np.argmax(xCorr[minInsertSize:maxValidLag + 1])) + minInsertSize</pre>
<pre class='cython code score-50 '>      __pyx_t_3 = NULL;
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_31 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_mstate_global-&gt;__pyx_n_u_argmax);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = __Pyx_PyLong_From_int64_t(__pyx_v_minInsertSize);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyLong_From_long</span>((__pyx_v_maxValidLag + 1));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='py_c_api'>PySlice_New</span>(__pyx_t_4, __pyx_t_7, Py_None);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(((PyObject *)__pyx_v_xCorr), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_5 = 1;
      #if CYTHON_UNPACK_METHODS
      if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_31))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_31);
        assert(__pyx_t_3);
        PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_31);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_31, __pyx__function);
        __pyx_t_5 = 0;
      }
      #endif
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, __pyx_t_7};
        __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_31, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
        if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      }
      __pyx_t_31 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = __Pyx_PyLong_From_int64_t(__pyx_v_minInsertSize);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_31, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(__pyx_t_7); if (unlikely((__pyx_t_14 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L13_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_v_chosenLag = __pyx_t_14;
</pre><pre class="cython line score-0">&#xA0;<span class="">727</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">728</span>:             if chosenLag &gt; 0:</pre>
<pre class='cython code score-0 '>      __pyx_t_11 = (__pyx_v_chosenLag &gt; 0);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">729</span>:                 bestLags.append(chosenLag)</pre>
<pre class='cython code score-5 '>        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyLong_From_int</span>(__pyx_v_chosenLag);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 729, __pyx_L13_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_30 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_bestLags, __pyx_t_7);<span class='error_goto'> if (unlikely(__pyx_t_30 == ((int)-1))) __PYX_ERR(0, 729, __pyx_L13_error)</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">730</span>:             if len(bestLags) &gt;= earlyExit:</pre>
<pre class='cython code score-2 '>      __pyx_t_32 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_bestLags);<span class='error_goto'> if (unlikely(__pyx_t_32 == ((Py_ssize_t)-1))) __PYX_ERR(0, 730, __pyx_L13_error)</span>
      __pyx_t_11 = (__pyx_t_32 &gt;= __pyx_v_earlyExit);
      if (__pyx_t_11) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">731</span>:                 break</pre>
<pre class='cython code score-0 '>        goto __pyx_L37_break;
</pre><pre class="cython line score-0">&#xA0;<span class="">732</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">733</span>:     finally:</pre>
<pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">734</span>:         aln.close()</pre>
<pre class='cython code score-32 '>  /*finally:*/ {
    /*normal exit:*/{
      __pyx_t_7 = ((PyObject *)__pyx_v_aln);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      __pyx_t_5 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_7, NULL};
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      goto __pyx_L14;
    }
    __pyx_L13_error:;
    /*exception exit:*/{
      __Pyx_PyThreadState_declare
      __Pyx_PyThreadState_assign
      __pyx_t_18 = 0; __pyx_t_17 = 0; __pyx_t_16 = 0; __pyx_t_35 = 0; __pyx_t_36 = 0; __pyx_t_37 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_22, 1);
      __pyx_t_22.memview = NULL; __pyx_t_22.data = NULL;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
       <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_35, &amp;__pyx_t_36, &amp;__pyx_t_37);
      if ( unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_18, &amp;__pyx_t_17, &amp;__pyx_t_16);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_35);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_36);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_37);
      __pyx_t_14 = __pyx_lineno; __pyx_t_23 = __pyx_clineno; __pyx_t_34 = __pyx_filename;
      {
        __pyx_t_7 = ((PyObject *)__pyx_v_aln);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        __pyx_t_5 = 0;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_7, NULL};
          __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_5, (1-__pyx_t_5) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L59_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_35);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_36);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_37);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_35, __pyx_t_36, __pyx_t_37);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_18, __pyx_t_17, __pyx_t_16);
      __pyx_t_18 = 0; __pyx_t_17 = 0; __pyx_t_16 = 0; __pyx_t_35 = 0; __pyx_t_36 = 0; __pyx_t_37 = 0;
      __pyx_lineno = __pyx_t_14; __pyx_clineno = __pyx_t_23; __pyx_filename = __pyx_t_34;
      goto __pyx_L1_error;
      __pyx_L59_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_35);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_36);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_37);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_35, __pyx_t_36, __pyx_t_37);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      __pyx_t_35 = 0; __pyx_t_36 = 0; __pyx_t_37 = 0;
      goto __pyx_L1_error;
    }
    __pyx_L14:;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">735</span>: </pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:     if len(bestLags) &lt; 3:</pre>
<pre class='cython code score-2 '>  __pyx_t_19 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_bestLags);<span class='error_goto'> if (unlikely(__pyx_t_19 == ((Py_ssize_t)-1))) __PYX_ERR(0, 736, __pyx_L1_error)</span>
  __pyx_t_11 = (__pyx_t_19 &lt; 3);
  if (__pyx_t_11) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">737</span>:         return fallBack</pre>
<pre class='cython code score-0 '>    __pyx_r = __pyx_v_fallBack;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">738</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">739</span>:     bestLagsArr = np.asarray(bestLags, dtype=np.uint32)</pre>
<pre class='cython code score-50 '>  __pyx_t_7 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_31 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_31)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_31);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_uint32);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_31))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_31);
    assert(__pyx_t_7);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_31);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_31, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_7, __pyx_v_bestLags};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_3, __pyx_t_2, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_31, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  }
  if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer);
    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_23 &lt; 0)) {
      <span class='py_c_api'>PyErr_Fetch</span>(&amp;__pyx_t_37, &amp;__pyx_t_36, &amp;__pyx_t_35);
      if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_bestLagsArr, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_37); Py_XDECREF(__pyx_t_36); Py_XDECREF(__pyx_t_35);
        <span class='pyx_c_api'>__Pyx_RaiseBufferFallbackError</span>();
      } else {
        <span class='py_c_api'>PyErr_Restore</span>(__pyx_t_37, __pyx_t_36, __pyx_t_35);
      }
      __pyx_t_37 = __pyx_t_36 = __pyx_t_35 = 0;
    }
    __pyx_pybuffernd_bestLagsArr.diminfo[0].strides = __pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_bestLagsArr.diminfo[0].shape = __pyx_pybuffernd_bestLagsArr.rcbuffer-&gt;pybuffer.shape[0];
    if (unlikely((__pyx_t_23 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 739, __pyx_L1_error)</span>
  }
  __pyx_v_bestLagsArr = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">740</span>:     med = int(np.median(bestLagsArr))</pre>
<pre class='cython code score-28 '>  __pyx_t_31 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_median);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_5 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_31 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    assert(__pyx_t_31);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_31);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, __pyx__function);
    __pyx_t_5 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2] = {__pyx_t_31, ((PyObject *)__pyx_v_bestLagsArr)};
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_5, (2-__pyx_t_5) | (__pyx_t_5*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_31); __pyx_t_31 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 740, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_8 = __Pyx_PyLong_As_int64_t(__pyx_t_3); if (unlikely((__pyx_t_8 == ((int64_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 740, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_med = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">741</span>:     if med &lt; minInsertSize:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_med &lt; __pyx_v_minInsertSize);
  if (__pyx_t_11) {
/* … */
    goto __pyx_L61;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">742</span>:         med = &lt;int&gt;minInsertSize</pre>
<pre class='cython code score-0 '>    __pyx_v_med = ((int)__pyx_v_minInsertSize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">743</span>:     elif med &gt; maxInsertSize:</pre>
<pre class='cython code score-0 '>  __pyx_t_11 = (__pyx_v_med &gt; __pyx_v_maxInsertSize);
  if (__pyx_t_11) {
/* … */
  }
  __pyx_L61:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">744</span>:         med = &lt;int&gt;maxInsertSize</pre>
<pre class='cython code score-0 '>    __pyx_v_med = ((int)__pyx_v_maxInsertSize);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">745</span>:     return med</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_med;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">746</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">747</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">748</span>: cdef inline Py_ssize_t getInsertion(const uint32_t* array_, Py_ssize_t n, uint32_t x) nogil:</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE Py_ssize_t __pyx_f_10consenrich_11cconsenrich_getInsertion(uint32_t const *__pyx_v_array_, Py_ssize_t __pyx_v_n, uint32_t __pyx_v_x) {
  Py_ssize_t __pyx_v_low;
  Py_ssize_t __pyx_v_high;
  Py_ssize_t __pyx_v_midpt;
  Py_ssize_t __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">749</span>:     # helper: binary search to find insertion point into sorted `arrray_`</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">750</span>:     cdef Py_ssize_t low = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_low = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">751</span>:     cdef Py_ssize_t high = n</pre>
<pre class='cython code score-0 '>  __pyx_v_high = __pyx_v_n;
</pre><pre class="cython line score-0">&#xA0;<span class="">752</span>:     cdef Py_ssize_t midpt</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">753</span>:     while low &lt; high:</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_low &lt; __pyx_v_high);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">754</span>:         midpt = low + ((high - low) &gt;&gt; 1)</pre>
<pre class='cython code score-0 '>    __pyx_v_midpt = (__pyx_v_low + ((__pyx_v_high - __pyx_v_low) &gt;&gt; 1));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:         if array_[midpt] &lt;= x:</pre>
<pre class='cython code score-0 '>    __pyx_t_1 = ((__pyx_v_array_[__pyx_v_midpt]) &lt;= __pyx_v_x);
    if (__pyx_t_1) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">756</span>:             low = midpt + 1</pre>
<pre class='cython code score-0 '>      __pyx_v_low = (__pyx_v_midpt + 1);
</pre><pre class="cython line score-0">&#xA0;<span class="">757</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">758</span>:             high = midpt</pre>
<pre class='cython code score-0 '>    /*else*/ {
      __pyx_v_high = __pyx_v_midpt;
    }
    __pyx_L5:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">759</span>:     return low</pre>
<pre class='cython code score-0 '>  __pyx_r = __pyx_v_low;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">760</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">761</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">762</span>: cdef int maskMembership(const uint32_t* pos, Py_ssize_t numIntervals, const uint32_t* mStarts, const uint32_t* mEnds, Py_ssize_t n, uint8_t* outMask) nogil:</pre>
<pre class='cython code score-6 '>static int __pyx_f_10consenrich_11cconsenrich_maskMembership(uint32_t const *__pyx_v_pos, Py_ssize_t __pyx_v_numIntervals, uint32_t const *__pyx_v_mStarts, uint32_t const *__pyx_v_mEnds, Py_ssize_t __pyx_v_n, uint8_t *__pyx_v_outMask) {
  Py_ssize_t __pyx_v_i;
  Py_ssize_t __pyx_v_k;
  uint32_t __pyx_v_p;
  int __pyx_r;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  __pyx_gilstate_save = <span class='pyx_c_api'>__Pyx_PyGILState_Ensure</span>();
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.maskMembership", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  <span class='pyx_c_api'>__Pyx_PyGILState_Release</span>(__pyx_gilstate_save);
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">763</span>:     cdef Py_ssize_t i = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_i = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">764</span>:     cdef Py_ssize_t k</pre>
<pre class="cython line score-0">&#xA0;<span class="">765</span>:     cdef uint32_t p</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">766</span>:     while i &lt; numIntervals:</pre>
<pre class='cython code score-0 '>  while (1) {
    __pyx_t_1 = (__pyx_v_i &lt; __pyx_v_numIntervals);
    if (!__pyx_t_1) break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">767</span>:         p = pos[i]</pre>
<pre class='cython code score-0 '>    __pyx_v_p = (__pyx_v_pos[__pyx_v_i]);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">768</span>:         k = getInsertion(mStarts, n, p) - 1</pre>
<pre class='cython code score-2 '>    __pyx_t_2 = __pyx_f_10consenrich_11cconsenrich_getInsertion(__pyx_v_mStarts, __pyx_v_n, __pyx_v_p); if (unlikely(__pyx_t_2 == ((Py_ssize_t)-1) &amp;&amp; <span class='pyx_c_api'>__Pyx_ErrOccurredWithGIL</span>())) <span class='error_goto'>__PYX_ERR(0, 768, __pyx_L1_error)</span>
    __pyx_v_k = (__pyx_t_2 - 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">769</span>:         if k &gt;= 0 and p &lt; mEnds[k]:</pre>
<pre class='cython code score-0 '>    __pyx_t_3 = (__pyx_v_k &gt;= 0);
    if (__pyx_t_3) {
    } else {
      __pyx_t_1 = __pyx_t_3;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_3 = (__pyx_v_p &lt; (__pyx_v_mEnds[__pyx_v_k]));
    __pyx_t_1 = __pyx_t_3;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_1) {
/* … */
      goto __pyx_L5;
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">770</span>:             outMask[i] = &lt;uint8_t&gt;1</pre>
<pre class='cython code score-0 '>      (__pyx_v_outMask[__pyx_v_i]) = ((uint8_t)1);
</pre><pre class="cython line score-0">&#xA0;<span class="">771</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">772</span>:             outMask[i] = &lt;uint8_t&gt;0</pre>
<pre class='cython code score-0 '>    /*else*/ {
      (__pyx_v_outMask[__pyx_v_i]) = ((uint8_t)0);
    }
    __pyx_L5:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">773</span>:         i += 1</pre>
<pre class='cython code score-0 '>    __pyx_v_i = (__pyx_v_i + 1);
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">774</span>:     return 0</pre>
<pre class='cython code score-0 '>  __pyx_r = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">775</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">776</span>: </pre>
<pre class="cython line score-97" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">777</span>: cpdef cnp.ndarray[cnp.uint8_t, ndim=1] cbedMask(</pre>
<pre class='cython code score-97 '>static PyObject *__pyx_pw_10consenrich_11cconsenrich_25cbedMask(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
static PyArrayObject *__pyx_f_10consenrich_11cconsenrich_cbedMask(PyObject *__pyx_v_chromosome, PyObject *__pyx_v_bedFile, PyArrayObject *__pyx_v_intervals, CYTHON_UNUSED int __pyx_v_stepSize, CYTHON_UNUSED int __pyx_skip_dispatch) {
  PyObject *__pyx_v_startsList = 0;
  PyObject *__pyx_v_endsList = 0;
  PyObject *__pyx_v_f = 0;
  PyObject *__pyx_v_line = 0;
  PyObject *__pyx_v_cols = 0;
  Py_ssize_t __pyx_v_numIntervals;
  PyArrayObject *__pyx_v_mask = 0;
  PyArrayObject *__pyx_v_starts = 0;
  PyArrayObject *__pyx_v_ends = 0;
  __Pyx_memviewslice __pyx_v_startsView = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_endsView = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_posView = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_outView = { 0, 0, { 0 }, { 0 }, { 0 } };
  uint32_t *__pyx_v_svPtr;
  uint32_t *__pyx_v_evPtr;
  uint32_t *__pyx_v_posPtr;
  uint8_t *__pyx_v_outPtr;
  Py_ssize_t __pyx_v_n;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ends;
  __Pyx_Buffer __pyx_pybuffer_ends;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_intervals;
  __Pyx_Buffer __pyx_pybuffer_intervals;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_mask;
  __Pyx_Buffer __pyx_pybuffer_mask;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_starts;
  __Pyx_Buffer __pyx_pybuffer_starts;
  PyArrayObject *__pyx_r = NULL;
  __pyx_pybuffer_mask.pybuffer.buf = NULL;
  __pyx_pybuffer_mask.refcount = 0;
  __pyx_pybuffernd_mask.data = NULL;
  __pyx_pybuffernd_mask.rcbuffer = &amp;__pyx_pybuffer_mask;
  __pyx_pybuffer_starts.pybuffer.buf = NULL;
  __pyx_pybuffer_starts.refcount = 0;
  __pyx_pybuffernd_starts.data = NULL;
  __pyx_pybuffernd_starts.rcbuffer = &amp;__pyx_pybuffer_starts;
  __pyx_pybuffer_ends.pybuffer.buf = NULL;
  __pyx_pybuffer_ends.refcount = 0;
  __pyx_pybuffernd_ends.data = NULL;
  __pyx_pybuffernd_ends.rcbuffer = &amp;__pyx_pybuffer_ends;
  __pyx_pybuffer_intervals.pybuffer.buf = NULL;
  __pyx_pybuffer_intervals.refcount = 0;
  __pyx_pybuffernd_intervals.data = NULL;
  __pyx_pybuffernd_intervals.rcbuffer = &amp;__pyx_pybuffer_intervals;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_intervals, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_intervals.diminfo[0].strides = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_intervals.diminfo[0].shape = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.shape[0];
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_23);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_25, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_t_26, 1);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_type, &amp;__pyx_value, &amp;__pyx_tb);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ends.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mask.rcbuffer-&gt;pybuffer);
    <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_starts.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_type, __pyx_value, __pyx_tb);}
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cbedMask", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_ends.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_mask.rcbuffer-&gt;pybuffer);
  <span class='pyx_c_api'>__Pyx_SafeReleaseBuffer</span>(&amp;__pyx_pybuffernd_starts.rcbuffer-&gt;pybuffer);
  __pyx_L2:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_startsList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_endsList);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_f);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_line);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cols);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_mask);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_starts);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_ends);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_startsView, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_endsView, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_posView, 1);
  __PYX_XCLEAR_MEMVIEW(&amp;__pyx_v_outView, 1);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_10consenrich_11cconsenrich_25cbedMask(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
); /*proto*/
<span class='py_macro_api'>PyDoc_STRVAR</span>(__pyx_doc_10consenrich_11cconsenrich_24cbedMask, "Return a 1/0 mask for intervals overlapping a sorted and merged BED file.\n\n    :param chromosome: Chromosome name.\n    :type chromosome: str\n    :param bedFile: Path to a sorted and merged BED file.\n    :type bedFile: str\n    :param intervals: Array of sorted, non-overlapping start positions of genomic intervals.\n      Each interval is assumed `stepSize`.\n    :type intervals: cnp.ndarray[cnp.uint32_t, ndim=1]\n    :param stepSize: Step size between genomic positions in `intervals`.\n    :type stepSize: int32_t\n    :return: A mask s.t. `1` indicates the corresponding interval overlaps a BED region.\n    :rtype: cnp.ndarray[cnp.uint8_t, ndim=1]\n\n    ");
static PyMethodDef __pyx_mdef_10consenrich_11cconsenrich_25cbedMask = {"cbedMask", (PyCFunction)(void(*)(void))(__Pyx_PyCFunction_FastCallWithKeywords)__pyx_pw_10consenrich_11cconsenrich_25cbedMask, __Pyx_METH_FASTCALL|METH_KEYWORDS, __pyx_doc_10consenrich_11cconsenrich_24cbedMask};
static PyObject *__pyx_pw_10consenrich_11cconsenrich_25cbedMask(PyObject *__pyx_self, 
#if CYTHON_METH_FASTCALL
PyObject *const *__pyx_args, Py_ssize_t __pyx_nargs, PyObject *__pyx_kwds
#else
PyObject *__pyx_args, PyObject *__pyx_kwds
#endif
) {
  PyObject *__pyx_v_chromosome = 0;
  PyObject *__pyx_v_bedFile = 0;
  PyArrayObject *__pyx_v_intervals = 0;
  int __pyx_v_stepSize;
  #if !CYTHON_METH_FASTCALL
  CYTHON_UNUSED Py_ssize_t __pyx_nargs;
  #endif
  CYTHON_UNUSED PyObject *const *__pyx_kwvalues;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cbedMask (wrapper)", 0);
  #if !CYTHON_METH_FASTCALL
  #if CYTHON_ASSUME_SAFE_SIZE
  __pyx_nargs = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
  #else
  __pyx_nargs = <span class='py_c_api'>PyTuple_Size</span>(__pyx_args); if (unlikely(__pyx_nargs &lt; 0)) return NULL;
  #endif
  #endif
  __pyx_kwvalues = <span class='pyx_c_api'>__Pyx_KwValues_FASTCALL</span>(__pyx_args, __pyx_nargs);
  {
    PyObject ** const __pyx_pyargnames[] = {&amp;__pyx_mstate_global-&gt;__pyx_n_u_chromosome,&amp;__pyx_mstate_global-&gt;__pyx_n_u_bedFile,&amp;__pyx_mstate_global-&gt;__pyx_n_u_intervals,&amp;__pyx_mstate_global-&gt;__pyx_n_u_stepSize,0};
  PyObject* values[4] = {0,0,0,0};
    const Py_ssize_t __pyx_kwds_len = (__pyx_kwds) ? <span class='pyx_c_api'>__Pyx_NumKwargs_FASTCALL</span>(__pyx_kwds) : 0;
    if (unlikely(__pyx_kwds_len) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
    if (__pyx_kwds_len &gt; 0) {
      switch (__pyx_nargs) {
        case  4:
        values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  3:
        values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  2:
        values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  1:
        values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
        if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      const Py_ssize_t kwd_pos_args = __pyx_nargs;
      if (<span class='pyx_c_api'>__Pyx_ParseKeywords</span>(__pyx_kwds, __pyx_kwvalues, __pyx_pyargnames, 0, values, kwd_pos_args, __pyx_kwds_len, "cbedMask", 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
      for (Py_ssize_t i = __pyx_nargs; i &lt; 4; i++) {
        if (unlikely(!values[i])) { <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cbedMask", 1, 4, 4, i); <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span> }
      }
    } else if (unlikely(__pyx_nargs != 4)) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 0);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[0])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
      values[1] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 1);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[1])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
      values[2] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 2);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[2])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
      values[3] = <span class='pyx_c_api'>__Pyx_ArgRef_FASTCALL</span>(__pyx_args, 3);
      if (!CYTHON_ASSUME_SAFE_MACROS &amp;&amp; unlikely(!values[3])) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
    }
    __pyx_v_chromosome = ((PyObject*)values[0]);
    __pyx_v_bedFile = ((PyObject*)values[1]);
    __pyx_v_intervals = ((PyArrayObject *)values[2]);
    __pyx_v_stepSize = <span class='pyx_c_api'>__Pyx_PyLong_As_int</span>(values[3]); if (unlikely((__pyx_v_stepSize == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 781, __pyx_L3_error)</span>
  }
  goto __pyx_L6_skip;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("cbedMask", 1, 4, 4, __pyx_nargs); <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L3_error)</span>
  __pyx_L6_skip:;
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("consenrich.cconsenrich.cbedMask", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_chromosome), (&amp;PyUnicode_Type), 1, "chromosome", 1))) <span class='error_goto'>__PYX_ERR(0, 778, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_bedFile), (&amp;PyUnicode_Type), 1, "bedFile", 1))) <span class='error_goto'>__PYX_ERR(0, 779, __pyx_L1_error)</span>
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_intervals), __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray, 1, "intervals", 0))) <span class='error_goto'>__PYX_ERR(0, 780, __pyx_L1_error)</span>
  __pyx_r = __pyx_pf_10consenrich_11cconsenrich_24cbedMask(__pyx_self, __pyx_v_chromosome, __pyx_v_bedFile, __pyx_v_intervals, __pyx_v_stepSize);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  goto __pyx_L7_cleaned_up;
  __pyx_L0:;
  for (Py_ssize_t __pyx_temp=0; __pyx_temp &lt; (Py_ssize_t)(sizeof(values)/sizeof(values[0])); ++__pyx_temp) {
    Py_XDECREF(values[__pyx_temp]);
  }
  __pyx_L7_cleaned_up:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_10consenrich_11cconsenrich_24cbedMask(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_chromosome, PyObject *__pyx_v_bedFile, PyArrayObject *__pyx_v_intervals, int __pyx_v_stepSize) {
  __Pyx_LocalBuf_ND __pyx_pybuffernd_intervals;
  __Pyx_Buffer __pyx_pybuffer_intervals;
  PyObject *__pyx_r = NULL;
  __pyx_pybuffer_intervals.pybuffer.buf = NULL;
  __pyx_pybuffer_intervals.refcount = 0;
  __pyx_pybuffernd_intervals.data = NULL;
  __pyx_pybuffernd_intervals.rcbuffer = &amp;__pyx_pybuffer_intervals;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer, (PyObject*)__pyx_v_intervals, &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
  }
  __pyx_pybuffernd_intervals.diminfo[0].strides = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_intervals.diminfo[0].shape = __pyx_pybuffernd_intervals.rcbuffer-&gt;pybuffer.shape[0];
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_10consenrich_11cconsenrich_cbedMask(__pyx_v_chromosome, __pyx_v_bedFile, __pyx_v_intervals, __pyx_v_stepSize, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_CyFunction_New</span>(&amp;__pyx_mdef_10consenrich_11cconsenrich_25cbedMask, 0, __pyx_mstate_global-&gt;__pyx_n_u_cbedMask, NULL, __pyx_mstate_global-&gt;__pyx_n_u_consenrich_cconsenrich, __pyx_mstate_global-&gt;__pyx_d, ((PyObject *)__pyx_mstate_global-&gt;__pyx_codeobj_tab[12]));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_mstate_global-&gt;__pyx_d, __pyx_mstate_global-&gt;__pyx_n_u_cbedMask, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">778</span>:     str chromosome,</pre>
<pre class="cython line score-0">&#xA0;<span class="">779</span>:     str bedFile,</pre>
<pre class="cython line score-0">&#xA0;<span class="">780</span>:     cnp.ndarray[cnp.uint32_t, ndim=1] intervals,</pre>
<pre class="cython line score-0">&#xA0;<span class="">781</span>:     int stepSize</pre>
<pre class="cython line score-0">&#xA0;<span class="">782</span>:     ):</pre>
<pre class="cython line score-0">&#xA0;<span class="">783</span>:     r"""Return a 1/0 mask for intervals overlapping a sorted and merged BED file.</pre>
<pre class="cython line score-0">&#xA0;<span class="">784</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">785</span>:     :param chromosome: Chromosome name.</pre>
<pre class="cython line score-0">&#xA0;<span class="">786</span>:     :type chromosome: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">787</span>:     :param bedFile: Path to a sorted and merged BED file.</pre>
<pre class="cython line score-0">&#xA0;<span class="">788</span>:     :type bedFile: str</pre>
<pre class="cython line score-0">&#xA0;<span class="">789</span>:     :param intervals: Array of sorted, non-overlapping start positions of genomic intervals.</pre>
<pre class="cython line score-0">&#xA0;<span class="">790</span>:       Each interval is assumed `stepSize`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">791</span>:     :type intervals: cnp.ndarray[cnp.uint32_t, ndim=1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">792</span>:     :param stepSize: Step size between genomic positions in `intervals`.</pre>
<pre class="cython line score-0">&#xA0;<span class="">793</span>:     :type stepSize: int32_t</pre>
<pre class="cython line score-0">&#xA0;<span class="">794</span>:     :return: A mask s.t. `1` indicates the corresponding interval overlaps a BED region.</pre>
<pre class="cython line score-0">&#xA0;<span class="">795</span>:     :rtype: cnp.ndarray[cnp.uint8_t, ndim=1]</pre>
<pre class="cython line score-0">&#xA0;<span class="">796</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">797</span>:     """</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">798</span>:     cdef list startsList = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 798, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_startsList = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">799</span>:     cdef list endsList = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 799, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_endsList = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">800</span>:     cdef object f = open(bedFile, "r")</pre>
<pre class='cython code score-5 '>  __pyx_t_2 = NULL;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_builtin_open);
  __pyx_t_3 = __pyx_builtin_open; 
  __pyx_t_4 = 1;
  {
    PyObject *__pyx_callargs[3] = {__pyx_t_2, __pyx_v_bedFile, __pyx_mstate_global-&gt;__pyx_n_u_r};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCall</span>(__pyx_t_3, __pyx_callargs+__pyx_t_4, (3-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 800, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  __pyx_v_f = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">801</span>:     cdef str line</pre>
<pre class="cython line score-0">&#xA0;<span class="">802</span>:     cdef list cols</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">803</span>:     try:</pre>
<pre class='cython code score-0 '>  /*try:*/ {
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">804</span>:         for line in f:</pre>
<pre class='cython code score-55 '>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_f)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_f)) {
      __pyx_t_1 = __pyx_v_f; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_6 = NULL;
    } else {
      __pyx_t_5 = -1; __pyx_t_1 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_f);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 804, __pyx_L4_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = (CYTHON_COMPILING_IN_LIMITED_API) ? PyIter_Next : <span class='pyx_c_api'>__Pyx_PyObject_GetIterNextFunc</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 804, __pyx_L4_error)</span>
    }
    for (;;) {
      if (likely(!__pyx_t_6)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))) {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L4_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyList_GetItemRef</span>(__pyx_t_1, __pyx_t_5);
          ++__pyx_t_5;
        } else {
          {
            Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyTuple_GET_SIZE</span>(__pyx_t_1);
            #if !CYTHON_ASSUME_SAFE_SIZE
            if (unlikely((__pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L4_error)</span>
            #endif
            if (__pyx_t_5 &gt;= __pyx_temp) break;
          }
          #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_NewRef</span>(<span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_1, __pyx_t_5));
          #else
          __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PySequence_ITEM</span>(__pyx_t_1, __pyx_t_5);
          #endif
          ++__pyx_t_5;
        }
        if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L4_error)</span>
      } else {
        __pyx_t_3 = __pyx_t_6(__pyx_t_1);
        if (unlikely(!__pyx_t_3)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (unlikely(!<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L4_error)</span>
            <span class='py_c_api'>PyErr_Clear</span>();
          }
          break;
        }
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      if (!(likely(<span class='py_c_api'>PyUnicode_CheckExact</span>(__pyx_t_3))||((__pyx_t_3) == Py_None) || <span class='pyx_c_api'>__Pyx_RaiseUnexpectedTypeError</span>("str", __pyx_t_3))) <span class='error_goto'>__PYX_ERR(0, 804, __pyx_L4_error)</span>
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_line, ((PyObject*)__pyx_t_3));
      __pyx_t_3 = 0;
/* … */
      __pyx_L6_continue:;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">805</span>:             line = line.strip()</pre>
<pre class='cython code score-1 '>      __pyx_t_3 = __Pyx_CallUnboundCMethod0(&amp;__pyx_mstate_global-&gt;__pyx_umethod_PyUnicode_Type__strip, __pyx_v_line);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 805, __pyx_L4_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_line, ((PyObject*)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">806</span>:             if not line or line[0] == '#':</pre>
<pre class='cython code score-4 '>      {
        Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyUnicode_IS_TRUE</span>(__pyx_v_line);
        if (unlikely(((!CYTHON_ASSUME_SAFE_SIZE) &amp;&amp; __pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 806, __pyx_L4_error)</span>
        __pyx_t_8 = (__pyx_temp != 0);
      }

      __pyx_t_9 = (!__pyx_t_8);
      if (!__pyx_t_9) {
      } else {
        __pyx_t_7 = __pyx_t_9;
        goto __pyx_L9_bool_binop_done;
      }
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_GetItemInt_Unicode</span>(__pyx_v_line, 0, long, 1, __Pyx_PyLong_From_long, 0, 0, 0, 1);<span class='error_goto'> if (unlikely(__pyx_t_10 == (Py_UCS4)-1)) __PYX_ERR(0, 806, __pyx_L4_error)</span>
      __pyx_t_9 = (__pyx_t_10 == 35);
      __pyx_t_7 = __pyx_t_9;
      __pyx_L9_bool_binop_done:;
      if (__pyx_t_7) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">807</span>:                 continue</pre>
<pre class='cython code score-0 '>        goto __pyx_L6_continue;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">808</span>:             cols = line.split('\t')</pre>
<pre class='cython code score-8 '>      __pyx_t_3 = <span class='py_c_api'>PyUnicode_Split</span>(__pyx_v_line, <span class='pyx_c_api'>__Pyx_NoneAsNull</span>(__pyx_mstate_global-&gt;__pyx_kp_u__6), -1L);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 808, __pyx_L4_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cols, ((PyObject*)__pyx_t_3));
      __pyx_t_3 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">809</span>:             if not cols or len(cols) &lt; 3:</pre>
<pre class='cython code score-4 '>      {
        Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_cols);
        if (unlikely(((!CYTHON_ASSUME_SAFE_SIZE) &amp;&amp; __pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 809, __pyx_L4_error)</span>
        __pyx_t_9 = (__pyx_temp != 0);
      }

      __pyx_t_8 = (!__pyx_t_9);
      if (!__pyx_t_8) {
      } else {
        __pyx_t_7 = __pyx_t_8;
        goto __pyx_L12_bool_binop_done;
      }
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_cols);<span class='error_goto'> if (unlikely(__pyx_t_11 == ((Py_ssize_t)-1))) __PYX_ERR(0, 809, __pyx_L4_error)</span>
      __pyx_t_8 = (__pyx_t_11 &lt; 3);
      __pyx_t_7 = __pyx_t_8;
      __pyx_L12_bool_binop_done:;
      if (__pyx_t_7) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">810</span>:                 continue</pre>
<pre class='cython code score-0 '>        goto __pyx_L6_continue;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">811</span>:             if cols[0] != chromosome:</pre>
<pre class='cython code score-4 '>      __pyx_t_7 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(<span class='pyx_c_api'>__Pyx_PyList_GET_ITEM</span>(__pyx_v_cols, 0), __pyx_v_chromosome, Py_NE)); if (unlikely((__pyx_t_7 &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 811, __pyx_L4_error)</span>
      if (__pyx_t_7) {
/* … */
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">812</span>:                 continue</pre>
<pre class='cython code score-0 '>        goto __pyx_L6_continue;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">813</span>:             startsList.append(int(cols[1]))</pre>
<pre class='cython code score-7 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(<span class='pyx_c_api'>__Pyx_PyList_GET_ITEM</span>(__pyx_v_cols, 1));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 813, __pyx_L4_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_startsList, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 813, __pyx_L4_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">814</span>:             endsList.append(int(cols[2]))</pre>
<pre class='cython code score-7 '>      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(<span class='pyx_c_api'>__Pyx_PyList_GET_ITEM</span>(__pyx_v_cols, 2));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L4_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_endsList, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_12 == ((int)-1))) __PYX_ERR(0, 814, __pyx_L4_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">815</span>:     finally:</pre>
<pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">816</span>:         f.close()</pre>
<pre class='cython code score-28 '>  /*finally:*/ {
    /*normal exit:*/{
      __pyx_t_3 = __pyx_v_f;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_4 = 0;
      {
        PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 816, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L5;
    }
    __pyx_L4_error:;
    /*exception exit:*/{
      __Pyx_PyThreadState_declare
      __Pyx_PyThreadState_assign
      __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
       <span class='pyx_c_api'>__Pyx_ExceptionSwap</span>(&amp;__pyx_t_19, &amp;__pyx_t_20, &amp;__pyx_t_21);
      if ( unlikely(<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18) &lt; 0)) <span class='pyx_c_api'>__Pyx_ErrFetch</span>(&amp;__pyx_t_16, &amp;__pyx_t_17, &amp;__pyx_t_18);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_16);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_17);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_18);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_19);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_20);
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_21);
      __pyx_t_13 = __pyx_lineno; __pyx_t_14 = __pyx_clineno; __pyx_t_15 = __pyx_filename;
      {
        __pyx_t_3 = __pyx_v_f;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        __pyx_t_4 = 0;
        {
          PyObject *__pyx_callargs[2] = {__pyx_t_3, NULL};
          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FastCallMethod</span>(__pyx_mstate_global-&gt;__pyx_n_u_close, __pyx_callargs+__pyx_t_4, (1-__pyx_t_4) | (1*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET));
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 816, __pyx_L17_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        }
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      }
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_16);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_17);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_18);
      <span class='pyx_c_api'>__Pyx_ErrRestore</span>(__pyx_t_16, __pyx_t_17, __pyx_t_18);
      __pyx_t_16 = 0; __pyx_t_17 = 0; __pyx_t_18 = 0; __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0;
      __pyx_lineno = __pyx_t_13; __pyx_clineno = __pyx_t_14; __pyx_filename = __pyx_t_15;
      goto __pyx_L1_error;
      __pyx_L17_error:;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_19);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_20);
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_21);
      <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_17); __pyx_t_17 = 0;
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_18); __pyx_t_18 = 0;
      __pyx_t_19 = 0; __pyx_t_20 = 0; __pyx_t_21 = 0;
      goto __pyx_L1_error;
    }
    __pyx_L5:;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">817</span>:     cdef Py_ssize_t numIntervals = intervals.size</pre>
<pre class='cython code score-0 '>  __pyx_v_numIntervals = __pyx_f_5numpy_7ndarray_4size_size(((PyArrayObject *)__pyx_v_intervals));
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">818</span>:     cdef cnp.ndarray[cnp.uint8_t, ndim=1] mask = np.zeros(numIntervals, dtype=np.uint8)</pre>
<pre class='cython code score-41 '>  __pyx_t_3 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_mstate_global-&gt;__pyx_n_u_zeros);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyLong_FromSsize_t</span>(__pyx_v_numIntervals);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_uint8);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_22))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_22);
    assert(__pyx_t_3);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_22, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_3, __pyx_t_2};
    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 818, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_24, __pyx_t_23, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_22, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_mask.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint8_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_mask = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_mask.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 818, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_mask.diminfo[0].strides = __pyx_pybuffernd_mask.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_mask.diminfo[0].shape = __pyx_pybuffernd_mask.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_mask = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">819</span>:     if not startsList:</pre>
<pre class='cython code score-2 '>  {
    Py_ssize_t __pyx_temp = <span class='pyx_c_api'>__Pyx_PyList_GET_SIZE</span>(__pyx_v_startsList);
    if (unlikely(((!CYTHON_ASSUME_SAFE_SIZE) &amp;&amp; __pyx_temp &lt; 0))) <span class='error_goto'>__PYX_ERR(0, 819, __pyx_L1_error)</span>
    __pyx_t_7 = (__pyx_temp != 0);
  }

  __pyx_t_8 = (!__pyx_t_7);
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">820</span>:         return mask</pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_mask);
    __pyx_r = ((PyArrayObject *)__pyx_v_mask);
    goto __pyx_L0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">821</span>:     cdef cnp.ndarray[cnp.uint32_t, ndim=1] starts = np.asarray(startsList, dtype=np.uint32)</pre>
<pre class='cython code score-35 '>  __pyx_t_22 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_24 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_24);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_uint32);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 821, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_24))) {
    __pyx_t_22 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_24);
    assert(__pyx_t_22);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_22);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_24, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_22, __pyx_v_startsList};
    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 821, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_2, __pyx_t_23, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 821, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_24, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 821, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 821, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_starts.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_starts = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_starts.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 821, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_starts.diminfo[0].strides = __pyx_pybuffernd_starts.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_starts.diminfo[0].shape = __pyx_pybuffernd_starts.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_starts = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-35" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">822</span>:     cdef cnp.ndarray[cnp.uint32_t, ndim=1] ends = np.asarray(endsList, dtype=np.uint32)</pre>
<pre class='cython code score-35 '>  __pyx_t_24 = NULL;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_asarray);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_np);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
  __pyx_t_22 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_23, __pyx_mstate_global-&gt;__pyx_n_u_uint32);<span class='error_goto'> if (unlikely(!__pyx_t_22)) __PYX_ERR(0, 822, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_22);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_4 = 1;
  #if CYTHON_UNPACK_METHODS
  if (unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_24 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    assert(__pyx_t_24);
    PyObject* __pyx__function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_24);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx__function);
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, __pyx__function);
    __pyx_t_4 = 0;
  }
  #endif
  {
    PyObject *__pyx_callargs[2 + ((CYTHON_VECTORCALL) ? 1 : 0)] = {__pyx_t_24, __pyx_v_endsList};
    __pyx_t_23 = <span class='pyx_c_api'>__Pyx_MakeVectorcallBuilderKwds</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 822, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_23);
    if (<span class='pyx_c_api'>__Pyx_VectorcallBuilder_AddArg</span>(__pyx_mstate_global-&gt;__pyx_n_u_dtype, __pyx_t_22, __pyx_t_23, __pyx_callargs+2, 0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Object_Vectorcall_CallFromBuilder</span>(__pyx_t_2, __pyx_callargs+__pyx_t_4, (2-__pyx_t_4) | (__pyx_t_4*__Pyx_PY_VECTORCALL_ARGUMENTS_OFFSET), __pyx_t_23);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_24); __pyx_t_24 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_22); __pyx_t_22 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_23); __pyx_t_23 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  }
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_mstate_global-&gt;__pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(<span class='pyx_c_api'>__Pyx_GetBufferAndValidate</span>(&amp;__pyx_pybuffernd_ends.rcbuffer-&gt;pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_1), &amp;__Pyx_TypeInfo_nn___pyx_t_5numpy_uint32_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_ends = ((PyArrayObject *)Py_None); <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None); __pyx_pybuffernd_ends.rcbuffer-&gt;pybuffer.buf = NULL;
      <span class='error_goto'>__PYX_ERR(0, 822, __pyx_L1_error)</span>
    } else {__pyx_pybuffernd_ends.diminfo[0].strides = __pyx_pybuffernd_ends.rcbuffer-&gt;pybuffer.strides[0]; __pyx_pybuffernd_ends.diminfo[0].shape = __pyx_pybuffernd_ends.rcbuffer-&gt;pybuffer.shape[0];
    }
  }
  __pyx_v_ends = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">823</span>:     cdef cnp.uint32_t[:] startsView = starts</pre>
<pre class='cython code score-0 '>  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_uint32_t(((PyObject *)__pyx_v_starts), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 823, __pyx_L1_error)</span>
  __pyx_v_startsView = __pyx_t_25;
  __pyx_t_25.memview = NULL;
  __pyx_t_25.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">824</span>:     cdef cnp.uint32_t[:] endsView = ends</pre>
<pre class='cython code score-0 '>  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_uint32_t(((PyObject *)__pyx_v_ends), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 824, __pyx_L1_error)</span>
  __pyx_v_endsView = __pyx_t_25;
  __pyx_t_25.memview = NULL;
  __pyx_t_25.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">825</span>:     cdef cnp.uint32_t[:] posView = intervals</pre>
<pre class='cython code score-0 '>  __pyx_t_25 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_uint32_t(((PyObject *)__pyx_v_intervals), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_25.memview)) __PYX_ERR(0, 825, __pyx_L1_error)</span>
  __pyx_v_posView = __pyx_t_25;
  __pyx_t_25.memview = NULL;
  __pyx_t_25.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">826</span>:     cdef cnp.uint8_t[:] outView = mask</pre>
<pre class='cython code score-0 '>  __pyx_t_26 = __Pyx_PyObject_to_MemoryviewSlice_ds_nn___pyx_t_5numpy_uint8_t(((PyObject *)__pyx_v_mask), PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_26.memview)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  __pyx_v_outView = __pyx_t_26;
  __pyx_t_26.memview = NULL;
  __pyx_t_26.data = NULL;
</pre><pre class="cython line score-0">&#xA0;<span class="">827</span>:     # for nogil</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">828</span>:     cdef uint32_t* svPtr = &amp;startsView[0] if starts.size &gt; 0 else &lt;uint32_t*&gt;NULL</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_f_5numpy_7ndarray_4size_size(((PyArrayObject *)__pyx_v_starts)) &gt; 0);
  if (__pyx_t_8) {
    __pyx_t_28 = 0;
    __pyx_t_27 = (&amp;(*((__pyx_t_5numpy_uint32_t *) ( /* dim=0 */ (__pyx_v_startsView.data + __pyx_t_28 * __pyx_v_startsView.strides[0]) ))));
  } else {
    __pyx_t_27 = ((uint32_t *)NULL);
  }
  __pyx_v_svPtr = __pyx_t_27;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">829</span>:     cdef uint32_t* evPtr = &amp;endsView[0] if ends.size &gt; 0 else &lt;uint32_t*&gt;NULL</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_f_5numpy_7ndarray_4size_size(((PyArrayObject *)__pyx_v_ends)) &gt; 0);
  if (__pyx_t_8) {
    __pyx_t_28 = 0;
    __pyx_t_27 = (&amp;(*((__pyx_t_5numpy_uint32_t *) ( /* dim=0 */ (__pyx_v_endsView.data + __pyx_t_28 * __pyx_v_endsView.strides[0]) ))));
  } else {
    __pyx_t_27 = ((uint32_t *)NULL);
  }
  __pyx_v_evPtr = __pyx_t_27;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">830</span>:     cdef uint32_t* posPtr = &amp;posView[0] if numIntervals &gt; 0 else &lt;uint32_t*&gt;NULL</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_numIntervals &gt; 0);
  if (__pyx_t_8) {
    __pyx_t_28 = 0;
    __pyx_t_27 = (&amp;(*((__pyx_t_5numpy_uint32_t *) ( /* dim=0 */ (__pyx_v_posView.data + __pyx_t_28 * __pyx_v_posView.strides[0]) ))));
  } else {
    __pyx_t_27 = ((uint32_t *)NULL);
  }
  __pyx_v_posPtr = __pyx_t_27;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">831</span>:     cdef uint8_t* outPtr = &amp;outView[0] if numIntervals &gt; 0 else &lt;uint8_t*&gt;NULL</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = (__pyx_v_numIntervals &gt; 0);
  if (__pyx_t_8) {
    __pyx_t_28 = 0;
    __pyx_t_29 = (&amp;(*((__pyx_t_5numpy_uint8_t *) ( /* dim=0 */ (__pyx_v_outView.data + __pyx_t_28 * __pyx_v_outView.strides[0]) ))));
  } else {
    __pyx_t_29 = ((uint8_t *)NULL);
  }
  __pyx_v_outPtr = __pyx_t_29;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">832</span>:     cdef Py_ssize_t n = starts.size</pre>
<pre class='cython code score-0 '>  __pyx_v_n = __pyx_f_5numpy_7ndarray_4size_size(((PyArrayObject *)__pyx_v_starts));
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">833</span>:     with nogil:</pre>
<pre class='cython code score-6 '>  {
      PyThreadState *_save;
      _save = NULL;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          goto __pyx_L21;
        }
        __pyx_L20_error: {
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          goto __pyx_L1_error;
        }
        __pyx_L21:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">834</span>:         if numIntervals &gt; 0 and n &gt; 0:</pre>
<pre class='cython code score-0 '>        __pyx_t_7 = (__pyx_v_numIntervals &gt; 0);
        if (__pyx_t_7) {
        } else {
          __pyx_t_8 = __pyx_t_7;
          goto __pyx_L23_bool_binop_done;
        }
        __pyx_t_7 = (__pyx_v_n &gt; 0);
        __pyx_t_8 = __pyx_t_7;
        __pyx_L23_bool_binop_done:;
        if (__pyx_t_8) {
/* … */
        }
      }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">835</span>:             maskMembership(posPtr, numIntervals, svPtr, evPtr, n, outPtr)</pre>
<pre class='cython code score-2 '>          __pyx_t_14 = __pyx_f_10consenrich_11cconsenrich_maskMembership(__pyx_v_posPtr, __pyx_v_numIntervals, __pyx_v_svPtr, __pyx_v_evPtr, __pyx_v_n, __pyx_v_outPtr); if (unlikely(__pyx_t_14 == ((int)-1) &amp;&amp; <span class='pyx_c_api'>__Pyx_ErrOccurredWithGIL</span>())) <span class='error_goto'>__PYX_ERR(0, 835, __pyx_L20_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">836</span>:     return mask</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_v_mask);
  __pyx_r = ((PyArrayObject *)__pyx_v_mask);
  goto __pyx_L0;
</pre></div></body></html>
